/* Cell Selection Styles (Excel-like) */

/* Selected cell - single cell selection */
.hh-cell-selected {
  background-color: var(--hh-cell-selection-background, rgba(0, 120, 212, 0.1)) !important;
  border: 1px solid var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
  outline: none !important;
}

/* Focused cell - cell with keyboard focus (for arrow key navigation) */
.hh-cell-focused {
  outline: 2px solid var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
  outline-offset: -1px !important;
  z-index: 1;
  /* Ensure border-top is not too thick - use the same color as row border */
  border-top: 1px solid var(--hh-color-row-border, #f1f1f1) !important;
}

/* Remove outline when cell is being edited (input has its own border) */
.hh-cell-focused .hh-cell-edit-input {
  outline: none !important;
}

/* Remove cell outline when editing */
td.hh-cell-focused:has(.hh-cell-edit-input),
th.hh-cell-focused:has(.hh-cell-edit-input) {
  outline: none !important;
}

/* Excel-like editing: ensure cell maintains height and input fits seamlessly */
td:has(.hh-cell-edit-input-excel),
th:has(.hh-cell-edit-input-excel) {
  padding: inherit !important;
  vertical-align: top;
  height: auto;
}

td:has(.hh-cell-edit-input-excel) .hh-cell-edit-input-excel {
  display: block;
  width: 100%;
  min-height: 100%;
  height: auto;
  line-height: inherit;
}

/* Validation error state for Excel mode */
td:has(.hh-cell-edit-input-excel.hh-cell-edit-input-error),
th:has(.hh-cell-edit-input-excel.hh-cell-edit-input-error) {
  background-color: #fff4f4 !important;
}

.hh-cell-edit-input-excel.hh-cell-edit-input-error {
  background-color: #fff4f4 !important;
  border: 1px solid var(--hh-color-error, #d13438) !important;
  box-shadow: 0 0 0 1px var(--hh-color-error, #d13438) !important;
}

/* Error message wrapper for Excel mode */
.hh-cell-edit-wrapper {
  position: relative;
  width: 100%;
  height: 100%;
}

.hh-cell-edit-wrapper .hh-cell-edit-error-message {
  position: absolute;
  bottom: -18px;
  left: 0;
  right: 0;
  font-size: 11px;
  color: var(--hh-color-error, #d13438);
  background-color: #fff;
  padding: 2px 4px;
  border: 1px solid var(--hh-color-error, #d13438);
  border-radius: 2px;
  z-index: 10;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

/* Copied cells - dashed border */
.hh-cell-copied.hh-cell-selected {
  border: 1px dashed var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
}

/* Range selection - cells inside range */
/* First, remove all default borders from cells in range */
/* Use solid color instead of rgba with opacity to avoid seeing columns below when scrolling with pinned columns */
.hh-table.enable-cell-selection td.hh-cell-in-range {
  background-color: var(--hh-cell-range-background, rgba(0, 120, 212, 0.05)) !important;
  border-top: none !important;
  border-bottom: none !important;
  border-left: none !important;
  border-right: none !important;
}

/* Use solid background for pinned columns in range to prevent seeing columns below */
.hh-table.enable-cell-selection td.hh-cell-in-range.hh-pinned-left,
.hh-table.enable-cell-selection td.hh-cell-in-range.hh-pinned-right,
.hh-table.enable-cell-selection td.hh-cell-in-range.hh-cell-pinned {
  /* Convert rgba to solid color - use a light blue/grey that matches the opacity effect */
  background-color: #f0f8ff !important;
}

/* Dark theme adjustment for pinned columns */
.hh-theme-dark .hh-table.enable-cell-selection td.hh-cell-in-range.hh-pinned-left,
.hh-theme-dark .hh-table.enable-cell-selection td.hh-cell-in-range.hh-pinned-right,
.hh-theme-dark .hh-table.enable-cell-selection td.hh-cell-in-range.hh-cell-pinned {
  background-color: #1a2a3a !important;
}

/* Border for cells on the edge of range - only outer edges get borders */
/* Top row of range - remove border-top, we'll use border-bottom of row above */
.hh-table.enable-cell-selection td.hh-cell-in-range.hh-cell-range-top {
  border-top: none !important;
}

/* Add border-bottom to cells in row above the range - only for cells in columns that are in range */
/* Only apply border-bottom, NOT border-left or border-right */
/* Only show border when there's an active selection (not just when copied) */
.hh-table.enable-cell-selection tbody tr.hh-row-above-range td[data-in-range-column="true"] {
  border-bottom: 1px solid var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;

}

/* Add border-bottom to header cells when range starts from first row - only for cells in columns that are in range */
/* Only apply border-bottom, NOT border-left or border-right */
.hh-table.enable-cell-selection thead th[data-in-range-column="true"] {
  border-bottom: 1px solid var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
  border-left: 1px solid var(--hh-color-row-border, #f1f1f1) !important;
  border-right: 1px solid var(--hh-color-row-border, #f1f1f1) !important;
}

/* Bottom row of range - all cells in bottom row get bottom border */
.hh-table.enable-cell-selection td.hh-cell-in-range.hh-cell-range-bottom {
  border-bottom: 1px solid var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
}

/* Left column of range - all cells in left column get left border */
.hh-table.enable-cell-selection td.hh-cell-in-range.hh-cell-range-left {
  border-left: 1px solid var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
}

/* Right column of range - all cells in right column get right border */
.hh-table.enable-cell-selection td.hh-cell-in-range.hh-cell-range-right {
  border-right: 1px solid var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
}

/* Copied range - dashed borders */
.hh-table.enable-cell-selection td.hh-cell-copied.hh-cell-in-range.hh-cell-range-bottom {
  border-bottom: 1px dashed var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
}

.hh-table.enable-cell-selection td.hh-cell-copied.hh-cell-in-range.hh-cell-range-left {
  border-left: 1px dashed var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
}

.hh-table.enable-cell-selection td.hh-cell-copied.hh-cell-in-range.hh-cell-range-right {
  border-right: 1px dashed var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
}

/* Copied range - dashed border for row above */
.hh-table.enable-cell-selection tbody tr.hh-row-above-range td.hh-cell-copied[data-in-range-column="true"] {
  border-bottom: 1px dashed var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
}

/* Copied range - dashed border for header */
.hh-table.enable-cell-selection thead th.hh-cell-copied[data-in-range-column="true"] {
  border-bottom: 1px dashed var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
}

/* Cell selection cursor */
.hh-table.enable-cell-selection td {
  cursor: cell;
  user-select: none;
}

.hh-table.enable-cell-selection td:hover {
  background-color: var(--hh-cell-hover-background, #f0f8ff);
}

/* Dark theme adjustments */
.hh-theme-dark .hh-cell-selected {
  background-color: var(--hh-cell-selection-background, rgba(96, 205, 255, 0.1)) !important;
  border-color: var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
}

.hh-theme-dark .hh-cell-in-range {
  background-color: var(--hh-cell-range-background, rgba(96, 205, 255, 0.05)) !important;
}

.hh-theme-dark .hh-cell-range-start {
  border-color: var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
}

.hh-theme-dark .hh-cell-range-end {
  border-color: var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
}

.hh-theme-dark .hh-table.enable-cell-selection td:hover {
  background-color: var(--hh-cell-hover-background, #2a3d4c);
}

.hh-theme-dark .hh-table.enable-cell-selection thead th[data-in-range-column="true"] {
  border-bottom-color: var(--hh-color-focus-border, var(--hh-color-primary, #107c10)) !important;
}

