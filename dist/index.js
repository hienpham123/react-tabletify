"use strict";var e=require("react/jsx-runtime");function n(e){var n=Object.create(null);return e&&Object.keys(e).forEach(function(t){if("default"!==t){var o=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,o.get?o:{enumerable:!0,get:function(){return e[t]}})}}),n.default=e,Object.freeze(n)}var t=n(require("react")),o=function(){return o=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},o.apply(this,arguments)};function r(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var o,r,l=t.call(e),i=[];try{for(;(void 0===n||n-- >0)&&!(o=l.next()).done;)i.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(t=l.return)&&t.call(l)}finally{if(r)throw r.error}}return i}function l(e,n,t){if(t||2===arguments.length)for(var o,r=0,l=n.length;r<l;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}function i(e,n){void 0===n&&(n=10);var i=r(t.useState(""),2),a=i[0],s=i[1],c=r(t.useState(null),2),u=c[0],d=c[1],h=r(t.useState("asc"),2),f=h[0],g=h[1],m=r(t.useState(1),2),p=m[0],v=m[1],x=r(t.useState({}),2),y=x[0],C=x[1],b=function(e,n){C(function(t){var r=o({},t);return 0===n.length?delete r[e]:r[e]=n,r})},w=t.useMemo(function(){var n=e;if(Object.entries(y).forEach(function(e){var t=r(e,2),o=t[0],l=t[1];l.length>0&&(n=n.filter(function(e){return l.includes(String(e[o]))}))}),a.trim()){var t=a.toLowerCase();n=n.filter(function(e){return Object.values(e).some(function(e){return String(e).toLowerCase().includes(t)})})}return n},[e,a,y]),k=t.useMemo(function(){return u?l([],r(w),!1).sort(function(e,n){var t=e[u],o=n[u];if(null==t)return 1;if(null==o)return-1;if(t===o)return 0;var r=String(t).localeCompare(String(o),void 0,{numeric:!0,sensitivity:"base"});return"asc"===f?r:-r}):w},[w,u,f]),S=Math.ceil(k.length/n),R=t.useMemo(function(){var e=(p-1)*n;return k.slice(e,e+n)},[k,p,n]);t.useEffect(function(){v(1)},[a,u,f,y]);var I=t.useCallback(function(){s("")},[]),j=t.useCallback(function(){C({})},[]),M=t.useCallback(function(e){b(e,[])},[b]),N=t.useCallback(function(){d(null),g("asc")},[]),E=t.useCallback(function(){s(""),C({}),d(null),g("asc"),v(1)},[]),P=t.useCallback(function(){v(1)},[]),D=t.useCallback(function(){v(S)},[S]),K=t.useCallback(function(){v(function(e){return Math.min(e+1,S)})},[S]),L=t.useCallback(function(){v(function(e){return Math.max(e-1,1)})},[]);return{filtered:w,sorted:k,paged:R,currentPage:p,setCurrentPage:v,totalPages:S,itemsPerPage:n,goToFirstPage:P,goToLastPage:D,goToNextPage:K,goToPrevPage:L,search:a,setSearch:s,clearSearch:I,sortKey:u,sortDir:f,handleSort:function(e,n){n?(d(e),g(n)):u===e?g(function(e){return"asc"===e?"desc":"asc"}):(d(e),g("asc"))},resetSort:N,filters:y,setFilter:b,clearFilter:M,clearFilters:j,resetAll:E}}"function"==typeof SuppressedError&&SuppressedError;var a=function(n){var t=n.totalItems,r=n.itemsPerPage,l=n.currentPage,i=n.onPageChange,a=n.maxVisible,s=void 0===a?5:a,c=n.itemsPerPageOptions,u=n.onItemsPerPageChange,d=Math.ceil(t/r),h=Math.floor(s/2),f=Math.max(1,l-h),g=Math.min(d,f+s-1);g-f<s-1&&(f=Math.max(1,g-s+1));var m=Array.from({length:g-f+1},function(e,n){return f+n}),p=function(e){e<1||e>d||e===l||i(e)};return!(d<=0)||c&&u?e.jsxs("div",o({className:"hh-pagination"},{children:[e.jsx("button",o({onClick:function(){return p(l-1)},disabled:1===l,className:"hh-pagination-btn hh-pagination-arrow","aria-label":"Previous page"},{children:"<"})),f>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",o({className:"hh-pagination-btn",onClick:function(){return p(1)}},{children:"1"})),f>2&&e.jsx("span",o({className:"hh-pagination-ellipsis"},{children:"..."}))]}),m.map(function(n){return e.jsx("button",o({onClick:function(){return p(n)},className:"hh-pagination-btn ".concat(n===l?"hh-page-active":"")},{children:n}),n)}),g<d&&e.jsxs(e.Fragment,{children:[g<d-1&&e.jsx("span",o({className:"hh-pagination-ellipsis"},{children:"..."})),e.jsx("button",o({className:"hh-pagination-btn",onClick:function(){return p(d)}},{children:d}))]}),e.jsx("button",o({onClick:function(){return p(l+1)},disabled:l===d,className:"hh-pagination-btn hh-pagination-arrow","aria-label":"Next page"},{children:">"})),c&&u&&e.jsxs("div",o({className:"hh-pagination-items-per-page"},{children:[e.jsx("label",o({htmlFor:"hh-items-per-page-select",style:{marginRight:"8px"}},{children:"Rows per page:"})),e.jsx("select",o({id:"hh-items-per-page-select",value:r,onChange:function(e){var n=Number(e.target.value);u(n),i(1)},className:"hh-pagination-select"},{children:c.map(function(n){return e.jsx("option",o({value:n},{children:n}),n)})}))]}))]})):null};function s(n){var t=n.width,r=void 0===t?12:t,l=n.height,i=void 0===l?12:l,a=n.className,s=n.style;return e.jsx("svg",o({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:r,height:i,className:a,style:s},{children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}))}function c(n){var t=n.width,r=void 0===t?12:t,l=n.height,i=void 0===l?12:l,a=n.className,s=n.style;return e.jsx("svg",o({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:r,height:i,className:a,style:s},{children:e.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})}))}function u(n){var t=n.width,r=void 0===t?16:t,l=n.height,i=void 0===l?16:l,a=n.className,s=n.style;return e.jsx("svg",o({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",fill:"currentColor",width:r,height:i,className:a,style:s},{children:e.jsx("path",{d:"M1799 349l242 241-1017 1017L7 590l242-241 775 775 775-775z"})}))}function d(n){var t=n.width,r=void 0===t?14:t,l=n.height,i=void 0===l?14:l,a=n.className,s=n.style;return e.jsx("svg",o({xmlns:"http://www.w3.org/2000/svg",width:r,height:i,viewBox:"0 0 2048 2048",fill:"currentColor",className:a,style:s},{children:e.jsx("path",{d:"M1990 748q-33 33-64 60t-66 47-73 29-89 11q-34 0-65-6l-379 379q13 38 19 78t6 80q0 65-13 118t-37 100-60 89-79 87l-386-386-568 569-136 45 45-136 569-568-386-386q44-44 86-79t89-59 100-38 119-13q40 0 80 6t78 19l379-379q-6-31-6-65 0-49 10-88t30-74 46-65 61-65l690 690z"})}))}function h(n){var t=n.width,r=void 0===t?14:t,l=n.height,i=void 0===l?14:l,a=n.className,s=n.style;return e.jsx("svg",o({xmlns:"http://www.w3.org/2000/svg",width:r,height:i,viewBox:"0 0 2048 2048",fill:"currentColor",className:a,style:s},{children:e.jsx("path",{d:"M2048 128v219l-768 768v805H768v-805L0 347V128h2048z"})}))}function f(n){var t=n.width,r=void 0===t?16:t,l=n.height,i=void 0===l?16:l,a=n.className,s=n.style;return e.jsxs("svg",o({width:r,height:i,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:a,style:s},{children:[e.jsx("circle",{cx:"4",cy:"8",r:"1.5",fill:"currentColor"}),e.jsx("circle",{cx:"8",cy:"8",r:"1.5",fill:"currentColor"}),e.jsx("circle",{cx:"12",cy:"8",r:"1.5",fill:"currentColor"})]}))}function g(n){var t=n.width,r=void 0===t?16:t,l=n.height,i=void 0===l?16:l,a=n.className,s=n.style;return e.jsx("svg",o({width:r,height:i,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:a,style:s},{children:e.jsx("path",{d:"M6 4L10 8L6 12",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})}))}function m(n){var t=n.width,r=void 0===t?16:t,l=n.height,i=void 0===l?16:l,a=n.className,s=n.style;return e.jsx("svg",o({width:r,height:i,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:a,style:s},{children:e.jsx("path",{d:"M2 2h12v12H2V2zm1 1v10h10V3H3zm1 1h8v1H4V4zm0 2h8v1H4V6zm0 2h8v1H4V8zm0 2h5v1H4v-1z",fill:"currentColor"})}))}function p(n){var i=n.field,a=n.values,s=n.selected,u=n.onApply,d=n.onDismiss,h=r(t.useState(s),2),f=h[0],g=h[1],m=r(t.useState(""),2),p=m[0],v=m[1];t.useEffect(function(){g(s),v("")},[i]);var x=t.useMemo(function(){if(!p.trim())return a;var e=p.toLowerCase();return a.filter(function(n){return n.toLowerCase().includes(e)})},[a,p]);return e.jsxs("div",o({className:"hh-filter-panel open"},{children:[e.jsxs("div",o({className:"hh-filter-header"},{children:[e.jsxs("strong",{children:["Filter by '",i,"'"]}),e.jsx("button",o({className:"hh-filter-close",onClick:d,"aria-label":"Close"},{children:e.jsx(c,{width:16,height:16})}))]})),e.jsxs("div",o({className:"hh-filter-content"},{children:[e.jsx("div",o({className:"hh-filter-search"},{children:e.jsx("input",{type:"text",className:"hh-filter-search-input",placeholder:"Select ".concat(i," to display..."),value:p,onChange:function(e){return v(e.target.value)}})})),e.jsx("div",o({className:"hh-filter-options-list"},{children:x.length>0?x.map(function(n){return e.jsxs("div",o({className:"hh-filter-option"},{children:[e.jsx("input",{type:"checkbox",id:"filter-".concat(i,"-").concat(n),checked:f.includes(n),onChange:function(){return function(e){g(function(n){return n.includes(e)?n.filter(function(n){return n!==e}):l(l([],r(n),!1),[e],!1)})}(n)}}),e.jsx("label",o({htmlFor:"filter-".concat(i,"-").concat(n)},{children:n}))]}),n)}):e.jsx("div",o({className:"hh-filter-no-results"},{children:"No results found"}))}))]})),e.jsxs("div",o({className:"hh-filter-footer"},{children:[e.jsx("button",o({className:"hh-btn",onClick:function(){g([])}},{children:"Clear all"})),e.jsx("button",o({className:"hh-btn primary",onClick:function(){return u(f)}},{children:"Apply"}))]}))]}))}function v(n){var t=n.columns,r=n.itemsPerPage,l=n.selectionMode,i=n.onRenderLoading;return i?e.jsx(e.Fragment,{children:i()}):e.jsxs("div",o({className:"hh-loading-skeleton"},{children:[e.jsxs("div",o({className:"hh-skeleton-header"},{children:["none"!==l&&e.jsx("div",{className:"hh-skeleton-cell",style:{width:"48px"}}),t.map(function(n,t){return e.jsx("div",{className:"hh-skeleton-cell",style:{width:n.width||"150px"}},t)})]})),Array.from({length:r}).map(function(n,r){return e.jsxs("div",o({className:"hh-skeleton-row"},{children:["none"!==l&&e.jsx("div",{className:"hh-skeleton-cell",style:{width:"48px"}}),t.map(function(n,t){return e.jsx("div",{className:"hh-skeleton-cell",style:{width:n.width||"150px"}},t)})]}),r)})]}))}function x(n){var t=n.emptyMessage,r=n.onRenderEmpty;return r?e.jsx(e.Fragment,{children:r()}):e.jsxs("div",o({className:"hh-empty-state"},{children:[e.jsx("div",o({className:"hh-empty-icon"},{children:"ðŸ“‹"})),e.jsx("div",o({className:"hh-empty-message"},{children:t||"No data available"}))]}))}function y(n){var t=n.selectionMode,r=n.checked,l=n.indeterminate,i=n.onChange,a=n.onSelectAll;if("none"===t)return null;var s=void 0!==a;return e.jsx("td",o({className:"hh-selection-column"},{children:e.jsx("div",o({className:"hh-selection-checkbox-wrapper"},{children:"multiple"===t?e.jsx("input",{type:"checkbox",className:"hh-selection-checkbox",checked:r,ref:function(e){e&&void 0!==l&&(e.indeterminate=l)},onChange:function(e){s&&a?a(e.target.checked):i(e.target.checked)},onClick:function(e){return e.stopPropagation()}}):s?e.jsx("div",{className:"hh-selection-checkbox-wrapper"}):e.jsx("input",{type:"radio",className:"hh-selection-checkbox",checked:r,onChange:function(e){return i(e.target.checked)},onClick:function(e){return e.stopPropagation()}})}))}))}function C(n){var l=n.anchorRef,i=n.onSortAsc,a=n.onSortDesc,s=n.onFilter,c=n.onClearFilter,u=n.onPinLeft,d=n.onPinRight,h=n.onUnpin,f=n.onToggleVisibility,g=n.onGroupBy,m=n.isGrouped,p=void 0!==m&&m,v=n.onColumnSettings,x=n.onTotalsChange,y=n.totalsValue,C=void 0===y?"none":y,b=n.columnLabel,w=void 0===b?"Column":b;n.onDismiss;var k=n.onMouseEnter,S=n.onMouseLeave,R=n.sortable,I=void 0===R||R,j=n.filterable,M=void 0===j||j,N=n.hasFilter,E=void 0!==N&&N,P=n.pinned,D=void 0===P?null:P,K=n.visible,L=void 0===K||K,T=n.enableColumnVisibility,A=void 0!==T&&T;n.enableColumnReorder;var F=n.groupable,O=void 0!==F&&F,_=n.settingsable,B=void 0!==_&&_,H=n.totalsable,z=void 0!==H&&H,V=t.useRef(null),W=r(t.useState(null),2),U=W[0],G=W[1],q=t.useRef(null);if(t.useEffect(function(){return function(){q.current&&clearTimeout(q.current)}},[]),!l.current)return null;var X=l.current.getBoundingClientRect(),Y=function(e){q.current&&clearTimeout(q.current),G(e)},J=function(){q.current=setTimeout(function(){G(null)},150)};return e.jsx(e.Fragment,{children:e.jsxs("div",o({ref:V,className:"hh-callout",style:{top:X.bottom+6,left:X.left,position:"fixed"},onMouseEnter:k,onMouseLeave:S},{children:[I&&e.jsxs(e.Fragment,{children:[e.jsx("button",o({onClick:i,className:"hh-callout-item"},{children:e.jsx("span",o({className:"hh-callout-text"},{children:"Ascending"}))})),e.jsx("button",o({onClick:a,className:"hh-callout-item"},{children:e.jsx("span",o({className:"hh-callout-text"},{children:"Descending"}))}))]}),I&&M&&e.jsx("hr",{className:"hh-callout-divider"}),M&&E&&c&&e.jsx("button",o({onClick:c,className:"hh-callout-item"},{children:e.jsx("span",o({className:"hh-callout-text"},{children:"Clear filter"}))})),M&&E&&c&&e.jsx("hr",{className:"hh-callout-divider"}),M&&e.jsx("button",o({onClick:s,className:"hh-callout-item"},{children:e.jsx("span",o({className:"hh-callout-text"},{children:"Filter by"}))})),O&&g&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"hh-callout-divider"}),e.jsxs("button",o({onClick:g,className:"hh-callout-item ".concat(p?"hh-callout-item-selected":"")},{children:[e.jsxs("span",o({className:"hh-callout-text"},{children:["Group by ",w]})),p&&e.jsx("span",o({className:"hh-callout-checkmark"},{children:"âœ“"}))]}))]}),(B&&v||z)&&e.jsx("hr",{className:"hh-callout-divider"}),B&&v&&e.jsxs("div",o({className:"hh-callout-item hh-callout-item-with-submenu",onMouseEnter:function(){return Y("column-settings")},onMouseLeave:J},{children:[e.jsx("span",o({className:"hh-callout-text"},{children:"Column settings"})),e.jsx("span",o({className:"hh-callout-arrow"},{children:"â€º"})),"column-settings"===U&&e.jsxs("div",o({className:"hh-callout-submenu",onMouseEnter:function(){return Y("column-settings")},onMouseLeave:J},{children:[null===D&&u&&e.jsx("button",o({onClick:u,className:"hh-callout-submenu-item"},{children:e.jsx("span",o({className:"hh-callout-text"},{children:"Pin left"}))})),null===D&&d&&e.jsx("button",o({onClick:d,className:"hh-callout-submenu-item"},{children:e.jsx("span",o({className:"hh-callout-text"},{children:"Pin right"}))})),null!==D&&h&&e.jsx("button",o({onClick:h,className:"hh-callout-submenu-item"},{children:e.jsx("span",o({className:"hh-callout-text"},{children:"Unpin"}))})),A&&f&&e.jsxs(e.Fragment,{children:[(u||d||h)&&e.jsx("hr",{className:"hh-callout-divider"}),e.jsx("button",o({onClick:f,className:"hh-callout-submenu-item"},{children:e.jsx("span",o({className:"hh-callout-text"},{children:L?"Hide column":"Show column"}))}))]})]}))]})),z&&x&&e.jsxs("div",o({className:"hh-callout-item hh-callout-item-with-submenu",onMouseEnter:function(){return Y("totals")},onMouseLeave:J},{children:[e.jsx("span",o({className:"hh-callout-text"},{children:"Totals"})),e.jsx("span",o({className:"hh-callout-arrow"},{children:"â€º"})),"totals"===U&&e.jsxs("div",o({className:"hh-callout-submenu",onMouseEnter:function(){return Y("totals")},onMouseLeave:J},{children:[e.jsxs("button",o({onClick:function(){return x("none")},className:"hh-callout-submenu-item ".concat("none"===C?"hh-callout-item-selected":"")},{children:[e.jsx("span",o({className:"hh-callout-text"},{children:"None"})),"none"===C&&e.jsx("span",o({className:"hh-callout-checkmark"},{children:"âœ“"}))]})),e.jsxs("button",o({onClick:function(){return x("count")},className:"hh-callout-submenu-item ".concat("count"===C?"hh-callout-item-selected":"")},{children:[e.jsx("span",o({className:"hh-callout-text"},{children:"Count"})),"count"===C&&e.jsx("span",o({className:"hh-callout-checkmark"},{children:"âœ“"}))]}))]}))]}))]}))})}function b(n){var t=n.column,r=n.columnIndex,l=n.resizedWidth,i=n.pinPosition,a=n.leftOffset,s=n.rightOffset,c=n.lastLeftPinnedColumnKey,f=n.firstRightPinnedColumnKey,g=n.stickyHeader,m=n.enableColumnReorder,p=n.isDragOver,v=n.sortKey,x=n.sortDir,y=n.hasFilter,b=n.anchorRef,w=n.anchorRefForCallout,k=n.calloutKey,S=n.resizingColumn,R=n.onRenderHeader,I=n.onColumnHeaderClick,j=n.onHeaderMouseEnter,M=n.onHeaderMouseLeave,N=n.onCalloutMouseEnter,E=n.onCalloutMouseLeave,P=n.onColumnDragStart,D=n.onColumnDragOver,K=n.onColumnDrop,L=n.onResizeStart,T=n.onSortAsc,A=n.onSortDesc,F=n.onFilter,O=n.onClearFilter,_=n.onPinLeft,B=n.onPinRight,H=n.onUnpin,z=n.onToggleVisibility,V=n.onGroupBy,W=n.isGrouped,U=n.enableColumnVisibility,G=n.groupable,q=n.settingsable,X=n.totalsable,Y=n.onTotalsChange,J=n.totalsValue,Q=n.onDismiss,Z=n.enableCellSelection,$=void 0!==Z&&Z,ee=n.isInRangeColumn,ne=void 0!==ee&&ee,te=n.isLeftColInRange,oe=void 0!==te&&te,re=n.isRightColInRange,le=void 0!==re&&re,ie=n.isCopied,ae=void 0!==ie&&ie,se=String(t.key),ce=o(o(o(o({},t.style),{width:l?"".concat(l,"px"):t.width,minWidth:t.minWidth,maxWidth:t.maxWidth,textAlign:t.align,position:i?"sticky":"relative"}),"left"===i?{left:"".concat(a,"px"),zIndex:g?15:5}:{}),"right"===i?{right:"".concat(s,"px"),zIndex:g?15:5}:{}),ue=t.className?"hh-header-cell ".concat(i?"hh-header-pinned hh-pinned-".concat(i):""," ").concat(t.className):i?"hh-header-cell hh-header-pinned hh-pinned-".concat(i):"hh-header-cell",de=[p?"hh-drag-over":"",i?"hh-pinned-".concat(i):"","left"===i&&t.key===c?"hh-pinned-last-left":"","right"===i&&t.key===f?"hh-pinned-first-right":"",$&&ae?"hh-cell-copied":""].filter(Boolean).join(" ");return e.jsxs("th",o({style:ce,draggable:m,onDragStart:function(){return P(t.key)},onDragOver:function(e){return D(e,t.key)},onDrop:function(){return K(t.key)},onDragLeave:function(){},className:de,"data-in-range-column":$&&ne?"true":void 0,"data-left-col-in-range":$&&oe?"true":void 0,"data-right-col-in-range":$&&le?"true":void 0},{children:[R?R(t,r):e.jsxs("div",o({className:ue,ref:function(e){b(e)},onMouseEnter:function(){return j(se)},onMouseLeave:M,onClick:function(e){return null==I?void 0:I(t,e)}},{children:[e.jsxs("span",o({className:"hh-header-label"},{children:[t.label,!1!==t.showCallout&&e.jsx("span",o({className:"hh-header-chevron-icon",role:"presentation","aria-hidden":"true"},{children:e.jsx(u,{})}))]})),e.jsxs("div",o({className:"hh-header-icons"},{children:[i&&e.jsx("span",o({className:"hh-header-pin-icon",title:"Pinned ".concat(i)},{children:e.jsx(d,{width:14,height:14})})),y&&e.jsx("span",o({className:"hh-header-filter-icon",title:"Filtered",role:"presentation","aria-hidden":"true"},{children:e.jsx(h,{width:14,height:14})})),v===t.key&&e.jsx("span",o({className:"hh-header-sort-icon"},{children:"asc"===x?e.jsx("span",o({className:"hh-sort-arrow"},{children:"â†‘"})):e.jsx("span",o({className:"hh-sort-arrow"},{children:"â†“"}))}))]})),e.jsx("span",o({className:"hh-header-action"},{children:"â‹®"}))]})),!1!==t.resizable&&e.jsx("div",{className:"hh-resize-handle",onMouseDown:function(e){return L(se,e)},style:{cursor:"col-resize",position:"absolute",right:0,top:0,bottom:0,width:"4px",zIndex:10,userSelect:"none"}}),k===se&&!S&&!1!==t.showCallout&&e.jsx(C,{anchorRef:w,onSortAsc:T,onSortDesc:A,onFilter:F,onClearFilter:O,onPinLeft:_,onPinRight:B,onUnpin:H,onToggleVisibility:z,onGroupBy:V,isGrouped:W,onColumnSettings:q?!!H||U:void 0,onTotalsChange:Y,totalsValue:J,columnLabel:t.label,onDismiss:Q,onMouseEnter:N,onMouseLeave:E,sortable:!1!==t.sortable,filterable:!1!==t.filterable,hasFilter:y,pinned:i,visible:!0,enableColumnVisibility:U,groupable:G,settingsable:q,totalsable:X})]}),se)}function w(n){var t=n.columns,r=n.selectionMode,l=n.isAllSelected,i=n.isIndeterminate,a=n.onSelectAll,s=n.columnWidths,c=n.pinnedColumns,u=n.lastLeftPinnedColumnKey,d=n.firstRightPinnedColumnKey,h=n.stickyHeader,f=n.enableColumnReorder,g=n.dragOverColumn,m=n.sortKey,p=n.sortDir,v=n.filters,x=n.anchorRefs,C=n.calloutKey,w=n.resizingColumn,k=n.onRenderHeader,S=n.onColumnHeaderClick,R=n.onHeaderMouseEnter,I=n.onHeaderMouseLeave,j=n.onCalloutMouseEnter,M=n.onCalloutMouseLeave,N=n.onColumnDragStart,E=n.onColumnDragOver,P=n.onColumnDrop,D=n.onResizeStart,K=n.onSortAsc,L=n.onSortDesc,T=n.onFilter,A=n.onClearFilter,F=n.onPinLeft,O=n.onPinRight,_=n.onUnpin,B=n.onToggleVisibility,H=n.onGroupBy,z=n.currentGroupBy,V=n.enableColumnVisibility,W=n.onTotalsChange,U=n.columnTotals,G=n.getLeftOffset,q=n.getRightOffset,X=n.dismissCallout,Y=n.enableRowActions,J=void 0!==Y&&Y,Q=n.enableCellSelection,Z=void 0!==Q&&Q,$=n.isRangeFromFirstRow,ee=void 0!==$&&$;n.isColumnInRange;var ne=n.getColumnRangeInfo,te=n.isCopied,oe=void 0!==te&&te;return e.jsx("thead",{children:e.jsxs("tr",{children:["none"!==r&&e.jsx(y,{selectionMode:r,checked:l,indeterminate:i,onChange:function(){},onSelectAll:a}),J&&e.jsx("th",o({className:"hh-row-actions-column"},{children:e.jsx("div",o({className:"hh-header-cell"},{children:e.jsx("span",{className:"hh-header-label"})}))})),t.map(function(n,t){var o=String(n.key),r=s[o],l=c[o]||n.pinned||null,i="left"===l?G(n,t):0,a="right"===l?q(n,t):0,y=Z&&ee&&ne?ne(o):{isInRange:!1,isLeftCol:!1,isRightCol:!1},Y=Z&&ee&&oe&&y.isInRange,J={get current(){return x.current[o]||null},set current(e){}};return e.jsx(b,{column:n,columnIndex:t,resizedWidth:r,pinPosition:l,leftOffset:i,rightOffset:a,lastLeftPinnedColumnKey:null!=u?u:void 0,firstRightPinnedColumnKey:null!=d?d:void 0,stickyHeader:h,enableColumnReorder:f,isDragOver:g===n.key,sortKey:m,sortDir:p,hasFilter:!!(v[o]&&v[o].length>0),anchorRef:function(e){e&&(x.current[o]=e)},anchorRefForCallout:J,calloutKey:C===n.key?o:null,resizingColumn:w,onRenderHeader:k,onColumnHeaderClick:S,onHeaderMouseEnter:R,onHeaderMouseLeave:I,onCalloutMouseEnter:j,onCalloutMouseLeave:M,onColumnDragStart:N,onColumnDragOver:E,onColumnDrop:P,onResizeStart:D,enableCellSelection:Z,isInRangeColumn:y.isInRange,isLeftColInRange:y.isLeftCol,isRightColInRange:y.isRightCol,isCopied:Y,onSortAsc:function(){!1!==n.sortable&&(K(n),X())},onSortDesc:function(){!1!==n.sortable&&(L(n),X())},onFilter:function(){!1!==n.filterable&&T(n)},onClearFilter:function(){!1!==n.filterable&&(A(n),X())},onPinLeft:function(){F(n),X()},onPinRight:function(){O(n),X()},onUnpin:function(){_(n),X()},onToggleVisibility:function(){V&&(B(n),X())},onGroupBy:function(){!1!==n.groupable&&(H(n),X())},isGrouped:z===n.key,enableColumnVisibility:V,groupable:n.groupable,settingsable:n.settingsable,totalsable:n.totalsable,onTotalsChange:function(e){!1!==n.totalsable&&(W(n,e),X())},totalsValue:U[o]||"none",onDismiss:X},o)})]})})}function k(n){var t=n.groupKey,r=n.groupLabel,l=n.rowCount,i=n.isExpanded,a=n.onToggle,s=n.colSpan;return e.jsx("tr",o({className:"hh-group-header"},{children:e.jsx("td",o({colSpan:s,className:"hh-group-header-cell"},{children:e.jsxs("button",o({className:"hh-group-toggle",onClick:a,"aria-expanded":i},{children:[e.jsx(g,{width:16,height:16,className:i?"expanded":""}),e.jsxs("span",o({className:"hh-group-label"},{children:[r,": ",t]})),e.jsxs("span",o({className:"hh-group-count"},{children:["(",l,")"]}))]}))}))}))}var S=t.memo(function(n){var t=n.column,r=n.item,l=n.index,i=n.resizedWidth,a=n.pinPosition,s=n.leftOffset,c=n.rightOffset,u=n.lastLeftPinnedColumnKey,d=n.firstRightPinnedColumnKey,h=n.showTooltip,f=n.onDoubleClick,g=n.renderCell,m=n.getCellText,p=n.isSelected,v=void 0!==p&&p,x=n.isRangeStart,y=void 0!==x&&x,C=n.isRangeEnd,b=void 0!==C&&C,w=n.isInRange,k=void 0!==w&&w,S=n.isTopRow,R=void 0!==S&&S,I=n.isBottomRow,j=void 0!==I&&I,M=n.isLeftCol,N=void 0!==M&&M,E=n.isRightCol,P=void 0!==E&&E,D=n.isInRangeColumn,K=void 0!==D&&D,L=n.isLeftColInRange,T=void 0!==L&&L,A=n.isRightColInRange,F=void 0!==A&&A,O=n.isCopied,_=void 0!==O&&O,B=n.isFocused,H=void 0!==B&&B,z=n.rowIndex,V=n.colKey,W=n.onMouseDown,U=n.onMouseEnter,G=n.onMouseUp,q=n.enableCellSelection,X=void 0!==q&&q,Y=String(t.key),J=o(o(o(o({},t.cellStyle),{textAlign:t.align,width:i?"".concat(i,"px"):t.width,position:a?"sticky":"relative"}),"left"===a?{left:"".concat(s,"px"),zIndex:3}:{}),"right"===a?{right:"".concat(c,"px"),zIndex:3}:{}),Q=[t.cellClassName,t.editable?"hh-cell-editable":"",a?"hh-cell-pinned hh-pinned-".concat(a):"","left"===a&&t.key===u?"hh-pinned-last-left":"","right"===a&&t.key===d?"hh-pinned-first-right":"",X&&v?"hh-cell-selected":"",X&&H?"hh-cell-focused":"",X&&y?"hh-cell-range-start":"",X&&b?"hh-cell-range-end":"",X&&k?"hh-cell-in-range":"",X&&R?"hh-cell-range-top":"",X&&j?"hh-cell-range-bottom":"",X&&N?"hh-cell-range-left":"",X&&P?"hh-cell-range-right":"",X&&_?"hh-cell-copied":"",h?"hh-cell-with-tooltip":"hh-cell-no-tooltip"].filter(Boolean).join(" "),Z=h&&m?m(r,t):void 0;return e.jsx("td",o({style:J,className:Q,onDoubleClick:f,title:Z||void 0,onMouseDown:X?W:void 0,onMouseEnter:X?U:void 0,onMouseUp:X?G:void 0,"data-in-range-column":X&&K?"true":void 0,"data-left-col-in-range":X&&T?"true":void 0,"data-right-col-in-range":X&&F?"true":void 0,"data-row-index":X&&void 0!==z?z:void 0,"data-col-key":X&&V?V:void 0},{children:g(r,t,l)}),Y)},function(e,n){return e.item===n.item&&e.index===n.index&&e.column.key===n.column.key&&e.resizedWidth===n.resizedWidth&&e.pinPosition===n.pinPosition&&e.leftOffset===n.leftOffset&&e.rightOffset===n.rightOffset&&e.showTooltip===n.showTooltip&&e.isSelected===n.isSelected&&e.isFocused===n.isFocused&&e.isRangeStart===n.isRangeStart&&e.isRangeEnd===n.isRangeEnd&&e.isInRange===n.isInRange&&e.isTopRow===n.isTopRow&&e.isBottomRow===n.isBottomRow&&e.isLeftCol===n.isLeftCol&&e.isRightCol===n.isRightCol&&e.isInRangeColumn===n.isInRangeColumn&&e.isLeftColInRange===n.isLeftColInRange&&e.isRightColInRange===n.isRightColInRange&&e.isCopied===n.isCopied&&e.enableCellSelection===n.enableCellSelection&&e.renderCell===n.renderCell});function R(n){var t=n.item,r=n.index,l=n.actions,i=n.onMenuToggle,a=n.isMenuOpen,s=n.buttonRef;return l&&0!==l.length?e.jsx("td",o({className:"hh-row-actions-column"},{children:e.jsx("button",o({ref:s,type:"button",className:"hh-row-actions-button ".concat(a?"hh-row-actions-button-active":""),onClick:function(e){e.preventDefault(),e.stopPropagation(),i(t,r)},onContextMenu:function(e){e.preventDefault(),e.stopPropagation()},"aria-label":"Row actions","aria-haspopup":"true","aria-expanded":a},{children:e.jsx(f,{width:16,height:16,style:{display:"block"}})}))})):e.jsx("td",{className:"hh-row-actions-column"})}function I(n){var r=n.anchorRef,l=n.actions,i=n.item,a=n.index,s=n.onDismiss,c=n.onMouseEnter,u=n.onMouseLeave,d=t.useRef(null);if(t.useEffect(function(){var e=function(e){d.current&&!d.current.contains(e.target)&&r.current&&!r.current.contains(e.target)&&s()},n=function(e){"Escape"===e.key&&s()};return document.addEventListener("mousedown",e),document.addEventListener("keydown",n),function(){document.removeEventListener("mousedown",e),document.removeEventListener("keydown",n)}},[s,r]),!r.current||0===l.length)return null;var h=r.current.getBoundingClientRect(),f=32*l.length+8,g=window.innerHeight-h.bottom,m=h.top,p=g<f&&m>g?h.top-f-4:h.bottom+4;return e.jsx("div",o({ref:d,className:"hh-row-actions-menu",style:{position:"fixed",top:"".concat(p,"px"),left:"".concat(h.left,"px"),zIndex:1e3},onMouseEnter:c,onMouseLeave:u},{children:l.map(function(n){return e.jsxs("button",o({className:"hh-row-actions-menu-item ".concat(n.disabled?"hh-row-actions-menu-item-disabled":""),onClick:function(){return function(e){e.disabled||(e.onClick(i,a),s())}(n)},disabled:n.disabled},{children:[n.icon&&e.jsx("span",o({className:"hh-row-actions-menu-icon"},{children:n.icon})),e.jsx("span",o({className:"hh-row-actions-menu-text"},{children:n.label}))]}),n.key)})}))}function j(n){var r=n.item,l=n.index,i=n.itemKey,a=n.columns,s=n.selectionMode,c=n.isSelected,u=n.isActive,d=n.isFocused,h=void 0!==d&&d,f=n.isDragging,g=void 0!==f&&f,m=n.isDragOver,p=void 0!==m&&m,v=n.canDrag,x=n.columnWidths,C=n.pinnedColumns,b=n.lastLeftPinnedColumnKey,w=n.firstRightPinnedColumnKey,k=n.showTooltip,j=n.onItemClick,M=n.onItemContextMenu,N=n.onCheckboxChange,E=n.onCellEditStart,P=n.onDragStart,D=n.onDragOver,K=n.onDragLeave,L=n.onDrop,T=n.onDragEnd,A=n.dragIndex,F=n.renderCell,O=n.getCellText,_=n.getLeftOffset,B=n.getRightOffset,H=n.isDraggingState,z=n.rowActions,V=n.openMenuKey,W=n.onMenuToggle,U=n.onMenuDismiss,G=n.enableCellSelection,q=void 0!==G&&G,X=n.cellSelectionIndex,Y=n.isCellSelected,J=n.getCellRangeInfo,Q=n.isRowAboveRange,Z=void 0!==Q&&Q;n.isColumnInRange;var $=n.getColumnRangeInfo,ee=n.onCellMouseDown,ne=n.onCellMouseEnter,te=n.onCellMouseUp,oe=t.useMemo(function(){return[c?"hh-row-selected":"",!q&&u?"hh-row-active":"",!q&&h?"hh-row-focused":"",v?"hh-row-draggable":"",g?"hh-row-dragging":"",p?"hh-row-drag-over":"",q&&Z?"hh-row-above-range":""].filter(Boolean).join(" ")},[c,q,u,h,v,g,p,Z]),re=z?z(r,l):[],le=V===t.useMemo(function(){return"".concat(String(i),"-").concat(l)},[i,l]),ie=t.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs("tr",o({className:oe,draggable:v,onDragStart:function(e){return P(e,void 0!==A?A:l)},onDragOver:function(e){return D(e,void 0!==A?A:l)},onDragLeave:K,onDrop:function(e){return L(e,void 0!==A?A:l)},onDragEnd:T,onClick:function(e){H||q||j(r,l,e)},onContextMenu:function(e){return null==M?void 0:M(r,l,e)}},{children:["none"!==s&&e.jsx(y,{selectionMode:s,checked:c,onChange:function(e){return N(r,l,e)}}),re.length>0&&e.jsx(R,{item:r,index:l,actions:re,onMenuToggle:W,isMenuOpen:le,buttonRef:ie}),a.map(function(n,t){var o=String(n.key),i=x[o],s=C[o]||n.pinned||null,c=a.findIndex(function(e){return String(e.key)===o}),u="left"===s?_(n,c):0,d="right"===s?B(n,c):0,h=void 0!==X?X:l,f=!(!q||!Y)&&Y(h,o),g=q&&J?J(h,o):{isStart:!1,isEnd:!1,isInRange:!1,isTopRow:!1,isBottomRow:!1,isLeftCol:!1,isRightCol:!1,isCopied:!1,isFocused:!1},m=null!=g.isCopied&&g.isCopied,p=null!=g.isFocused&&g.isFocused,v=q&&Z&&$?$(o):{isInRange:!1,isLeftCol:!1,isRightCol:!1},y=v.isInRange;return e.jsx(S,{column:n,item:r,index:l,resizedWidth:i,pinPosition:s,leftOffset:u,rightOffset:d,lastLeftPinnedColumnKey:b,firstRightPinnedColumnKey:w,showTooltip:k,onDoubleClick:function(){return E(r,n,l)},renderCell:F,getCellText:O,enableCellSelection:q,isSelected:f,isFocused:p,isRangeStart:g.isStart,isRangeEnd:g.isEnd,isInRange:g.isInRange,isTopRow:g.isTopRow,isBottomRow:g.isBottomRow,isLeftCol:g.isLeftCol,isRightCol:g.isRightCol,isInRangeColumn:y,isLeftColInRange:v.isLeftCol,isRightColInRange:v.isRightCol,isCopied:m,rowIndex:h,colKey:o,onMouseDown:q&&ee?function(e){return ee(h,o,e)}:void 0,onMouseEnter:q&&ne?function(e){return ne(h,o,e)}:void 0,onMouseUp:q&&te?function(e){return te(h,o,e)}:void 0},o)})]}),i),le&&re.length>0&&e.jsx(I,{anchorRef:ie,actions:re,item:r,index:l,onDismiss:U})]})}function M(n){var o=n.data,l=n.columns,i=n.paginatedGroups,a=n.currentGroupBy,s=n.expandedGroups,c=n.selectionMode,u=n.selectedItems,d=n.activeItemIndex,h=n.focusedRowIndex,f=n.enableRowReorder,g=n.draggedRowIndex,m=n.dragOverRowIndex,p=n.isDragging,v=n.columnWidths,x=n.pinnedColumns,y=n.lastLeftPinnedColumnKey,C=n.firstRightPinnedColumnKey,b=n.showTooltip,w=n.onRenderRow,S=n.getItemKey,R=n.onItemClick,I=n.onItemContextMenu,M=n.onCheckboxChange,N=n.onCellEditStart,E=n.onRowDragStart,P=n.onRowDragOver,D=n.onRowDragLeave,K=n.onRowDrop,L=n.onRowDragEnd,T=n.renderCell,A=n.getCellText,F=n.getLeftOffset,O=n.getRightOffset,_=n.toggleGroup,B=n.filteredData,H=n.pagedData,z=n.rowActions,V=n.openMenuKey,W=n.onMenuToggle,U=n.onMenuDismiss,G=n.enableCellSelection,q=void 0!==G&&G,X=n.isCellSelected,Y=n.getCellRangeInfo,J=n.isRowAboveRange,Q=n.isColumnInRange,Z=n.getColumnRangeInfo,$=n.onCellMouseDown,ee=n.onCellMouseEnter,ne=n.onCellMouseUp,te=a?l.find(function(e){return e.key===a}):null,oe=(null==te?void 0:te.label)||(a?String(a):"");return e.jsx("tbody",{children:a&&i?i.map(function(n){var i=r(n,2),h=i[0],G=i[1],te=s.has(h);return e.jsxs(t.Fragment,{children:[e.jsx(k,{groupKey:h,groupLabel:oe,rowCount:G.length,isExpanded:te,onToggle:function(){return _(h)},colSpan:l.length+("none"!==c?1:0)+(z?1:0)}),te&&G.map(function(n,r){var i=o.findIndex(function(e){return e===n}),s=i>=0?i:B.findIndex(function(e){return e===n}),h=i>=0?i:s>=0?s:r,k=H.findIndex(function(e){return e===n}),_=k>=0?k:r,G=S(n,h),te=u.has(G),oe=i>=0&&d===i,re=B.findIndex(function(e){return e===n}),le=re>=0?re:h,ie=f&&!a;return w?e.jsx(t.Fragment,{children:w(n,h,l)},G):e.jsx(j,{item:n,index:h,itemKey:G,columns:l,selectionMode:c,isSelected:te,isActive:oe,isFocused:!1,isDragging:g===le,isDragOver:m===le,canDrag:ie,columnWidths:v,pinnedColumns:x,lastLeftPinnedColumnKey:y,firstRightPinnedColumnKey:C,showTooltip:b,onItemClick:R,onItemContextMenu:I,onCheckboxChange:M,onCellEditStart:N,onDragStart:E,onDragOver:P,onDragLeave:D,onDrop:K,onDragEnd:L,dragIndex:le,renderCell:T,getCellText:A,getLeftOffset:F,getRightOffset:O,isDraggingState:p,rowActions:z,openMenuKey:V,onMenuToggle:W,onMenuDismiss:U,enableCellSelection:q,cellSelectionIndex:_,isCellSelected:X,getCellRangeInfo:Y,isRowAboveRange:!!J&&J(_),isColumnInRange:Q,getColumnRangeInfo:Z,onCellMouseDown:$,onCellMouseEnter:ee,onCellMouseUp:ne},G)})]},h)}):H.map(function(n,o){var r=S(n,o),i=u.has(r),s=d===o,k=n===B[o]?o:B.findIndex(function(e){return e===n}),_=k>=0?k:o,H=f&&!a;return w?e.jsx(t.Fragment,{children:w(n,o,l)},r):e.jsx(j,{item:n,index:o,itemKey:r,columns:l,selectionMode:c,isSelected:i,isActive:s,isFocused:h===o,isDragging:g===_,isDragOver:m===_,canDrag:H,columnWidths:v,pinnedColumns:x,lastLeftPinnedColumnKey:y,firstRightPinnedColumnKey:C,showTooltip:b,onItemClick:R,onItemContextMenu:I,onCheckboxChange:M,onCellEditStart:N,onDragStart:E,onDragOver:P,onDragLeave:D,onDrop:K,onDragEnd:L,dragIndex:_,renderCell:T,getCellText:A,getLeftOffset:F,getRightOffset:O,isDraggingState:p,rowActions:z,openMenuKey:V,onMenuToggle:W,onMenuDismiss:U,enableCellSelection:q,cellSelectionIndex:o,isCellSelected:X,getCellRangeInfo:Y,isRowAboveRange:!!J&&J(o),isColumnInRange:Q,getColumnRangeInfo:Z,onCellMouseDown:$,onCellMouseEnter:ee,onCellMouseUp:ne},r)})})}function N(n){var t=n.columns,r=n.selectionMode,l=n.columnTotals,i=n.pinnedColumns,a=n.columnWidths,s=n.lastLeftPinnedColumnKey,c=n.firstRightPinnedColumnKey,u=n.totalCount,d=n.getLeftOffset,h=n.getRightOffset;return Object.values(l).some(function(e){return"count"===e})?e.jsx("tfoot",o({className:"hh-totals-sticky"},{children:e.jsxs("tr",o({className:"hh-totals-row"},{children:["none"!==r&&e.jsx("td",{className:"hh-selection-column"}),t.map(function(n){var r=String(n.key),f=l[r]||"none",g=i[r]||n.pinned||null,m=t.findIndex(function(e){return String(e.key)===r}),p="left"===g?d(n,m):0,v="right"===g?h(n,m):0,x=a[r],y=o(o({textAlign:n.align,width:x?"".concat(x,"px"):n.width,position:g?"sticky":"relative"},"left"===g?{left:"".concat(p,"px"),zIndex:11}:{}),"right"===g?{right:"".concat(v,"px"),zIndex:11}:{}),C=[g?"hh-cell-pinned hh-pinned-".concat(g):"","left"===g&&n.key===s?"hh-pinned-last-left":"","right"===g&&n.key===c?"hh-pinned-first-right":""].filter(Boolean).join(" "),b="";return"count"===f&&(b="Count: ".concat(u.toLocaleString())),e.jsx("td",o({style:y,className:C},{children:b}),r)})]}))})):null}function E(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function P(e,n,t,o){void 0===o&&(o="export"),"csv"===e?function(e,n,t){void 0===t&&(t="export");var o=l([n.map(function(e){return e.label}).join(",")],r(e.map(function(e){return n.map(function(n){var t=e[n.key];if(null==t)return"";var o=String(t);return o.includes(",")||o.includes('"')||o.includes("\n")?'"'.concat(o.replace(/"/g,'""'),'"'):o}).join(",")})),!1).join("\n"),i=new Blob(["\ufeff"+o],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),s=URL.createObjectURL(i);a.setAttribute("href",s),a.setAttribute("download","".concat(t,".csv")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)}(n,t,o):function(e,n,t){void 0===t&&(t="export");var o=n.map(function(e){return e.label}),r=e.map(function(e){return n.map(function(n){var t=e[n.key];return null==t?"":t})}),l='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n';l+="<head>\n",l+='<meta charset="utf-8">\n',l+="\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Sheet1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e\n",l+="</head>\n",l+="<body>\n",l+="<table>\n",l+="<tr>\n",o.forEach(function(e){l+="<th>".concat(E(String(e)),"</th>\n")}),l+="</tr>\n",r.forEach(function(e){l+="<tr>\n",e.forEach(function(e){var n=null==e?"":String(e);l+="number"==typeof e?'<td style="mso-number-format:General">'.concat(n,"</td>\n"):"<td>".concat(E(n),"</td>\n")}),l+="</tr>\n"}),l+="</table>\n",l+="</body>\n",l+="</html>";var i=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=document.createElement("a"),s=URL.createObjectURL(i);a.setAttribute("href",s),a.setAttribute("download","".concat(t,".xlsx")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)}(n,t,o)}function D(n){var l=n.data,i=n.columns,a=n.format,s=n.filename,c=n.onBeforeExport,u=n.onAfterExport,d=r(t.useState(!1),2),h=d[0],f=d[1],g=t.useCallback(function(e){f(!0);try{var n=i.filter(function(e){return e.key&&e.label}).map(function(e){return{key:e.key,label:e.label}}),t=l;if(c){var o=c(l,i);o?P(e,t=o.data,o.columns.filter(function(e){return e.key&&e.label}).map(function(e){return{key:e.key,label:e.label}}),s):P(e,t,n,s)}else P(e,t,n,s);null==u||u(e,s)}catch(e){console.error("Export failed:",e)}finally{f(!1)}},[l,i,s,c,u]);return"both"===a?e.jsxs("div",o({className:"hh-export-buttons"},{children:[e.jsxs("button",o({className:"hh-export-button",onClick:function(){return g("csv")},disabled:h,title:"Export to CSV"},{children:[e.jsx(m,{width:16,height:16}),e.jsx("span",{children:"CSV"})]})),e.jsxs("button",o({className:"hh-export-button",onClick:function(){return g("excel")},disabled:h,title:"Export to Excel"},{children:[e.jsx(m,{width:16,height:16}),e.jsx("span",{children:"Excel"})]}))]})):e.jsxs("button",o({className:"hh-export-button",onClick:function(){return g(a)},disabled:h,title:"Export to ".concat("csv"===a?"CSV":"Excel")},{children:[e.jsx(m,{width:16,height:16}),e.jsx("span",{children:"csv"===a?"CSV":"Excel"})]}))}var K={mode:"light",colors:{background:"#ffffff",surface:"#ffffff",headerBackground:"#faf9f8",rowBackground:"#ffffff",rowBackgroundAlternate:"#f9f9f9",selectedRowBackground:"#edebe9",hoverRowBackground:"#f3f2f1",groupHeaderBackground:"#f3f2f1",text:"#323130",textSecondary:"#605e5c",headerText:"#323130",rowText:"#323130",selectedRowText:"#323130",border:"#edebe9",borderLight:"#f1f1f1",rowBorder:"#f1f1f1",focus:"#107c10",focusBorder:"#107c10",hover:"#f3f2f1",active:"#edebe9",disabled:"#a19f9d",primary:"#107c10",success:"#107c10",warning:"#ffaa44",error:"#d13438"},spacing:{cellPadding:"10px 12px",headerPadding:"10px 12px",rowHeight:"auto",rowHeightCompact:"32px",rowHeightSpacious:"56px",gap:"8px"},typography:{fontFamily:'"Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif',fontSize:"14px",fontSizeSmall:"12px",fontSizeLarge:"16px",fontWeight:"400",fontWeightBold:"600",lineHeight:"20px"},borderRadius:{table:"8px",cell:"0",button:"2px"},shadows:{table:"0 2px 8px rgba(0,0,0,0.08)",header:"none",callout:"0 3.2px 7.2px rgba(0, 0, 0, 0.132), 0 0.6px 1.8px rgba(0, 0, 0, 0.108)",panel:"-2px 0 8px rgba(0, 0, 0, 0.15), -1px 0 2px rgba(0, 0, 0, 0.1)"},transitions:{duration:"0.1s",easing:"cubic-bezier(0.1, 0.9, 0.2, 1)"}},L={mode:"dark",colors:{background:"#1a1a1a",surface:"#252526",headerBackground:"#2d2d30",rowBackground:"#252526",rowBackgroundAlternate:"#2d2d30",selectedRowBackground:"#3e3e42",hoverRowBackground:"#2d2d30",groupHeaderBackground:"#2d2d30",text:"#cccccc",textSecondary:"#858585",headerText:"#cccccc",rowText:"#cccccc",selectedRowText:"#ffffff",border:"#3e3e42",borderLight:"#2d2d30",rowBorder:"#3e3e42",focus:"#4ec9b0",focusBorder:"#4ec9b0",hover:"#2d2d30",active:"#3e3e42",disabled:"#858585",primary:"#4ec9b0",success:"#4ec9b0",warning:"#dcdcaa",error:"#f48771"},spacing:{cellPadding:"10px 12px",headerPadding:"10px 12px",rowHeight:"auto",rowHeightCompact:"32px",rowHeightSpacious:"56px",gap:"8px"},typography:{fontFamily:'"Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif',fontSize:"14px",fontSizeSmall:"12px",fontSizeLarge:"16px",fontWeight:"400",fontWeightBold:"600",lineHeight:"20px"},borderRadius:{table:"8px",cell:"0",button:"2px"},shadows:{table:"0 2px 8px rgba(0,0,0,0.3)",header:"none",callout:"0 3.2px 7.2px rgba(0, 0, 0, 0.4), 0 0.6px 1.8px rgba(0, 0, 0, 0.3)",panel:"-2px 0 8px rgba(0, 0, 0, 0.4), -1px 0 2px rgba(0, 0, 0, 0.3)"},transitions:{duration:"0.1s",easing:"cubic-bezier(0.1, 0.9, 0.2, 1)"}};function T(e){if(!e)return K;if("string"==typeof e)return"dark"===e?L:K;var n="dark"===e.mode?L:K;return o(o(o({},n),e),{colors:o(o({},n.colors),e.colors),spacing:e.spacing?o(o({},n.spacing),e.spacing):n.spacing,typography:e.typography?o(o({},n.typography),e.typography):n.typography,borderRadius:e.borderRadius?o(o({},n.borderRadius),e.borderRadius):n.borderRadius,shadows:e.shadows?o(o({},n.shadows),e.shadows):n.shadows,transitions:e.transitions?o(o({},n.transitions),e.transitions):n.transitions})}function A(e){var n=e.colors,t=e.spacing,o=e.typography,r=e.borderRadius,l=e.shadows,i=e.transitions;return{"--hh-color-background":n.background,"--hh-color-surface":n.surface,"--hh-color-header-background":n.headerBackground,"--hh-color-row-background":n.rowBackground,"--hh-color-row-background-alternate":n.rowBackgroundAlternate,"--hh-color-selected-row-background":n.selectedRowBackground,"--hh-color-hover-row-background":n.hoverRowBackground,"--hh-color-group-header-background":n.groupHeaderBackground,"--hh-color-text":n.text,"--hh-color-text-secondary":n.textSecondary,"--hh-color-header-text":n.headerText,"--hh-color-row-text":n.rowText,"--hh-color-selected-row-text":n.selectedRowText,"--hh-color-border":n.border,"--hh-color-border-light":n.borderLight,"--hh-color-row-border":n.rowBorder,"--hh-color-focus":n.focus,"--hh-color-focus-border":n.focusBorder,"--hh-color-hover":n.hover,"--hh-color-active":n.active,"--hh-color-disabled":n.disabled,"--hh-color-primary":n.primary,"--hh-color-success":n.success,"--hh-color-warning":n.warning,"--hh-color-error":n.error,"--hh-spacing-cell-padding":null==t?void 0:t.cellPadding,"--hh-spacing-header-padding":null==t?void 0:t.headerPadding,"--hh-spacing-row-height":null==t?void 0:t.rowHeight,"--hh-spacing-row-height-compact":null==t?void 0:t.rowHeightCompact,"--hh-spacing-row-height-spacious":null==t?void 0:t.rowHeightSpacious,"--hh-spacing-gap":null==t?void 0:t.gap,"--hh-typography-font-family":null==o?void 0:o.fontFamily,"--hh-typography-font-size":null==o?void 0:o.fontSize,"--hh-typography-font-size-small":null==o?void 0:o.fontSizeSmall,"--hh-typography-font-size-large":null==o?void 0:o.fontSizeLarge,"--hh-typography-font-weight":null==o?void 0:o.fontWeight,"--hh-typography-font-weight-bold":null==o?void 0:o.fontWeightBold,"--hh-typography-line-height":null==o?void 0:o.lineHeight,"--hh-border-radius-table":null==r?void 0:r.table,"--hh-border-radius-cell":null==r?void 0:r.cell,"--hh-border-radius-button":null==r?void 0:r.button,"--hh-shadow-table":null==l?void 0:l.table,"--hh-shadow-header":null==l?void 0:l.header,"--hh-shadow-callout":null==l?void 0:l.callout,"--hh-shadow-panel":null==l?void 0:l.panel,"--hh-transition-duration":null==i?void 0:i.duration,"--hh-transition-easing":null==i?void 0:i.easing}}exports.ReactTabletify=function(n){var u=n.columns,d=n.data,h=n.itemsPerPage,f=void 0===h?10:h,g=n.groupBy,m=n.onRenderCell,y=n.onRenderRow,C=n.onRenderHeader;n.onItemInvoked;var b=n.onColumnHeaderClick,k=n.getKey,S=n.onActiveItemChanged,R=n.onItemContextMenu,I=n.className,j=n.styles,E=n.selectionMode,P=void 0===E?"none":E,K=n.onSelectionChanged,L=n.showPagination,F=void 0===L||L,O=n.itemsPerPageOptions,_=n.onItemsPerPageChange,B=n.theme,H=n.maxHeight,z=n.onCellEdit,V=n.pinnedColumns,W=n.onColumnPin,U=n.showTooltip,G=void 0===U||U,q=n.loading,X=void 0!==q&&q,Y=n.onRenderLoading,J=n.emptyMessage,Q=n.onRenderEmpty,Z=n.stickyHeader,$=void 0!==Z&&Z,ee=n.enableColumnVisibility,ne=n.onColumnVisibilityChange,te=n.enableColumnReorder,oe=n.onColumnReorder,re=n.enableKeyboardNavigation,le=void 0===re||re,ie=n.enableRowReorder,ae=void 0!==ie&&ie,se=n.onRowReorder,ce=n.enableExport,ue=void 0!==ce&&ce,de=n.exportFormat,he=void 0===de?"both":de,fe=n.exportFileName,ge=void 0===fe?"export":fe,me=n.onBeforeExport,pe=n.onAfterExport,ve=n.rowActions,xe=n.enableCellSelection,ye=void 0!==xe&&xe;!function(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(t[o[r]]=e[o[r]])}}(n,["columns","data","itemsPerPage","groupBy","onRenderCell","onRenderRow","onRenderHeader","onItemInvoked","onColumnHeaderClick","getKey","onActiveItemChanged","onItemContextMenu","className","styles","selectionMode","onSelectionChanged","showPagination","itemsPerPageOptions","onItemsPerPageChange","theme","maxHeight","onCellEdit","pinnedColumns","onColumnPin","showTooltip","loading","onRenderLoading","emptyMessage","onRenderEmpty","stickyHeader","enableColumnVisibility","onColumnVisibilityChange","enableColumnReorder","onColumnReorder","enableKeyboardNavigation","enableRowReorder","onRowReorder","enableExport","exportFormat","exportFileName","onBeforeExport","onAfterExport","rowActions","enableCellSelection"]);var Ce=r(t.useState(f),2),be=Ce[0],we=Ce[1],ke=r(t.useState(d),2),Se=ke[0],Re=ke[1];t.useEffect(function(){Re(d)},[d]),t.useEffect(function(){we(f)},[f]);var Ie=F?O||[10,25,50,100]:O,je=t.useCallback(function(e){we(e),_&&_(e)},[_]),Me=F?be:Number.MAX_SAFE_INTEGER,Ne=Se,Ee=i(Ne,Me),Pe=t.useRef({}),De=t.useRef(null),Ke=r(t.useState({}),2),Le=Ke[0],Te=Ke[1],Ae=r(t.useState(null),2),Fe=Ae[0],Oe=Ae[1],_e=r(t.useState(null),2),Be=_e[0],He=_e[1],ze=r(t.useState(g),2),Ve=ze[0],We=ze[1];t.useEffect(function(){void 0!==g&&We(g)},[g]);var Ue=void 0!==g?g:Ve,Ge=r(t.useState(new Set),2),qe=Ge[0],Xe=Ge[1],Ye=t.useMemo(function(){return{key:"__rowNumber__",label:"STT",width:"80px",align:"center",sortable:!1,filterable:!1,resizable:!1,editable:!1,pinned:"left",showCallout:!1,onRenderCell:function(e,n,t){return(Ee.currentPage-1)*Ee.itemsPerPage+t+1}}},[Ee.currentPage,Ee.itemsPerPage]),Je=function(e,n,i,a,s,c,u){var d=r(t.useState(n||{}),2),h=d[0],f=d[1],g=r(t.useState(new Set(e.map(function(e){return e.key}))),2),m=g[0],p=g[1],v=r(t.useState(e.map(function(e){return e.key})),2),x=v[0],y=v[1],C=r(t.useState(null),2),b=C[0],w=C[1],k=r(t.useState(null),2),S=k[0],R=k[1];t.useEffect(function(){i&&a&&a(Array.from(m))},[m,i,a]),t.useEffect(function(){s&&c&&c(x)},[x,s,c]);var I=t.useCallback(function(e){p(function(n){var t=new Set(n);return t.has(e)?t.delete(e):t.add(e),t})},[]),j=t.useCallback(function(e,n){f(function(t){var r=o({},t);return null===n?delete r[String(e)]:r[String(e)]=n,r}),u&&u(e,n)},[u]),M=t.useCallback(function(e){s&&w(e)},[s]),N=t.useCallback(function(e,n){s&&b&&b!==n&&(e.preventDefault(),R(n))},[s,b]),E=t.useCallback(function(e){s&&b&&b!==e&&(y(function(n){var t=l([],r(n),!1),o=t.indexOf(b),i=t.indexOf(e);return t.splice(o,1),t.splice(i,0,b),t}),w(null),R(null))},[s,b]),P=t.useMemo(function(){return i?e.filter(function(e){return m.has(e.key)}):e},[e,m,i]),D=t.useMemo(function(){if(!s)return P;var e=new Map(x.map(function(e,n){return[e,n]}));return l([],r(P),!1).sort(function(n,t){var o,r;return(null!==(o=e.get(n.key))&&void 0!==o?o:1/0)-(null!==(r=e.get(t.key))&&void 0!==r?r:1/0)})},[P,x,s]),K=t.useMemo(function(){var e=[],n=[],t=[];return D.forEach(function(o){var r=h[String(o.key)]||o.pinned||null;"left"===r?e.push(o):"right"===r?t.push(o):n.push(o)}),l(l(l([],r(e),!1),r(n),!1),r(t),!1)},[D,h]);return{internalPinnedColumns:h,visibleColumns:m,columnOrder:x,draggedColumn:b,dragOverColumn:S,sortedColumns:K,handleToggleColumnVisibility:I,handleColumnPin:j,handleColumnDragStart:M,handleColumnDragOver:N,handleColumnDrop:E}}(t.useMemo(function(){return ye&&!u.some(function(e){return"__rowNumber__"===String(e.key)})?l([Ye],r(u),!1):u},[ye,u,Ye]),V,ee,ne,te,oe,W),Qe=Je.internalPinnedColumns,Ze=Je.dragOverColumn,$e=Je.sortedColumns,en=Je.handleToggleColumnVisibility,nn=Je.handleColumnPin,tn=Je.handleColumnDragStart,on=Je.handleColumnDragOver,rn=Je.handleColumnDrop,ln=function(e,n,o,i,a){var s=r(t.useState(new Set),2),c=s[0],u=s[1],d=r(t.useState(void 0),2),h=d[0],f=d[1],g=t.useCallback(function(e,n){return a?a(e,n):void 0!==e.id?e.id:n},[a]),m=t.useCallback(function(t,r,l){var a=g(t,r);u(function(t){var r=new Set(t);if("single"===n?(r.clear(),l&&r.add(a)):"multiple"===n&&(l?r.add(a):r.delete(a)),o){var i=e.filter(function(e,n){return r.has(g(e,n))});o(i)}return r}),f(r),i&&i(t,r)},[n,g,o,i,e]),p=t.useCallback(function(t,r,l){if(!l.target.closest(".hh-selection-checkbox")){if("none"!==n){var a=g(t,r);u(function(t){var r=new Set(t);if("single"===n?(r.clear(),r.add(a)):"multiple"===n&&(l.ctrlKey||l.metaKey?r.has(a)?r.delete(a):r.add(a):(r.clear(),r.add(a))),o){var i=e.filter(function(e,n){return r.has(g(e,n))});o(i)}return r})}f(r),i&&i(t,r)}},[n,g,o,i,e]),v=t.useCallback(function(t){"multiple"===n&&u(function(n){var i=t?new Set(e.map(function(e,n){return g(e,n)})):new Set;if(o){var a=t?l([],r(e),!1):[];o(a)}return i})},[n,e,g,o]),x=t.useMemo(function(){return"multiple"===n&&0!==e.length&&e.every(function(e,n){return c.has(g(e,n))})},[n,e,c,g]),y=t.useMemo(function(){if("multiple"!==n||0===e.length)return!1;var t=e.filter(function(e,n){return c.has(g(e,n))}).length;return t>0&&t<e.length},[n,e,c,g]),C=t.useCallback(function(e,n){return c.has(g(e,n))},[c,g]);return{selectedItems:c,activeItemIndex:h,isAllSelected:x,isIndeterminate:y,getItemKey:g,handleCheckboxChange:m,handleItemClick:p,handleSelectAll:v,isItemSelected:C,setSelectedItems:u}}(Ne,P,K,S,k),an=ln.selectedItems,sn=ln.activeItemIndex,cn=ln.isAllSelected,un=ln.isIndeterminate,dn=ln.getItemKey,hn=ln.handleCheckboxChange,fn=ln.handleItemClick,gn=ln.handleSelectAll,mn=ln.setSelectedItems,pn=t.useCallback(function(e,n){var t=dn(e,n),o="".concat(String(t),"-").concat(n);He(function(e){return e===o?null:o})},[dn]),vn=t.useCallback(function(){He(null)},[]),xn=function(e){var n=r(t.useState({}),2),l=n[0],i=n[1],a=r(t.useState(null),2),s=a[0],c=a[1],u=r(t.useState(0),2);u[0];var d=u[1],h=r(t.useState(0),2);h[0];var f=h[1],g=t.useCallback(function(n,t){t.preventDefault(),t.stopPropagation();var r=String(n),l=e.current&&e.current[r],a=l&&l.parentElement;if(a){var s=a.offsetWidth,u=t.clientX;c(r),document.body.style.cursor="col-resize",document.body.style.userSelect="none",d(u),f(s);var h=function(e){var n=e.clientX-u,t=Math.max(50,s+n);i(function(e){var n;return o(o({},e),((n={})[r]=t,n))})},g=function(){document.body.style.cursor="",document.body.style.userSelect="",c(null),document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",g)};document.addEventListener("mousemove",h),document.addEventListener("mouseup",g)}},[e,void 0]);return{columnWidths:l,resizingColumn:s,handleResizeStart:g}}(Pe),yn=xn.columnWidths,Cn=xn.resizingColumn,bn=xn.handleResizeStart,wn=function(e){var n=r(t.useState(null),2),o=n[0],l=n[1],i=t.useRef(null),a=t.useCallback(function(n){e||(i.current&&clearTimeout(i.current),i.current=setTimeout(function(){l(n)},150))},[e]),s=t.useCallback(function(){i.current&&clearTimeout(i.current),i.current=setTimeout(function(){l(null)},200)},[]),c=t.useCallback(function(){i.current&&clearTimeout(i.current)},[]),u=t.useCallback(function(){i.current&&clearTimeout(i.current),i.current=setTimeout(function(){l(null)},200)},[]),d=t.useCallback(function(){i.current&&clearTimeout(i.current),l(null)},[]);return t.useEffect(function(){return function(){i.current&&clearTimeout(i.current)}},[]),{calloutKey:o,setCalloutKey:l,handleHeaderMouseEnter:a,handleHeaderMouseLeave:s,handleCalloutMouseEnter:c,handleCalloutMouseLeave:u,dismissCallout:d}}(Cn),kn=t.useCallback(function(e,n,t){var o=u.find(function(e){return e.key===t});return o&&o.validate&&o.validate(e,n,t)||null},[u]),Sn=t.useCallback(function(e,n,t,i){var a=kn(t,e,n);a?console.warn("Validation failed for column ".concat(String(n),": ").concat(a)):(Re(function(a){var s,c=l([],r(a),!1),u=c.findIndex(function(n){return n===e}),d=u>=0?u:i;return d>=0&&d<c.length&&(c[d]=o(o({},c[d]),((s={})[n]=t,s))),c}),z&&z(e,n,t,i))},[Se,kn,z]),Rn=function(e,n){var o=r(t.useState(null),2),l=o[0],i=o[1],a=r(t.useState(""),2),s=a[0],c=a[1],u=r(t.useState(null),2),d=u[0],h=u[1],f=r(t.useState(null),2),g=f[0],m=f[1],p=t.useRef(null),v=t.useCallback(function(e,n,t){!0===n.editable&&(i({rowIndex:t,columnKey:n.key}),c(String(null!=e[n.key]?e[n.key]:"")),m(e),h(null))},[]),x=t.useCallback(function(t,o,r){var l=null==n?void 0:n.find(function(e){return e.key===o});if(null==l?void 0:l.validate){var a=l.validate(s,t,o);if(a)return h(a),!1}return h(null),e&&e(t,o,s,r),i(null),c(""),m(null),!0},[e,s,n]),y=t.useCallback(function(){i(null),c(""),h(null),m(null)},[]);t.useEffect(function(){l&&p.current&&setTimeout(function(){if(p.current){p.current.focus();var e=p.current.value.length;p.current.setSelectionRange(e,e)}},0)},[l]);var C=t.useRef(null);return t.useEffect(function(){return l&&g&&(C.current&&clearTimeout(C.current),C.current=setTimeout(function(){var e=null==n?void 0:n.find(function(e){return e.key===l.columnKey});if(null==e?void 0:e.validate){var t=e.validate(s,g,l.columnKey);h(t||null)}else h(null)},150)),function(){C.current&&clearTimeout(C.current)}},[s,l,g,n]),{editingCell:l,editValue:s,editInputRef:p,setEditValue:c,validationError:d,handleCellEditStart:v,handleCellEditSave:x,handleCellEditCancel:y}}(Sn,u),In=Rn.editingCell,jn=Rn.editValue,Mn=Rn.editInputRef,Nn=Rn.setEditValue,En=Rn.validationError,Pn=Rn.handleCellEditStart,Dn=Rn.handleCellEditSave,Kn=Rn.handleCellEditCancel,Ln=t.useCallback(function(e,n,t){"__rowNumber__"!==String(n.key)&&Pn(e,n,t)},[Pn]),Tn=function(e,n,o,i,a){var s=r(t.useState(null),2),c=s[0],u=s[1],d=r(t.useState(null),2),h=d[0],f=d[1],g=r(t.useState(!1),2),m=g[0],p=g[1],v=r(t.useState(null),2),x=v[0],y=v[1],C=x||n;t.useEffect(function(){y(null)},[n]);var b=t.useCallback(function(n,t){e?(n.stopPropagation(),p(!0),u(t),n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text/plain",String(t)),n.currentTarget&&(n.currentTarget.style.opacity="0.5")):n.preventDefault()},[e]),w=t.useCallback(function(n,t){e&&null!==c&&(n.preventDefault(),n.dataTransfer.dropEffect="move",h!==t&&f(t))},[e,c,h]),k=t.useCallback(function(n){e&&(n.currentTarget===n.target||n.currentTarget.contains(n.relatedTarget)||f(null))},[e]),S=t.useCallback(function(n,t){if(!e||null===c||c===t)return u(null),void f(null);if(n.preventDefault(),n.stopPropagation(),i)return u(null),void f(null);var s=l([],r(C),!1),d=o[c],h=o[t],g=s.findIndex(function(e){return e===d}),m=s.findIndex(function(e){return e===h});if(-1===g||-1===m||g===m)return u(null),void f(null);var p=l([],r(s),!1),v=p[g];p.splice(g,1);var x=g<m?m-1:m;p.splice(x,0,v),y(p),a&&a(p,v,g,x),u(null),f(null)},[e,c,i,o,C,a]),R=t.useCallback(function(n){e&&(n.currentTarget&&(n.currentTarget.style.opacity="1"),p(!1),u(null),f(null),setTimeout(function(){p(!1)},100))},[e]);return{draggedRowIndex:c,dragOverRowIndex:h,isDragging:m,reorderedData:x,effectiveData:C,handleRowDragStart:b,handleRowDragOver:w,handleRowDragLeave:k,handleRowDrop:S,handleRowDragEnd:R}}(ae,Ne,Ee.filtered,Ue,se),An=Tn.draggedRowIndex,Fn=Tn.dragOverRowIndex,On=Tn.isDragging,_n=Tn.handleRowDragStart,Bn=Tn.handleRowDragOver,Hn=Tn.handleRowDragLeave,zn=Tn.handleRowDrop,Vn=Tn.handleRowDragEnd,Wn=function(e,n,o){void 0===o&&(o=!0);var l=r(t.useState(new Set),2),i=l[0],a=l[1],s=r(t.useState(null),2),c=s[0],u=s[1],d=r(t.useState(!1),2),h=d[0],f=d[1],g=r(t.useState(null),2),m=g[0],p=g[1],v=r(t.useState(!1),2),x=v[0],y=v[1],C=r(t.useState(null),2),b=C[0],w=C[1],k=t.useCallback(function(e,n){return"".concat(e,"-").concat(n)},[]),S=t.useCallback(function(e,t){var o=Math.min(e.rowIndex,t.rowIndex),r=Math.max(e.rowIndex,t.rowIndex),l=n.findIndex(function(n){return String(n.key)===e.colKey}),i=n.findIndex(function(e){return String(e.key)===t.colKey}),a=l>=0?l:0,s=i>=0?i:n.length-1,c=Math.min(a,s),u=Math.max(a,s);return{start:{rowIndex:o,colKey:String(n[Math.max(0,c)]&&n[Math.max(0,c)].key||e.colKey)},end:{rowIndex:r,colKey:String(n[Math.min(n.length-1,u)]&&n[Math.min(n.length-1,u)].key||t.colKey)}}},[n]),R=t.useCallback(function(e){for(var t=[],o=Math.min(e.start.rowIndex,e.end.rowIndex),r=Math.max(e.start.rowIndex,e.end.rowIndex),l=n.findIndex(function(n){return String(n.key)===e.start.colKey}),i=n.findIndex(function(n){return String(n.key)===e.end.colKey}),a=l>=0?l:0,s=i>=0?i:n.length-1,c=Math.min(a,s),u=Math.max(a,s),d=o;d<=r;d++)for(var h=c;h<=u;h++)n[h]&&t.push({rowIndex:d,colKey:String(n[h].key)});return t},[n]),I=t.useCallback(function(e,n,t){if(o){var r={rowIndex:e,colKey:n};if(p(r),f(!0),t&&c){var l=S(c.start,r);u(l);var i=R(l);a(new Set(i.map(function(e){return k(e.rowIndex,e.colKey)})))}else u({start:r,end:r}),a(new Set([k(e,n)]))}},[o,c,S,R,k]),j=t.useCallback(function(e,n){if(o&&h&&m){var t=S(m,{rowIndex:e,colKey:n});u(t);var r=R(t);a(new Set(r.map(function(e){return k(e.rowIndex,e.colKey)})))}},[o,h,m,S,R,k]),M=t.useCallback(function(){f(!1),p(null)},[]),N=t.useCallback(function(){a(new Set),u(null),f(!1),p(null),y(!1)},[]),E=t.useCallback(function(){w(null)},[]),P=t.useCallback(function(e,n){o&&(w({rowIndex:e,colKey:n}),0===i.size&&I(e,n,!1))},[o,i.size,I]),D=t.useCallback(function(t,r){var l;if(void 0===r&&(r=!1),!o)return null;var i=b;if(!i&&c&&(i=c.end),!i){if(!(e.length>0&&n.length>0))return null;i={rowIndex:0,colKey:String(n[0].key)}}var s=i.rowIndex,d=n.findIndex(function(e){return String(e.key)===i.colKey});if(-1===d)return null;var h=s,f=d,g=e.length-1;switch(t){case"up":h=Math.max(0,s-1);break;case"down":h=Math.min(g,s+1);break;case"left":f=Math.max(0,d-1);break;case"right":f=Math.min(n.length-1,d+1)}var p=String(null===(l=n[f])||void 0===l?void 0:l.key);if(!p)return null;var v={rowIndex:h,colKey:p};if(w(v),r){var x=m||(null==c?void 0:c.start)||i,y=S(x,v);u(y);var C=R(y);a(new Set(C.map(function(e){return k(e.rowIndex,e.colKey)})))}else I(h,p,!1);return v},[o,b,c,m,e,n,S,R,k,I]),K=t.useCallback(function(e){y(e)},[]),L=t.useCallback(function(e,n){if(o){var t=S(e,n);u(t);var r=R(t);a(new Set(r.map(function(e){return k(e.rowIndex,e.colKey)}))),f(!1),p(null)}},[o,S,R,k]),T=t.useCallback(function(e,n){return i.has(k(e,n))},[i,k]),A=t.useCallback(function(){return c?R(c):Array.from(i).map(function(e){var n=r(e.split("-"),2),t=n[0],o=n[1];return{rowIndex:parseInt(t,10),colKey:o}})},[c,i,R]),F=t.useCallback(function(){return c},[c]);return{selectedCells:i,selectedRange:c,isSelecting:h,isCopied:x,focusedCell:b,startSelection:I,updateSelection:j,endSelection:M,clearSelection:N,clearFocus:E,setCopied:K,setFocusedCell:P,setSelectionRange:L,moveFocus:D,isCellSelected:T,getSelectedCells:A,getSelectedRange:F}}(Ee.paged,$e,ye),Un=t.useRef(Ee.currentPage);t.useEffect(function(){ye&&Un.current!==Ee.currentPage&&(Wn.clearSelection(),Wn.clearFocus(),Un.current=Ee.currentPage)},[Ee.currentPage,ye,Wn.clearSelection,Wn.clearFocus]);var Gn=function(){var e=this,n=r(t.useState(null),2),o=n[0],i=n[1],a=r(t.useState(!1),2),s=a[0],c=a[1],u=r(t.useState([]),2),d=u[0],h=u[1],f=t.useCallback(function(e,n,t){if(0!==e.length){var o=l([],r(e),!1).sort(function(e,n){return e.rowIndex!==n.rowIndex?e.rowIndex-n.rowIndex:t.findIndex(function(n){return String(n.key)===e.colKey})-t.findIndex(function(e){return String(e.key)===n.colKey})}),a=new Map;o.forEach(function(e){a.has(e.rowIndex)||a.set(e.rowIndex,[]),a.get(e.rowIndex).push(e)});var s=[];a.forEach(function(e,o){var r=[];e.sort(function(e,n){return t.findIndex(function(n){return String(n.key)===e.colKey})-t.findIndex(function(e){return String(e.key)===n.colKey})}),e.forEach(function(e){var t=n[o];if(t){var l=t[e.colKey];r.push(null!=l?String(l):"")}else r.push("")}),s.push(r)}),i(s),c(!1),h([]);var u=s.map(function(e){return e.join("\t")}).join("\n");navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(u).catch(function(){var e=document.createElement("textarea");e.value=u,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)})}},[]),g=t.useCallback(function(e,n,t){f(e,n,t),c(!0),h(e)},[f]),m=t.useCallback(function(e,n,t,r){if(o&&0!==o.length&&0!==e.length){if(1===o.length&&1===o[0].length){var l=o[0][0];e.forEach(function(e){var t=n[e.rowIndex];t&&r(t,e.colKey,l,e.rowIndex)})}else{var i=e[0];if(!i)return;var a=t.findIndex(function(e){return String(e.key)===i.colKey});if(-1===a)return;o.forEach(function(e,o){var l=i.rowIndex+o;if(!(l<0||l>=n.length)){var s=n[l];s&&e.forEach(function(e,n){var o=a+n;if(!(o<0||o>=t.length)){var i=t[o];if(i)try{r(s,i.key,e,l)}catch(e){}}})}})}s&&d.length>0&&(d.forEach(function(e){var t=n[e.rowIndex];t&&r(t,e.colKey,"",e.rowIndex)}),c(!1),h([]))}},[o,s,d]),p=t.useCallback(function(n,t,o,r){return l=e,i=void 0,s=function(){var e,l,i,a,s,c,u;return function(e,n){var t,o,r,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=a(0),i.throw=a(1),i.return=a(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(s){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(l=0)),l;)try{if(t=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,o=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!((r=(r=l.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){l=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){l.label=a[1];break}if(6===a[0]&&l.label<r[1]){l.label=r[1],r=a;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(a);break}r[2]&&l.ops.pop(),l.trys.pop();continue}a=n.call(e,l)}catch(e){a=[6,e],o=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,function(d){switch(d.label){case 0:if(0===n.length)return[2,!1];d.label=1;case 1:return d.trys.push([1,5,,6]),e="",navigator.clipboard&&navigator.clipboard.readText?[4,navigator.clipboard.readText()]:[3,3];case 2:return e=d.sent(),[3,4];case 3:return[2,!1];case 4:return e&&0!==e.trim().length?0===(l=e.split(/\r?\n/).filter(function(e){return e.trim().length>0})).length||0===(i=l.map(function(e){for(var n=[],t="",o=!1,r=0;r<e.length;r++){var l=e[r];'"'===l?o&&'"'===e[r+1]?(t+='"',r++):o=!o:"\t"!==l||o?t+=l:(n.push(t),t="")}return n.push(t),n})).length||0===i[0].length?[2,!1]:(n[0],1===i.length&&1===i[0].length?(a=i[0][0],n.forEach(function(e){var n=t[e.rowIndex];n&&r(n,e.colKey,a,e.rowIndex)}),[2,!0]):(s=!1,(c=n[0])?-1===(u=o.findIndex(function(e){return String(e.key)===c.colKey}))?[2,!1]:(i.forEach(function(e,n){var l=c.rowIndex+n;if(!(l<0||l>=t.length)){var i=t[l];i&&e.forEach(function(e,n){var t=u+n;if(!(t<0||t>=o.length)){var a=o[t];if(a)try{r(i,a.key,e,l),s=!0}catch(e){}}})}}),[2,s]):[2,!1])):[2,!1];case 5:return d.sent(),[2,!1];case 6:return[2]}})},new((a=void 0)||(a=Promise))(function(e,n){function t(e){try{r(s.next(e))}catch(e){n(e)}}function o(e){try{r(s.throw(e))}catch(e){n(e)}}function r(n){var r;n.done?e(n.value):(r=n.value,r instanceof a?r:new a(function(e){e(r)})).then(t,o)}r((s=s.apply(l,i||[])).next())});var l,i,a,s},[]),v=t.useCallback(function(){return null!==o&&o.length>0},[o]),x=t.useCallback(function(){return o},[o]),y=t.useCallback(function(){i(null),c(!1),h([])},[]);return{copyCells:f,cutCells:g,pasteCells:m,pasteFromSystemClipboard:p,canPaste:v,getClipboardData:x,clearClipboard:y}}(),qn=t.useCallback(function(e,n,t){if(ye&&"__rowNumber__"!==n){t.stopPropagation();var o=t.shiftKey;Wn.startSelection(e,n,o),Wn.setFocusedCell(e,n),Wn.setCopied(!1)}},[ye,Wn]),Xn=t.useCallback(function(e,n,t){ye&&Wn.isSelecting&&"__rowNumber__"!==n&&Wn.updateSelection(e,n)},[ye,Wn]),Yn=t.useCallback(function(e,n,t){ye&&"__rowNumber__"!==n&&Wn.endSelection()},[ye,Wn]),Jn=t.useCallback(function(e,n){if(!ye)return{isStart:!1,isEnd:!1,isInRange:!1,isTopRow:!1,isBottomRow:!1,isLeftCol:!1,isRightCol:!1,isCopied:!1,isFocused:!1};var t=Wn.focusedCell&&Wn.focusedCell.rowIndex===e&&Wn.focusedCell.colKey===n;if(!Wn.selectedRange)return{isStart:!1,isEnd:!1,isInRange:!1,isTopRow:!1,isBottomRow:!1,isLeftCol:!1,isRightCol:!1,isCopied:!1,isFocused:t};var o=Wn.selectedRange,r=Math.min(o.start.rowIndex,o.end.rowIndex),l=Math.max(o.start.rowIndex,o.end.rowIndex),i=$e.findIndex(function(e){return String(e.key)===o.start.colKey}),a=$e.findIndex(function(e){return String(e.key)===o.end.colKey}),s=Math.min(i>=0?i:0,a>=0?a:$e.length-1),c=Math.max(i>=0?i:0,a>=0?a:$e.length-1),u=$e.findIndex(function(e){return String(e.key)===n});return{isStart:o.start.rowIndex===e&&o.start.colKey===n,isEnd:o.end.rowIndex===e&&o.end.colKey===n,isInRange:Wn.isCellSelected(e,n),isTopRow:e===r,isBottomRow:e===l,isLeftCol:u===s,isRightCol:u===c,isCopied:Wn.isCopied,isFocused:t}},[ye,Wn,$e]),Qn=t.useCallback(function(e){if(!ye||!Wn.selectedRange)return!1;var n=Wn.selectedRange,t=Math.min(n.start.rowIndex,n.end.rowIndex);return t>0&&e===t-1},[ye,Wn]),Zn=t.useCallback(function(){if(!ye||!Wn.selectedRange)return!1;var e=Wn.selectedRange;return 0===Math.min(e.start.rowIndex,e.end.rowIndex)},[ye,Wn]),$n=t.useCallback(function(e){if(!ye||!Wn.selectedRange)return!1;var n=Wn.selectedRange,t=$e.findIndex(function(e){return String(e.key)===n.start.colKey}),o=$e.findIndex(function(e){return String(e.key)===n.end.colKey}),r=Math.min(t>=0?t:0,o>=0?o:$e.length-1),l=Math.max(t>=0?t:0,o>=0?o:$e.length-1),i=$e.findIndex(function(n){return String(n.key)===e});return i>=r&&i<=l},[ye,Wn,$e]),et=t.useCallback(function(e){if(!ye||!Wn.selectedRange)return{isInRange:!1,isLeftCol:!1,isRightCol:!1};var n=Wn.selectedRange,t=$e.findIndex(function(e){return String(e.key)===n.start.colKey}),o=$e.findIndex(function(e){return String(e.key)===n.end.colKey}),r=Math.min(t>=0?t:0,o>=0?o:$e.length-1),l=Math.max(t>=0?t:0,o>=0?o:$e.length-1),i=$e.findIndex(function(n){return String(n.key)===e});return{isInRange:i>=r&&i<=l,isLeftCol:i===r,isRightCol:i===l}},[ye,Wn,$e]);t.useEffect(function(){if(ye){var e=function(e){if(De.current){var n=e.target;n&&!De.current.contains(n)&&(Wn.clearSelection(),Wn.clearFocus())}};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}},[ye,Wn]),t.useEffect(function(){if(ye&&De.current){var e=function(e){if(De.current){var n=e.relatedTarget;n&&!De.current.contains(n)&&(Wn.clearSelection(),Wn.clearFocus())}},n=De.current;return n.addEventListener("focusout",e),function(){n.removeEventListener("focusout",e)}}},[ye,Wn]),t.useEffect(function(){if(ye){var e=function(e){var n,t=document.activeElement;if(De.current&&t&&De.current.contains(t))if("INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&"true"!==t.getAttribute("contenteditable"))if((e.ctrlKey||e.metaKey)&&"c"===e.key){if((S=(h=Wn.getSelectedCells()).filter(function(e){return"__rowNumber__"!==e.colKey})).length>0){e.preventDefault();var o=Ue?Ee.filtered:Ee.sorted,r=(Ee.currentPage-1)*Ee.itemsPerPage,l=S.map(function(e){var n=r+e.rowIndex,t=Ee.paged[e.rowIndex];if(t){var l=o.findIndex(function(e){return e===t||dn(e,-1)===dn(t,-1)});if(l>=0)return{rowIndex:l,colKey:e.colKey}}return{rowIndex:n,colKey:e.colKey}}),i=$e.filter(function(e){return"__rowNumber__"!==String(e.key)}).map(function(e){return{key:e.key,label:e.label}});Gn.copyCells(l,o,i),Wn.setCopied(!0)}}else if((e.ctrlKey||e.metaKey)&&"x"===e.key){if((S=(h=Wn.getSelectedCells()).filter(function(e){return"__rowNumber__"!==e.colKey})).length>0){e.preventDefault();var a=Ue?Ee.filtered:Ee.sorted,s=(Ee.currentPage-1)*Ee.itemsPerPage;l=S.map(function(e){var n=s+e.rowIndex,t=Ee.paged[e.rowIndex];if(t){var o=a.findIndex(function(e){return e===t||dn(e,-1)===dn(t,-1)});if(o>=0)return{rowIndex:o,colKey:e.colKey}}return{rowIndex:n,colKey:e.colKey}}),i=$e.filter(function(e){return"__rowNumber__"!==String(e.key)}).map(function(e){return{key:e.key,label:e.label}}),Gn.cutCells(l,a,i)}}else if((e.ctrlKey||e.metaKey)&&"v"===e.key){var c=Wn.focusedCell,u=Wn.selectedRange,h=Wn.getSelectedCells(),f=null;if(c?f={rowIndex:c.rowIndex,colKey:c.colKey}:u?f={rowIndex:u.start.rowIndex,colKey:u.start.colKey}:h.length>0&&(f=h[0]),f){e.preventDefault();var g=Ue?Ee.filtered:Ee.sorted,m=Ee.paged[f.rowIndex],p=f.rowIndex;if(m){var v=g.findIndex(function(e){return e===m||dn(e,-1)===dn(m,-1)});if(v>=0)p=v;else{var x=(Ee.currentPage-1)*Ee.itemsPerPage;(p=x+f.rowIndex)>=g.length&&(p=g.length-1)}}else x=(Ee.currentPage-1)*Ee.itemsPerPage,(p=x+f.rowIndex)>=g.length&&(p=g.length-1);var y=function(e,n,t,o){var r=Ne.find(function(n){return n===e||dn(n,-1)===dn(e,-1)});if(r){var l=Ne.findIndex(function(e){return e===r});Sn(r,n,t,l>=0?l:o)}else Sn(e,n,t,o)},C=[{rowIndex:p,colKey:f.colKey}],b=f.colKey,w=function(e,n){var t=p,o=Math.min(p+e-1,g.length-1),r=$e.findIndex(function(e){return String(e.key)===b}),l=Math.min(r+n-1,$e.length-1);if(r>=0&&l>=0&&t>=0&&o>=0){var i=String($e[r].key),a=String($e[l].key),s=(Ee.currentPage-1)*Ee.itemsPerPage,c=t-s,u=o-s;c>=0&&u>=0&&c<Ee.paged.length&&u<Ee.paged.length&&requestAnimationFrame(function(){requestAnimationFrame(function(){Wn.setCopied(!1),Wn.setSelectionRange({rowIndex:c,colKey:i},{rowIndex:u,colKey:a}),Wn.setFocusedCell(c,i)})})}},k=$e.filter(function(e){return"__rowNumber__"!==String(e.key)}).map(function(e){return{key:e.key,label:e.label}});Gn.pasteFromSystemClipboard(C,g,k,y).then(function(e){if(e){var n=(o=Gn.getClipboardData())&&o.length||1,t=o&&o[0]&&o[0].length||1;requestAnimationFrame(function(){requestAnimationFrame(function(){w(n,t)})})}else if(Gn.canPaste()){var o,r=(o=Gn.getClipboardData())&&o.length||1,l=o&&o[0]&&o[0].length||1;Gn.pasteCells(C,g,k,y),requestAnimationFrame(function(){requestAnimationFrame(function(){w(r,l)})})}}).catch(function(){if(Gn.canPaste()){var e=Gn.getClipboardData(),n=e&&e.length||1,t=e&&e[0]&&e[0].length||1;Gn.pasteCells(C,g,k,y),requestAnimationFrame(function(){requestAnimationFrame(function(){w(n,t)})})}})}}else if("Delete"===e.key||"Backspace"===e.key){var S;if((S=(h=Wn.getSelectedCells()).filter(function(e){return"__rowNumber__"!==e.colKey})).length>0){e.preventDefault();var R=Ue?Ee.filtered:Ne;S.forEach(function(e){var n=R[e.rowIndex];if(n){var t=Ne.findIndex(function(e){return e===n});Sn(n,e.colKey,"",t>=0?t:e.rowIndex)}})}}else if("Escape"===e.key)Wn.clearSelection(),Wn.setCopied(!1);else if("ArrowUp"===e.key||"ArrowDown"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key){if(!In){e.preventDefault();var I="ArrowUp"===e.key?"up":"ArrowDown"===e.key?"down":"ArrowLeft"===e.key?"left":"right",j=e.shiftKey;(L=Wn.moveFocus(I,j))&&De.current&&(T=De.current.querySelector('[data-row-index="'.concat(L.rowIndex,'"][data-col-key="').concat(L.colKey,'"]')))&&T.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}}else if("Tab"!==e.key||In)if("Enter"!==e.key||In)if("Home"!==e.key&&"End"!==e.key||In){if((e.ctrlKey||e.metaKey)&&("ArrowUp"===e.key||"ArrowDown"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key)&&!In){e.preventDefault();var M=Wn.focusedCell||Wn.selectedRange&&Wn.selectedRange.end;if(M){var N=Ue?Ee.filtered:d,E=M.rowIndex;K=$e.findIndex(function(e){return String(e.key)===M.colKey}),"ArrowUp"===e.key?E=0:"ArrowDown"===e.key?E=N.length-1:"ArrowLeft"===e.key?K=0:"ArrowRight"===e.key&&(K=$e.length-1),(D=String(null===(n=$e[K])||void 0===n?void 0:n.key))&&(Wn.setFocusedCell(E,D),Wn.startSelection(E,D,e.shiftKey),De.current&&(T=De.current.querySelector('[data-row-index="'.concat(E,'"][data-col-key="').concat(D,'"]')))&&T.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}))}}}else{e.preventDefault();var P=Wn.focusedCell||Wn.selectedRange&&Wn.selectedRange.end;if(P&&$e.findIndex(function(e){return String(e.key)===P.colKey})>=0){var D,K="Home"===e.key?0:$e.length-1;(D=String($e[K]&&$e[K].key||""))&&(Wn.setFocusedCell(P.rowIndex,D),Wn.startSelection(P.rowIndex,D,e.shiftKey))}}else e.preventDefault(),I=e.shiftKey?"up":"down",(L=Wn.moveFocus(I,!1))&&De.current&&(T=De.current.querySelector('[data-row-index="'.concat(L.rowIndex,'"][data-col-key="').concat(L.colKey,'"]')))&&T.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"});else{e.preventDefault();var L,T;I=e.shiftKey?"left":"right";(L=Wn.moveFocus(I,!1))&&De.current&&(T=De.current.querySelector('[data-row-index="'.concat(L.rowIndex,'"][data-col-key="').concat(L.colKey,'"]')))&&T.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}else(e.ctrlKey||e.metaKey)&&("c"===e.key||"x"===e.key||e.key)};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}},[ye,Wn,Gn,Ee.paged,$e,z,Ue,d,In,Ee.filtered]);var nt=t.useMemo(function(){return Fe?Array.from(new Set(d.map(function(e){return String(e[Fe])}))):[]},[Fe,d]);t.useEffect(function(){Ue&&Ee.setCurrentPage(1)},[Ue]);var tt=t.useMemo(function(){if(!Ue)return null;var e={};return(Ee.sortKey?l([],r(Ee.filtered),!1).sort(function(e,n){var t=e[Ee.sortKey],o=n[Ee.sortKey];if(null==t)return 1;if(null==o)return-1;if(t===o)return 0;var r=String(t).localeCompare(String(o),void 0,{numeric:!0,sensitivity:"base"});return"asc"===Ee.sortDir?r:-r}):Ee.filtered).forEach(function(n){var t=String(n[Ue]);e[t]||(e[t]=[]),e[t].push(n)}),e},[Ee.filtered,Ee.sortKey,Ee.sortDir,Ue]);t.useEffect(function(){if(Ue&&tt){var e=Object.keys(tt).length,n=Math.ceil(e/Ee.itemsPerPage);Ee.currentPage>n&&n>0&&Ee.setCurrentPage(1)}},[tt,Ue,Ee.itemsPerPage,Ee.currentPage,Ee.setCurrentPage]);var ot=t.useMemo(function(){if(!Ue||!tt)return null;var e=Object.entries(tt);e.sort(function(e,n){var t=r(e,1)[0],o=r(n,1)[0];return t.localeCompare(o)});var n=(Ee.currentPage-1)*Ee.itemsPerPage,t=n+Ee.itemsPerPage;return e.slice(n,t)},[tt,Ee.currentPage,Ee.itemsPerPage,Ue]);t.useEffect(function(){Ue&&tt?Xe(new Set(Object.keys(tt))):Ue||Xe(new Set)},[Ue,tt]);var rt=t.useCallback(function(e,n){if(n.onRenderCell){var t=n.onRenderCell(e,n.key,0);return String("string"==typeof t||"number"==typeof t?t:null!=e[n.key]?e[n.key]:"")}return m?(t=m(e,n.key,0),String("string"==typeof t||"number"==typeof t?t:null!=e[n.key]?e[n.key]:"")):String(null!=e[n.key]?e[n.key]:"")},[m]),lt=t.useCallback(function(n,t,r){var l=In&&In.rowIndex===r&&In.columnKey===t.key,i=l&&null!==En;return l&&t.editable?ye?e.jsxs("div",o({className:"hh-cell-edit-wrapper"},{children:[e.jsx("input",{ref:Mn,type:"text",className:"hh-cell-edit-input hh-cell-edit-input-excel ".concat(i?"hh-cell-edit-input-error":""),value:jn,onChange:function(e){return Nn(e.target.value)},onBlur:function(){!1===Dn(n,t.key,r)&&Mn.current&&setTimeout(function(){Mn.current&&Mn.current.focus()},0)},onKeyDown:function(e){"Enter"===e.key?(e.preventDefault(),!1===Dn(n,t.key,r)&&Mn.current&&Mn.current.focus()):"Escape"===e.key&&(e.preventDefault(),Kn()),"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Tab"!==e.key&&"Home"!==e.key&&"End"!==e.key||e.stopPropagation()},onClick:function(e){e.stopPropagation()},onFocus:function(e){var n=e.target;n&&setTimeout(function(){var e=n.value.length;n.setSelectionRange(e,e)},0)},onMouseDown:function(e){e.stopPropagation()}}),i&&e.jsx("div",o({className:"hh-cell-edit-error-message"},{children:En}))]})):e.jsxs("div",o({className:"hh-cell-edit-container"},{children:[e.jsx("input",{ref:Mn,type:"text",className:"hh-cell-edit-input ".concat(i?"hh-cell-edit-input-error":""),value:jn,onChange:function(e){return Nn(e.target.value)},onKeyDown:function(e){"Enter"===e.key?(e.preventDefault(),!1===Dn(n,t.key,r)&&Mn.current&&Mn.current.focus()):"Escape"===e.key&&(e.preventDefault(),Kn()),"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Tab"!==e.key&&"Home"!==e.key&&"End"!==e.key||e.stopPropagation()},onClick:function(e){e.stopPropagation()},onFocus:function(e){var n=e.target;n&&setTimeout(function(){var e=n.value.length;n.setSelectionRange(e,e)},0)},onMouseDown:function(e){e.stopPropagation()}}),e.jsxs("div",o({className:"hh-cell-edit-buttons"},{children:[e.jsx("button",o({type:"button",className:"hh-cell-edit-button hh-cell-edit-save",onClick:function(e){e.stopPropagation(),e.preventDefault(),!1===Dn(n,t.key,r)&&Mn.current&&Mn.current.focus()},onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},title:"Save"},{children:e.jsx(s,{width:12,height:12})})),e.jsx("button",o({type:"button",className:"hh-cell-edit-button hh-cell-edit-cancel",onClick:function(e){e.stopPropagation(),e.preventDefault(),Kn()},onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},title:"Cancel"},{children:e.jsx(c,{width:12,height:12})}))]})),i&&e.jsx("div",o({className:"hh-cell-edit-error-message"},{children:En}))]})):t.onRenderCell?t.onRenderCell(n,t.key,r):m?m(n,t.key,r):String(null!=n[t.key]?n[t.key]:"")},[m,In,jn,En,Dn,Kn]),it=t.useMemo(function(){return T(B)},[B]),at=t.useMemo(function(){return A(it)},[it]),st=t.useMemo(function(){return Ue&&ot?ot.flatMap(function(e){var n=r(e,2);return n[0],n[1]}):Ee.paged},[Ue,ot,Ee.paged]),ct=function(e,n,o,l,i,a,s){var c=r(t.useState(null),2),u=c[0],d=c[1];return t.useEffect(function(){if(n&&e.current&&!o){var t=function(e){if(!o&&0!==l.length){var n=document.activeElement;if(!n||"INPUT"!==n.tagName&&"TEXTAREA"!==n.tagName&&"true"!==n.getAttribute("contenteditable")){var t=null!=u?u:0;switch(e.key){case"ArrowDown":e.preventDefault(),t=Math.min(t+1,l.length-1),d(t);break;case"ArrowUp":e.preventDefault(),t=Math.max(t-1,0),d(t);break;case"Enter":case" ":if(e.preventDefault(),null!==u&&"none"!==i){var r=l[u],c=a(r,u);s&&s(new Set([c]))}break;case"Escape":e.preventDefault(),d(null),s&&s(new Set)}}}};return e.current.addEventListener("keydown",t),function(){e.current&&e.current.removeEventListener("keydown",t)}}},[n,o,u,i,l,a,s,e]),{focusedRowIndex:u,setFocusedRowIndex:d}}(De,le,X,st,P,dn,function(e){return mn(e)}).focusedRowIndex,ut=Ne.length>0,dt=!X&&!ut,ht=!X&&ut,ft=t.useCallback(function(e,n){var t=String(e.key);if("left"!==(Qe[t]||e.pinned||null))return 0;var o=0;"none"!==P&&(o+=48);for(var r=0;r<n;r++){var l=$e[r];"left"===(Qe[String(l.key)]||l.pinned||null)&&(o+=yn[String(l.key)]||("number"==typeof l.width?l.width:parseFloat(l.width||"0"))||("string"==typeof l.width&&l.width.includes("px")?parseFloat(l.width):100))}return o},[$e,Qe,yn,P]),gt=t.useCallback(function(e,n){var t=String(e.key);if("right"!==(Qe[t]||e.pinned||null))return 0;for(var o=0,r=n+1;r<$e.length;r++){var l=$e[r];"right"===(Qe[String(l.key)]||l.pinned||null)&&(o+=yn[String(l.key)]||("number"==typeof l.width?l.width:parseFloat(l.width||"0"))||("string"==typeof l.width&&l.width.includes("px")?parseFloat(l.width):100))}return o},[$e,Qe,yn]),mt=t.useMemo(function(){for(var e=null,n=0;n<$e.length;n++){var t=$e[n];if("left"===(Qe[String(t.key)]||t.pinned||null))e=t.key;else if(null!==e)break}return e},[$e,Qe]),pt=t.useMemo(function(){for(var e=0;e<$e.length;e++){var n=$e[e];if("right"===(Qe[String(n.key)]||n.pinned||null))return n.key}return null},[$e,Qe]);return e.jsxs("div",o({ref:De,className:"hh-table ".concat(I||""," hh-theme-").concat(it.mode||"light"," ").concat(Cn?"resizing":""," ").concat($?"hh-sticky-header":""," ").concat(ye?"enable-cell-selection":""),style:o(o(o(o({},at),j),H?{maxHeight:"number"==typeof H?"".concat(H,"px"):H,overflow:"auto"}:{}),Cn?{cursor:"col-resize"}:{}),onScroll:t.useCallback(function(e){requestAnimationFrame(function(){})},[]),tabIndex:ye||le?0:void 0},{children:[ue&&e.jsx("div",o({className:"hh-export-toolbar"},{children:e.jsx(D,{data:Ee.filtered,columns:$e,format:he,filename:ge,onBeforeExport:me,onAfterExport:pe})})),X&&e.jsx(v,{columns:$e,itemsPerPage:f,selectionMode:P,onRenderLoading:Y}),dt&&e.jsx(x,{emptyMessage:J,onRenderEmpty:Q}),ht&&e.jsx("div",o({style:o({overflowX:"auto",overflowY:$&&!H?"auto":"visible",width:"100%"},$&&!H?{maxHeight:"calc(100vh - 200px)"}:{})},{children:e.jsxs("table",{children:[e.jsx(w,{columns:$e,selectionMode:P,isAllSelected:cn,isIndeterminate:un,onSelectAll:gn,columnWidths:yn,pinnedColumns:Qe,lastLeftPinnedColumnKey:mt,firstRightPinnedColumnKey:pt,stickyHeader:$,enableColumnReorder:te||!1,dragOverColumn:Ze,sortKey:Ee.sortKey,sortDir:Ee.sortDir,filters:Ee.filters,anchorRefs:Pe,calloutKey:wn.calloutKey,resizingColumn:Cn,onRenderHeader:C,onColumnHeaderClick:b,onHeaderMouseEnter:function(e){if("__rowNumber__"!==e){var n=$e.find(function(n){return String(n.key)===e});n&&!1===n.showCallout||wn.handleHeaderMouseEnter(e)}},onHeaderMouseLeave:wn.handleHeaderMouseLeave,onCalloutMouseEnter:wn.handleCalloutMouseEnter,onCalloutMouseLeave:wn.handleCalloutMouseLeave,onColumnDragStart:tn,onColumnDragOver:on,onColumnDrop:rn,onResizeStart:bn,onSortAsc:function(e){"__rowNumber__"!==String(e.key)&&!1!==e.sortable&&Ee.handleSort(e.key,"asc")},onSortDesc:function(e){"__rowNumber__"!==String(e.key)&&!1!==e.sortable&&Ee.handleSort(e.key,"desc")},onFilter:function(e){var n;"__rowNumber__"!==String(e.key)&&!1!==e.filterable&&(n=e.key,Oe(String(n)),wn.dismissCallout())},onClearFilter:function(e){"__rowNumber__"!==String(e.key)&&!1!==e.filterable&&Ee.setFilter(String(e.key),[])},onPinLeft:function(e){"__rowNumber__"!==String(e.key)&&nn(e.key,"left")},onPinRight:function(e){"__rowNumber__"!==String(e.key)&&nn(e.key,"right")},onUnpin:function(e){"__rowNumber__"!==String(e.key)&&nn(e.key,null)},onToggleVisibility:function(e){"__rowNumber__"!==String(e.key)&&ee&&en(e.key)},onGroupBy:function(e){"__rowNumber__"!==String(e.key)&&(Ue===e.key?We(void 0):We(e.key))},currentGroupBy:Ue,enableColumnVisibility:ee||!1,onTotalsChange:function(e,n){Te(function(t){var r;return o(o({},t),((r={})[String(e.key)]=n,r))})},columnTotals:Le,getLeftOffset:ft,getRightOffset:gt,dismissCallout:wn.dismissCallout,enableRowActions:!!ve,enableCellSelection:ye,isRangeFromFirstRow:Zn(),isColumnInRange:$n,getColumnRangeInfo:et,isCopied:Wn.isCopied}),e.jsx(M,{data:Ne,columns:$e,paginatedGroups:ot||void 0,currentGroupBy:Ue,expandedGroups:qe,selectionMode:P,selectedItems:an,activeItemIndex:sn,focusedRowIndex:null!=ct?ct:void 0,enableRowReorder:ae,draggedRowIndex:An,dragOverRowIndex:Fn,isDragging:On,columnWidths:yn,pinnedColumns:Qe,lastLeftPinnedColumnKey:mt||void 0,firstRightPinnedColumnKey:pt||void 0,showTooltip:G,onRenderRow:y,getItemKey:dn,onItemClick:fn,onItemContextMenu:R,onCheckboxChange:hn,onCellEditStart:Ln,onRowDragStart:_n,onRowDragOver:Bn,onRowDragLeave:Hn,onRowDrop:zn,onRowDragEnd:Vn,renderCell:lt,getCellText:rt,getLeftOffset:ft,getRightOffset:gt,toggleGroup:function(e){Xe(function(n){var t=new Set(n);return t.has(e)?t.delete(e):t.add(e),t})},filteredData:Ee.filtered,pagedData:Ee.paged,rowActions:ve,openMenuKey:Be,onMenuToggle:pn,onMenuDismiss:vn,enableCellSelection:ye,isCellSelected:Wn.isCellSelected,getCellRangeInfo:Jn,isRowAboveRange:Qn,isColumnInRange:$n,getColumnRangeInfo:et,onCellMouseDown:qn,onCellMouseEnter:Xn,onCellMouseUp:Yn}),e.jsx(N,{columns:$e,selectionMode:P,columnTotals:Le,pinnedColumns:Qe,columnWidths:yn,lastLeftPinnedColumnKey:mt||void 0,firstRightPinnedColumnKey:pt||void 0,totalCount:Ee.filtered.length,getLeftOffset:ft,getRightOffset:gt})]})})),ht&&F&&e.jsx(a,{totalItems:Ue&&tt?Object.keys(tt).length:Ee.filtered.length,itemsPerPage:Ee.itemsPerPage,currentPage:Ee.currentPage,onPageChange:Ee.setCurrentPage,itemsPerPageOptions:Ie,onItemsPerPageChange:function(e){je(e),Ee.setCurrentPage(1)}}),Fe&&e.jsx(p,{field:Fe,values:nt,selected:Ee.filters[Fe]||[],onApply:function(e){Ee.setFilter(Fe,e),Oe(null)},onDismiss:function(){return Oe(null)}})]}))},exports.applyTheme=A,exports.defaultDarkTheme=L,exports.defaultLightTheme=K,exports.getTheme=T,exports.useTable=i;
