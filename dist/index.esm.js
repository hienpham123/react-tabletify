import{jsxs as e,jsx as n,Fragment as t}from"react/jsx-runtime";import*as o from"react";var r=function(){return r=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},r.apply(this,arguments)};function l(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var o,r,l=t.call(e),i=[];try{for(;(void 0===n||n-- >0)&&!(o=l.next()).done;)i.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(t=l.return)&&t.call(l)}finally{if(r)throw r.error}}return i}function i(e,n,t){if(t||2===arguments.length)for(var o,r=0,l=n.length;r<l;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}function a(e,n){void 0===n&&(n=10);var t=l(o.useState(""),2),a=t[0],c=t[1],u=l(o.useState(null),2),s=u[0],d=u[1],h=l(o.useState("asc"),2),f=h[0],g=h[1],m=l(o.useState(1),2),p=m[0],v=m[1],y=l(o.useState({}),2),C=y[0],b=y[1],w=function(e,n){b(function(t){var o=r({},t);return 0===n.length?delete o[e]:o[e]=n,o})},x=o.useMemo(function(){var n=e;if(Object.entries(C).forEach(function(e){var t=l(e,2),o=t[0],r=t[1];r.length>0&&(n=n.filter(function(e){return r.includes(String(e[o]))}))}),a.trim()){var t=a.toLowerCase();n=n.filter(function(e){return Object.values(e).some(function(e){return String(e).toLowerCase().includes(t)})})}return n},[e,a,C]),k=o.useMemo(function(){return s?i([],l(x),!1).sort(function(e,n){var t=e[s],o=n[s];if(null==t)return 1;if(null==o)return-1;if(t===o)return 0;var r=String(t).localeCompare(String(o),void 0,{numeric:!0,sensitivity:"base"});return"asc"===f?r:-r}):x},[x,s,f]),S=Math.ceil(k.length/n),R=o.useMemo(function(){var e=(p-1)*n;return k.slice(e,e+n)},[k,p,n]);o.useEffect(function(){v(1)},[a,s,f,C]);var I=o.useCallback(function(){c("")},[]),M=o.useCallback(function(){b({})},[]),N=o.useCallback(function(e){w(e,[])},[w]),E=o.useCallback(function(){d(null),g("asc")},[]),P=o.useCallback(function(){c(""),b({}),d(null),g("asc"),v(1)},[]),D=o.useCallback(function(){v(1)},[]),K=o.useCallback(function(){v(S)},[S]),L=o.useCallback(function(){v(function(e){return Math.min(e+1,S)})},[S]),T=o.useCallback(function(){v(function(e){return Math.max(e-1,1)})},[]);return{filtered:x,sorted:k,paged:R,currentPage:p,setCurrentPage:v,totalPages:S,itemsPerPage:n,goToFirstPage:D,goToLastPage:K,goToNextPage:L,goToPrevPage:T,search:a,setSearch:c,clearSearch:I,sortKey:s,sortDir:f,handleSort:function(e,n){n?(d(e),g(n)):s===e?g(function(e){return"asc"===e?"desc":"asc"}):(d(e),g("asc"))},resetSort:E,filters:C,setFilter:w,clearFilter:N,clearFilters:M,resetAll:P}}"function"==typeof SuppressedError&&SuppressedError;var c=function(o){var l=o.totalItems,i=o.itemsPerPage,a=o.currentPage,c=o.onPageChange,u=o.maxVisible,s=void 0===u?5:u,d=o.itemsPerPageOptions,h=o.onItemsPerPageChange,f=Math.ceil(l/i),g=Math.floor(s/2),m=Math.max(1,a-g),p=Math.min(f,m+s-1);p-m<s-1&&(m=Math.max(1,p-s+1));var v=Array.from({length:p-m+1},function(e,n){return m+n}),y=function(e){e<1||e>f||e===a||c(e)};return!(f<=0)||d&&h?e("div",r({className:"hh-pagination"},{children:[n("button",r({onClick:function(){return y(a-1)},disabled:1===a,className:"hh-pagination-btn hh-pagination-arrow","aria-label":"Previous page"},{children:"<"})),m>1&&e(t,{children:[n("button",r({className:"hh-pagination-btn",onClick:function(){return y(1)}},{children:"1"})),m>2&&n("span",r({className:"hh-pagination-ellipsis"},{children:"..."}))]}),v.map(function(e){return n("button",r({onClick:function(){return y(e)},className:"hh-pagination-btn ".concat(e===a?"hh-page-active":"")},{children:e}),e)}),p<f&&e(t,{children:[p<f-1&&n("span",r({className:"hh-pagination-ellipsis"},{children:"..."})),n("button",r({className:"hh-pagination-btn",onClick:function(){return y(f)}},{children:f}))]}),n("button",r({onClick:function(){return y(a+1)},disabled:a===f,className:"hh-pagination-btn hh-pagination-arrow","aria-label":"Next page"},{children:">"})),d&&h&&e("div",r({className:"hh-pagination-items-per-page"},{children:[n("label",r({htmlFor:"hh-items-per-page-select",style:{marginRight:"8px"}},{children:"Rows per page:"})),n("select",r({id:"hh-items-per-page-select",value:i,onChange:function(e){var n=Number(e.target.value);h(n),c(1)},className:"hh-pagination-select"},{children:d.map(function(e){return n("option",r({value:e},{children:e}),e)})}))]}))]})):null};function u(e){var t=e.width,o=void 0===t?12:t,l=e.height,i=void 0===l?12:l,a=e.className,c=e.style;return n("svg",r({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:o,height:i,className:a,style:c},{children:n("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}))}function s(e){var t=e.width,o=void 0===t?12:t,l=e.height,i=void 0===l?12:l,a=e.className,c=e.style;return n("svg",r({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:o,height:i,className:a,style:c},{children:n("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})}))}function d(e){var t=e.width,o=void 0===t?16:t,l=e.height,i=void 0===l?16:l,a=e.className,c=e.style;return n("svg",r({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",fill:"currentColor",width:o,height:i,className:a,style:c},{children:n("path",{d:"M1799 349l242 241-1017 1017L7 590l242-241 775 775 775-775z"})}))}function h(e){var t=e.width,o=void 0===t?14:t,l=e.height,i=void 0===l?14:l,a=e.className,c=e.style;return n("svg",r({xmlns:"http://www.w3.org/2000/svg",width:o,height:i,viewBox:"0 0 2048 2048",fill:"currentColor",className:a,style:c},{children:n("path",{d:"M1990 748q-33 33-64 60t-66 47-73 29-89 11q-34 0-65-6l-379 379q13 38 19 78t6 80q0 65-13 118t-37 100-60 89-79 87l-386-386-568 569-136 45 45-136 569-568-386-386q44-44 86-79t89-59 100-38 119-13q40 0 80 6t78 19l379-379q-6-31-6-65 0-49 10-88t30-74 46-65 61-65l690 690z"})}))}function f(e){var t=e.width,o=void 0===t?14:t,l=e.height,i=void 0===l?14:l,a=e.className,c=e.style;return n("svg",r({xmlns:"http://www.w3.org/2000/svg",width:o,height:i,viewBox:"0 0 2048 2048",fill:"currentColor",className:a,style:c},{children:n("path",{d:"M2048 128v219l-768 768v805H768v-805L0 347V128h2048z"})}))}function g(t){var o=t.width,l=void 0===o?16:o,i=t.height,a=void 0===i?16:i,c=t.className,u=t.style;return e("svg",r({width:l,height:a,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:c,style:u},{children:[n("circle",{cx:"4",cy:"8",r:"1.5",fill:"currentColor"}),n("circle",{cx:"8",cy:"8",r:"1.5",fill:"currentColor"}),n("circle",{cx:"12",cy:"8",r:"1.5",fill:"currentColor"})]}))}function m(e){var t=e.width,o=void 0===t?16:t,l=e.height,i=void 0===l?16:l,a=e.className,c=e.style;return n("svg",r({width:o,height:i,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:a,style:c},{children:n("path",{d:"M6 4L10 8L6 12",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})}))}function p(e){var t=e.width,o=void 0===t?16:t,l=e.height,i=void 0===l?16:l,a=e.className,c=e.style;return n("svg",r({width:o,height:i,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:a,style:c},{children:n("path",{d:"M2 2h12v12H2V2zm1 1v10h10V3H3zm1 1h8v1H4V4zm0 2h8v1H4V6zm0 2h8v1H4V8zm0 2h5v1H4v-1z",fill:"currentColor"})}))}function v(t){var a=t.field,c=t.values,u=t.selected,d=t.onApply,h=t.onDismiss,f=l(o.useState(u),2),g=f[0],m=f[1],p=l(o.useState(""),2),v=p[0],y=p[1];o.useEffect(function(){m(u),y("")},[a]);var C=o.useMemo(function(){if(!v.trim())return c;var e=v.toLowerCase();return c.filter(function(n){return n.toLowerCase().includes(e)})},[c,v]);return e("div",r({className:"hh-filter-panel open"},{children:[e("div",r({className:"hh-filter-header"},{children:[e("strong",{children:["Filter by '",a,"'"]}),n("button",r({className:"hh-filter-close",onClick:h,"aria-label":"Close"},{children:n(s,{width:16,height:16})}))]})),e("div",r({className:"hh-filter-content"},{children:[n("div",r({className:"hh-filter-search"},{children:n("input",{type:"text",className:"hh-filter-search-input",placeholder:"Select ".concat(a," to display..."),value:v,onChange:function(e){return y(e.target.value)}})})),n("div",r({className:"hh-filter-options-list"},{children:C.length>0?C.map(function(t){return e("div",r({className:"hh-filter-option"},{children:[n("input",{type:"checkbox",id:"filter-".concat(a,"-").concat(t),checked:g.includes(t),onChange:function(){return function(e){m(function(n){return n.includes(e)?n.filter(function(n){return n!==e}):i(i([],l(n),!1),[e],!1)})}(t)}}),n("label",r({htmlFor:"filter-".concat(a,"-").concat(t)},{children:t}))]}),t)}):n("div",r({className:"hh-filter-no-results"},{children:"No results found"}))}))]})),e("div",r({className:"hh-filter-footer"},{children:[n("button",r({className:"hh-btn",onClick:function(){m([])}},{children:"Clear all"})),n("button",r({className:"hh-btn primary",onClick:function(){return d(g)}},{children:"Apply"}))]}))]}))}function y(o){var l=o.columns,i=o.itemsPerPage,a=o.selectionMode,c=o.onRenderLoading;return c?n(t,{children:c()}):e("div",r({className:"hh-loading-skeleton"},{children:[e("div",r({className:"hh-skeleton-header"},{children:["none"!==a&&n("div",{className:"hh-skeleton-cell",style:{width:"48px"}}),l.map(function(e,t){return n("div",{className:"hh-skeleton-cell",style:{width:e.width||"150px"}},t)})]})),Array.from({length:i}).map(function(t,o){return e("div",r({className:"hh-skeleton-row"},{children:["none"!==a&&n("div",{className:"hh-skeleton-cell",style:{width:"48px"}}),l.map(function(e,t){return n("div",{className:"hh-skeleton-cell",style:{width:e.width||"150px"}},t)})]}),o)})]}))}function C(o){var l=o.emptyMessage,i=o.onRenderEmpty;return i?n(t,{children:i()}):e("div",r({className:"hh-empty-state"},{children:[n("div",r({className:"hh-empty-icon"},{children:"ðŸ“‹"})),n("div",r({className:"hh-empty-message"},{children:l||"No data available"}))]}))}function b(e){var t=e.selectionMode,o=e.checked,l=e.indeterminate,i=e.onChange,a=e.onSelectAll;if("none"===t)return null;var c=void 0!==a;return n("td",r({className:"hh-selection-column"},{children:n("div",r({className:"hh-selection-checkbox-wrapper"},{children:"multiple"===t?n("input",{type:"checkbox",className:"hh-selection-checkbox",checked:o,ref:function(e){e&&void 0!==l&&(e.indeterminate=l)},onChange:function(e){c&&a?a(e.target.checked):i(e.target.checked)},onClick:function(e){return e.stopPropagation()}}):c?n("div",{className:"hh-selection-checkbox-wrapper"}):n("input",{type:"radio",className:"hh-selection-checkbox",checked:o,onChange:function(e){return i(e.target.checked)},onClick:function(e){return e.stopPropagation()}})}))}))}function w(i){var a=i.anchorRef,c=i.onSortAsc,u=i.onSortDesc,s=i.onFilter,d=i.onClearFilter,h=i.onPinLeft,f=i.onPinRight,g=i.onUnpin,m=i.onToggleVisibility,p=i.onGroupBy,v=i.isGrouped,y=void 0!==v&&v,C=i.onColumnSettings,b=i.onTotalsChange,w=i.totalsValue,x=void 0===w?"none":w,k=i.columnLabel,S=void 0===k?"Column":k;i.onDismiss;var R=i.onMouseEnter,I=i.onMouseLeave,M=i.sortable,N=void 0===M||M,E=i.filterable,P=void 0===E||E,D=i.hasFilter,K=void 0!==D&&D,L=i.pinned,T=void 0===L?null:L,A=i.visible,O=void 0===A||A,F=i.enableColumnVisibility,_=void 0!==F&&F;i.enableColumnReorder;var B=i.groupable,H=void 0!==B&&B,z=i.settingsable,V=void 0!==z&&z,W=i.totalsable,U=void 0!==W&&W,j=o.useRef(null),G=l(o.useState(null),2),q=G[0],X=G[1],Y=o.useRef(null);if(o.useEffect(function(){return function(){Y.current&&clearTimeout(Y.current)}},[]),!a.current)return null;var J=a.current.getBoundingClientRect(),Q=function(e){Y.current&&clearTimeout(Y.current),X(e)},Z=function(){Y.current=setTimeout(function(){X(null)},150)};return n(t,{children:e("div",r({ref:j,className:"hh-callout",style:{top:J.bottom+6,left:J.left,position:"fixed"},onMouseEnter:R,onMouseLeave:I},{children:[N&&e(t,{children:[n("button",r({onClick:c,className:"hh-callout-item"},{children:n("span",r({className:"hh-callout-text"},{children:"Ascending"}))})),n("button",r({onClick:u,className:"hh-callout-item"},{children:n("span",r({className:"hh-callout-text"},{children:"Descending"}))}))]}),N&&P&&n("hr",{className:"hh-callout-divider"}),P&&K&&d&&n("button",r({onClick:d,className:"hh-callout-item"},{children:n("span",r({className:"hh-callout-text"},{children:"Clear filter"}))})),P&&K&&d&&n("hr",{className:"hh-callout-divider"}),P&&n("button",r({onClick:s,className:"hh-callout-item"},{children:n("span",r({className:"hh-callout-text"},{children:"Filter by"}))})),H&&p&&e(t,{children:[n("hr",{className:"hh-callout-divider"}),e("button",r({onClick:p,className:"hh-callout-item ".concat(y?"hh-callout-item-selected":"")},{children:[e("span",r({className:"hh-callout-text"},{children:["Group by ",S]})),y&&n("span",r({className:"hh-callout-checkmark"},{children:"âœ“"}))]}))]}),(V&&C||U)&&n("hr",{className:"hh-callout-divider"}),V&&C&&e("div",r({className:"hh-callout-item hh-callout-item-with-submenu",onMouseEnter:function(){return Q("column-settings")},onMouseLeave:Z},{children:[n("span",r({className:"hh-callout-text"},{children:"Column settings"})),n("span",r({className:"hh-callout-arrow"},{children:"â€º"})),"column-settings"===q&&e("div",r({className:"hh-callout-submenu",onMouseEnter:function(){return Q("column-settings")},onMouseLeave:Z},{children:[null===T&&h&&n("button",r({onClick:h,className:"hh-callout-submenu-item"},{children:n("span",r({className:"hh-callout-text"},{children:"Pin left"}))})),null===T&&f&&n("button",r({onClick:f,className:"hh-callout-submenu-item"},{children:n("span",r({className:"hh-callout-text"},{children:"Pin right"}))})),null!==T&&g&&n("button",r({onClick:g,className:"hh-callout-submenu-item"},{children:n("span",r({className:"hh-callout-text"},{children:"Unpin"}))})),_&&m&&e(t,{children:[(h||f||g)&&n("hr",{className:"hh-callout-divider"}),n("button",r({onClick:m,className:"hh-callout-submenu-item"},{children:n("span",r({className:"hh-callout-text"},{children:O?"Hide column":"Show column"}))}))]})]}))]})),U&&b&&e("div",r({className:"hh-callout-item hh-callout-item-with-submenu",onMouseEnter:function(){return Q("totals")},onMouseLeave:Z},{children:[n("span",r({className:"hh-callout-text"},{children:"Totals"})),n("span",r({className:"hh-callout-arrow"},{children:"â€º"})),"totals"===q&&e("div",r({className:"hh-callout-submenu",onMouseEnter:function(){return Q("totals")},onMouseLeave:Z},{children:[e("button",r({onClick:function(){return b("none")},className:"hh-callout-submenu-item ".concat("none"===x?"hh-callout-item-selected":"")},{children:[n("span",r({className:"hh-callout-text"},{children:"None"})),"none"===x&&n("span",r({className:"hh-callout-checkmark"},{children:"âœ“"}))]})),e("button",r({onClick:function(){return b("count")},className:"hh-callout-submenu-item ".concat("count"===x?"hh-callout-item-selected":"")},{children:[n("span",r({className:"hh-callout-text"},{children:"Count"})),"count"===x&&n("span",r({className:"hh-callout-checkmark"},{children:"âœ“"}))]}))]}))]}))]}))})}function x(t){var o=t.column,l=t.columnIndex,i=t.resizedWidth,a=t.pinPosition,c=t.leftOffset,u=t.rightOffset,s=t.lastLeftPinnedColumnKey,g=t.firstRightPinnedColumnKey,m=t.stickyHeader,p=t.enableColumnReorder,v=t.isDragOver,y=t.sortKey,C=t.sortDir,b=t.hasFilter,x=t.anchorRef,k=t.anchorRefForCallout,S=t.calloutKey,R=t.resizingColumn,I=t.onRenderHeader,M=t.onColumnHeaderClick,N=t.onHeaderMouseEnter,E=t.onHeaderMouseLeave,P=t.onCalloutMouseEnter,D=t.onCalloutMouseLeave,K=t.onColumnDragStart,L=t.onColumnDragOver,T=t.onColumnDrop,A=t.onResizeStart,O=t.onSortAsc,F=t.onSortDesc,_=t.onFilter,B=t.onClearFilter,H=t.onPinLeft,z=t.onPinRight,V=t.onUnpin,W=t.onToggleVisibility,U=t.onGroupBy,j=t.isGrouped,G=t.enableColumnVisibility,q=t.groupable,X=t.settingsable,Y=t.totalsable,J=t.onTotalsChange,Q=t.totalsValue,Z=t.onDismiss,$=t.enableCellSelection,ee=void 0!==$&&$,ne=t.isInRangeColumn,te=void 0!==ne&&ne,oe=t.isLeftColInRange,re=void 0!==oe&&oe,le=t.isRightColInRange,ie=void 0!==le&&le,ae=t.isCopied,ce=void 0!==ae&&ae,ue=String(o.key),se=r(r(r(r({},o.style),{width:i?"".concat(i,"px"):o.width,minWidth:o.minWidth,maxWidth:o.maxWidth,textAlign:o.align,position:a?"sticky":"relative"}),"left"===a?{left:"".concat(c,"px"),zIndex:m?15:5}:{}),"right"===a?{right:"".concat(u,"px"),zIndex:m?15:5}:{}),de=o.className?"hh-header-cell ".concat(a?"hh-header-pinned hh-pinned-".concat(a):""," ").concat(o.className):a?"hh-header-cell hh-header-pinned hh-pinned-".concat(a):"hh-header-cell",he=[v?"hh-drag-over":"",a?"hh-pinned-".concat(a):"","left"===a&&o.key===s?"hh-pinned-last-left":"","right"===a&&o.key===g?"hh-pinned-first-right":"",ee&&ce?"hh-cell-copied":""].filter(Boolean).join(" ");return e("th",r({style:se,draggable:p,onDragStart:function(){return K(o.key)},onDragOver:function(e){return L(e,o.key)},onDrop:function(){return T(o.key)},onDragLeave:function(){},className:he,"data-in-range-column":ee&&te?"true":void 0,"data-left-col-in-range":ee&&re?"true":void 0,"data-right-col-in-range":ee&&ie?"true":void 0},{children:[I?I(o,l):e("div",r({className:de,ref:function(e){x(e)},onMouseEnter:function(){return N(ue)},onMouseLeave:E,onClick:function(e){return null==M?void 0:M(o,e)}},{children:[e("span",r({className:"hh-header-label"},{children:[o.label,!1!==o.showCallout&&n("span",r({className:"hh-header-chevron-icon",role:"presentation","aria-hidden":"true"},{children:n(d,{})}))]})),e("div",r({className:"hh-header-icons"},{children:[a&&n("span",r({className:"hh-header-pin-icon",title:"Pinned ".concat(a)},{children:n(h,{width:14,height:14})})),b&&n("span",r({className:"hh-header-filter-icon",title:"Filtered",role:"presentation","aria-hidden":"true"},{children:n(f,{width:14,height:14})})),y===o.key&&n("span",r({className:"hh-header-sort-icon"},{children:n("span",r({className:"hh-sort-arrow"},"asc"===C?{children:"â†‘"}:{children:"â†“"}))}))]})),n("span",r({className:"hh-header-action"},{children:"â‹®"}))]})),!1!==o.resizable&&n("div",{className:"hh-resize-handle",onMouseDown:function(e){return A(ue,e)},style:{cursor:"col-resize",position:"absolute",right:0,top:0,bottom:0,width:"4px",zIndex:10,userSelect:"none"}}),S===ue&&!R&&!1!==o.showCallout&&n(w,{anchorRef:k,onSortAsc:O,onSortDesc:F,onFilter:_,onClearFilter:B,onPinLeft:H,onPinRight:z,onUnpin:V,onToggleVisibility:W,onGroupBy:U,isGrouped:j,onColumnSettings:X?!!V||G:void 0,onTotalsChange:J,totalsValue:Q,columnLabel:o.label,onDismiss:Z,onMouseEnter:P,onMouseLeave:D,sortable:!1!==o.sortable,filterable:!1!==o.filterable,hasFilter:b,pinned:a,visible:!0,enableColumnVisibility:G,groupable:q,settingsable:X,totalsable:Y})]}),ue)}function k(t){var o=t.columns,l=t.selectionMode,i=t.isAllSelected,a=t.isIndeterminate,c=t.onSelectAll,u=t.columnWidths,s=t.pinnedColumns,d=t.lastLeftPinnedColumnKey,h=t.firstRightPinnedColumnKey,f=t.stickyHeader,g=t.enableColumnReorder,m=t.dragOverColumn,p=t.sortKey,v=t.sortDir,y=t.filters,C=t.anchorRefs,w=t.calloutKey,k=t.resizingColumn,S=t.onRenderHeader,R=t.onColumnHeaderClick,I=t.onHeaderMouseEnter,M=t.onHeaderMouseLeave,N=t.onCalloutMouseEnter,E=t.onCalloutMouseLeave,P=t.onColumnDragStart,D=t.onColumnDragOver,K=t.onColumnDrop,L=t.onResizeStart,T=t.onSortAsc,A=t.onSortDesc,O=t.onFilter,F=t.onClearFilter,_=t.onPinLeft,B=t.onPinRight,H=t.onUnpin,z=t.onToggleVisibility,V=t.onGroupBy,W=t.currentGroupBy,U=t.enableColumnVisibility,j=t.onTotalsChange,G=t.columnTotals,q=t.getLeftOffset,X=t.getRightOffset,Y=t.dismissCallout,J=t.enableRowActions,Q=void 0!==J&&J,Z=t.enableCellSelection,$=void 0!==Z&&Z,ee=t.isRangeFromFirstRow,ne=void 0!==ee&&ee;t.isColumnInRange;var te=t.getColumnRangeInfo,oe=t.isCopied,re=void 0!==oe&&oe;return n("thead",{children:e("tr",{children:["none"!==l&&n(b,{selectionMode:l,checked:i,indeterminate:a,onChange:function(){},onSelectAll:c}),Q&&n("th",r({className:"hh-row-actions-column"},{children:n("div",r({className:"hh-header-cell"},{children:n("span",{className:"hh-header-label"})}))})),o.map(function(e,t){var o=String(e.key),r=u[o],l=s[o]||e.pinned||null,i="left"===l?q(e,t):0,a="right"===l?X(e,t):0,c=$&&ne&&te?te(o):{isInRange:!1,isLeftCol:!1,isRightCol:!1},b=$&&ne&&re&&c.isInRange,J={get current(){return C.current[o]||null},set current(e){}};return n(x,{column:e,columnIndex:t,resizedWidth:r,pinPosition:l,leftOffset:i,rightOffset:a,lastLeftPinnedColumnKey:null!=d?d:void 0,firstRightPinnedColumnKey:null!=h?h:void 0,stickyHeader:f,enableColumnReorder:g,isDragOver:m===e.key,sortKey:p,sortDir:v,hasFilter:!!(y[o]&&y[o].length>0),anchorRef:function(e){e&&(C.current[o]=e)},anchorRefForCallout:J,calloutKey:w===e.key?o:null,resizingColumn:k,onRenderHeader:S,onColumnHeaderClick:R,onHeaderMouseEnter:I,onHeaderMouseLeave:M,onCalloutMouseEnter:N,onCalloutMouseLeave:E,onColumnDragStart:P,onColumnDragOver:D,onColumnDrop:K,onResizeStart:L,enableCellSelection:$,isInRangeColumn:c.isInRange,isLeftColInRange:c.isLeftCol,isRightColInRange:c.isRightCol,isCopied:b,onSortAsc:function(){!1!==e.sortable&&(T(e),Y())},onSortDesc:function(){!1!==e.sortable&&(A(e),Y())},onFilter:function(){!1!==e.filterable&&O(e)},onClearFilter:function(){!1!==e.filterable&&(F(e),Y())},onPinLeft:function(){_(e),Y()},onPinRight:function(){B(e),Y()},onUnpin:function(){H(e),Y()},onToggleVisibility:function(){U&&(z(e),Y())},onGroupBy:function(){!1!==e.groupable&&(V(e),Y())},isGrouped:W===e.key,enableColumnVisibility:U,groupable:e.groupable,settingsable:e.settingsable,totalsable:e.totalsable,onTotalsChange:function(n){!1!==e.totalsable&&(j(e,n),Y())},totalsValue:G[o]||"none",onDismiss:Y},o)})]})})}function S(t){var o=t.groupKey,l=t.groupLabel,i=t.rowCount,a=t.isExpanded,c=t.onToggle,u=t.colSpan;return n("tr",r({className:"hh-group-header"},{children:n("td",r({colSpan:u,className:"hh-group-header-cell"},{children:e("button",r({className:"hh-group-toggle",onClick:c,"aria-expanded":a},{children:[n(m,{width:16,height:16,className:a?"expanded":""}),e("span",r({className:"hh-group-label"},{children:[l,": ",o]})),e("span",r({className:"hh-group-count"},{children:["(",i,")"]}))]}))}))}))}var R=o.memo(function(e){var t=e.column,o=e.item,l=e.index,i=e.resizedWidth,a=e.pinPosition,c=e.leftOffset,u=e.rightOffset,s=e.lastLeftPinnedColumnKey,d=e.firstRightPinnedColumnKey,h=e.showTooltip,f=e.onDoubleClick,g=e.renderCell,m=e.getCellText,p=e.isSelected,v=void 0!==p&&p,y=e.isRangeStart,C=void 0!==y&&y,b=e.isRangeEnd,w=void 0!==b&&b,x=e.isInRange,k=void 0!==x&&x,S=e.isTopRow,R=void 0!==S&&S,I=e.isBottomRow,M=void 0!==I&&I,N=e.isLeftCol,E=void 0!==N&&N,P=e.isRightCol,D=void 0!==P&&P,K=e.isInRangeColumn,L=void 0!==K&&K,T=e.isLeftColInRange,A=void 0!==T&&T,O=e.isRightColInRange,F=void 0!==O&&O,_=e.isCopied,B=void 0!==_&&_,H=e.isFocused,z=void 0!==H&&H,V=e.rowIndex,W=e.colKey,U=e.onMouseDown,j=e.onMouseEnter,G=e.onMouseUp,q=e.enableCellSelection,X=void 0!==q&&q,Y=String(t.key),J=r(r(r(r({},t.cellStyle),{textAlign:t.align,width:i?"".concat(i,"px"):t.width,position:a?"sticky":"relative"}),"left"===a?{left:"".concat(c,"px"),zIndex:3}:{}),"right"===a?{right:"".concat(u,"px"),zIndex:3}:{}),Q=[t.cellClassName,t.editable?"hh-cell-editable":"",a?"hh-cell-pinned hh-pinned-".concat(a):"","left"===a&&t.key===s?"hh-pinned-last-left":"","right"===a&&t.key===d?"hh-pinned-first-right":"",X&&v?"hh-cell-selected":"",X&&z?"hh-cell-focused":"",X&&C?"hh-cell-range-start":"",X&&w?"hh-cell-range-end":"",X&&k?"hh-cell-in-range":"",X&&R?"hh-cell-range-top":"",X&&M?"hh-cell-range-bottom":"",X&&E?"hh-cell-range-left":"",X&&D?"hh-cell-range-right":"",X&&B?"hh-cell-copied":"",h?"hh-cell-with-tooltip":"hh-cell-no-tooltip"].filter(Boolean).join(" "),Z=h&&m?m(o,t):void 0;return n("td",r({style:J,className:Q,onDoubleClick:f,title:Z||void 0,onMouseDown:X?U:void 0,onMouseEnter:X?j:void 0,onMouseUp:X?G:void 0,"data-in-range-column":X&&L?"true":void 0,"data-left-col-in-range":X&&A?"true":void 0,"data-right-col-in-range":X&&F?"true":void 0,"data-row-index":X&&void 0!==V?V:void 0,"data-col-key":X&&W?W:void 0},{children:g(o,t,l)}),Y)},function(e,n){return e.item===n.item&&e.index===n.index&&e.column.key===n.column.key&&e.resizedWidth===n.resizedWidth&&e.pinPosition===n.pinPosition&&e.leftOffset===n.leftOffset&&e.rightOffset===n.rightOffset&&e.showTooltip===n.showTooltip&&e.isSelected===n.isSelected&&e.isFocused===n.isFocused&&e.isRangeStart===n.isRangeStart&&e.isRangeEnd===n.isRangeEnd&&e.isInRange===n.isInRange&&e.isTopRow===n.isTopRow&&e.isBottomRow===n.isBottomRow&&e.isLeftCol===n.isLeftCol&&e.isRightCol===n.isRightCol&&e.isInRangeColumn===n.isInRangeColumn&&e.isLeftColInRange===n.isLeftColInRange&&e.isRightColInRange===n.isRightColInRange&&e.isCopied===n.isCopied&&e.enableCellSelection===n.enableCellSelection&&e.renderCell===n.renderCell});function I(e){var t=e.item,o=e.index,l=e.actions,i=e.onMenuToggle,a=e.isMenuOpen,c=e.buttonRef;return l&&0!==l.length?n("td",r({className:"hh-row-actions-column"},{children:n("button",r({ref:c,type:"button",className:"hh-row-actions-button ".concat(a?"hh-row-actions-button-active":""),onClick:function(e){e.preventDefault(),e.stopPropagation(),i(t,o)},onContextMenu:function(e){e.preventDefault(),e.stopPropagation()},"aria-label":"Row actions","aria-haspopup":"true","aria-expanded":a},{children:n(g,{width:16,height:16,style:{display:"block"}})}))})):n("td",{className:"hh-row-actions-column"})}function M(t){var l=t.anchorRef,i=t.actions,a=t.item,c=t.index,u=t.onDismiss,s=t.onMouseEnter,d=t.onMouseLeave,h=o.useRef(null);if(o.useEffect(function(){var e=function(e){h.current&&!h.current.contains(e.target)&&l.current&&!l.current.contains(e.target)&&u()},n=function(e){"Escape"===e.key&&u()};return document.addEventListener("mousedown",e),document.addEventListener("keydown",n),function(){document.removeEventListener("mousedown",e),document.removeEventListener("keydown",n)}},[u,l]),!l.current||0===i.length)return null;var f=l.current.getBoundingClientRect(),g=32*i.length+8,m=window.innerHeight-f.bottom,p=f.top,v=m<g&&p>m?f.top-g-4:f.bottom+4;return n("div",r({ref:h,className:"hh-row-actions-menu",style:{position:"fixed",top:"".concat(v,"px"),left:"".concat(f.left,"px"),zIndex:1e3},onMouseEnter:s,onMouseLeave:d},{children:i.map(function(t){return e("button",r({className:"hh-row-actions-menu-item ".concat(t.disabled?"hh-row-actions-menu-item-disabled":""),onClick:function(){return function(e){e.disabled||(e.onClick(a,c),u())}(t)},disabled:t.disabled},{children:[t.icon&&n("span",r({className:"hh-row-actions-menu-icon"},{children:t.icon})),n("span",r({className:"hh-row-actions-menu-text"},{children:t.label}))]}),t.key)})}))}function N(l){var i=l.item,a=l.index,c=l.itemKey,u=l.columns,s=l.selectionMode,d=l.isSelected,h=l.isActive,f=l.isFocused,g=void 0!==f&&f,m=l.isDragging,p=void 0!==m&&m,v=l.isDragOver,y=void 0!==v&&v,C=l.canDrag,w=l.columnWidths,x=l.pinnedColumns,k=l.lastLeftPinnedColumnKey,S=l.firstRightPinnedColumnKey,N=l.showTooltip,E=l.onItemClick,P=l.onItemContextMenu,D=l.onCheckboxChange,K=l.onCellEditStart,L=l.onDragStart,T=l.onDragOver,A=l.onDragLeave,O=l.onDrop,F=l.onDragEnd,_=l.dragIndex,B=l.renderCell,H=l.getCellText,z=l.getLeftOffset,V=l.getRightOffset,W=l.isDraggingState,U=l.rowActions,j=l.openMenuKey,G=l.onMenuToggle,q=l.onMenuDismiss,X=l.enableCellSelection,Y=void 0!==X&&X,J=l.cellSelectionIndex,Q=l.isCellSelected,Z=l.getCellRangeInfo,$=l.isRowAboveRange,ee=void 0!==$&&$;l.isColumnInRange;var ne=l.getColumnRangeInfo,te=l.onCellMouseDown,oe=l.onCellMouseEnter,re=l.onCellMouseUp,le=o.useMemo(function(){return[d?"hh-row-selected":"",!Y&&h?"hh-row-active":"",!Y&&g?"hh-row-focused":"",C?"hh-row-draggable":"",p?"hh-row-dragging":"",y?"hh-row-drag-over":"",Y&&ee?"hh-row-above-range":""].filter(Boolean).join(" ")},[d,Y,h,g,C,p,y,ee]),ie=U?U(i,a):[],ae=j===o.useMemo(function(){return"".concat(String(c),"-").concat(a)},[c,a]),ce=o.useRef(null);return e(t,{children:[e("tr",r({className:le,draggable:C,onDragStart:function(e){return L(e,void 0!==_?_:a)},onDragOver:function(e){return T(e,void 0!==_?_:a)},onDragLeave:A,onDrop:function(e){return O(e,void 0!==_?_:a)},onDragEnd:F,onClick:function(e){W||Y||E(i,a,e)},onContextMenu:function(e){return null==P?void 0:P(i,a,e)}},{children:["none"!==s&&n(b,{selectionMode:s,checked:d,onChange:function(e){return D(i,a,e)}}),ie.length>0&&n(I,{item:i,index:a,actions:ie,onMenuToggle:G,isMenuOpen:ae,buttonRef:ce}),u.map(function(e,t){var o=String(e.key),r=w[o],l=x[o]||e.pinned||null,c=u.findIndex(function(e){return String(e.key)===o}),s="left"===l?z(e,c):0,d="right"===l?V(e,c):0,h=void 0!==J?J:a,f=!(!Y||!Q)&&Q(h,o),g=Y&&Z?Z(h,o):{isStart:!1,isEnd:!1,isInRange:!1,isTopRow:!1,isBottomRow:!1,isLeftCol:!1,isRightCol:!1,isCopied:!1,isFocused:!1},m=null!=g.isCopied&&g.isCopied,p=null!=g.isFocused&&g.isFocused,v=Y&&ee&&ne?ne(o):{isInRange:!1,isLeftCol:!1,isRightCol:!1},y=v.isInRange;return n(R,{column:e,item:i,index:a,resizedWidth:r,pinPosition:l,leftOffset:s,rightOffset:d,lastLeftPinnedColumnKey:k,firstRightPinnedColumnKey:S,showTooltip:N,onDoubleClick:function(){return K(i,e,a)},renderCell:B,getCellText:H,enableCellSelection:Y,isSelected:f,isFocused:p,isRangeStart:g.isStart,isRangeEnd:g.isEnd,isInRange:g.isInRange,isTopRow:g.isTopRow,isBottomRow:g.isBottomRow,isLeftCol:g.isLeftCol,isRightCol:g.isRightCol,isInRangeColumn:y,isLeftColInRange:v.isLeftCol,isRightColInRange:v.isRightCol,isCopied:m,rowIndex:h,colKey:o,onMouseDown:Y&&te?function(e){return te(h,o,e)}:void 0,onMouseEnter:Y&&oe?function(e){return oe(h,o,e)}:void 0,onMouseUp:Y&&re?function(e){return re(h,o,e)}:void 0},o)})]}),c),ae&&ie.length>0&&n(M,{anchorRef:ce,actions:ie,item:i,index:a,onDismiss:q})]})}function E(t){var r=t.data,i=t.columns,a=t.paginatedGroups,c=t.currentGroupBy,u=t.expandedGroups,s=t.selectionMode,d=t.selectedItems,h=t.activeItemIndex,f=t.focusedRowIndex,g=t.enableRowReorder,m=t.draggedRowIndex,p=t.dragOverRowIndex,v=t.isDragging,y=t.columnWidths,C=t.pinnedColumns,b=t.lastLeftPinnedColumnKey,w=t.firstRightPinnedColumnKey,x=t.showTooltip,k=t.onRenderRow,R=t.getItemKey,I=t.onItemClick,M=t.onItemContextMenu,E=t.onCheckboxChange,P=t.onCellEditStart,D=t.onRowDragStart,K=t.onRowDragOver,L=t.onRowDragLeave,T=t.onRowDrop,A=t.onRowDragEnd,O=t.renderCell,F=t.getCellText,_=t.getLeftOffset,B=t.getRightOffset,H=t.toggleGroup,z=t.filteredData,V=t.pagedData,W=t.rowActions,U=t.openMenuKey,j=t.onMenuToggle,G=t.onMenuDismiss,q=t.enableCellSelection,X=void 0!==q&&q,Y=t.isCellSelected,J=t.getCellRangeInfo,Q=t.isRowAboveRange,Z=t.isColumnInRange,$=t.getColumnRangeInfo,ee=t.onCellMouseDown,ne=t.onCellMouseEnter,te=t.onCellMouseUp,oe=c?i.find(function(e){return e.key===c}):null,re=(null==oe?void 0:oe.label)||(c?String(c):"");return n("tbody",{children:c&&a?a.map(function(t){var a=l(t,2),f=a[0],q=a[1],oe=u.has(f);return e(o.Fragment,{children:[n(S,{groupKey:f,groupLabel:re,rowCount:q.length,isExpanded:oe,onToggle:function(){return H(f)},colSpan:i.length+("none"!==s?1:0)+(W?1:0)}),oe&&q.map(function(e,t){var l=r.findIndex(function(n){return n===e}),a=l>=0?l:z.findIndex(function(n){return n===e}),u=l>=0?l:a>=0?a:t,f=V.findIndex(function(n){return n===e}),S=f>=0?f:t,H=R(e,u),q=d.has(H),oe=l>=0&&h===l,re=z.findIndex(function(n){return n===e}),le=re>=0?re:u,ie=g&&!c;return k?n(o.Fragment,{children:k(e,u,i)},H):n(N,{item:e,index:u,itemKey:H,columns:i,selectionMode:s,isSelected:q,isActive:oe,isFocused:!1,isDragging:m===le,isDragOver:p===le,canDrag:ie,columnWidths:y,pinnedColumns:C,lastLeftPinnedColumnKey:b,firstRightPinnedColumnKey:w,showTooltip:x,onItemClick:I,onItemContextMenu:M,onCheckboxChange:E,onCellEditStart:P,onDragStart:D,onDragOver:K,onDragLeave:L,onDrop:T,onDragEnd:A,dragIndex:le,renderCell:O,getCellText:F,getLeftOffset:_,getRightOffset:B,isDraggingState:v,rowActions:W,openMenuKey:U,onMenuToggle:j,onMenuDismiss:G,enableCellSelection:X,cellSelectionIndex:S,isCellSelected:Y,getCellRangeInfo:J,isRowAboveRange:!!Q&&Q(S),isColumnInRange:Z,getColumnRangeInfo:$,onCellMouseDown:ee,onCellMouseEnter:ne,onCellMouseUp:te},H)})]},f)}):V.map(function(e,t){var r=R(e,t),l=d.has(r),a=h===t,u=e===z[t]?t:z.findIndex(function(n){return n===e}),S=u>=0?u:t,H=g&&!c;return k?n(o.Fragment,{children:k(e,t,i)},r):n(N,{item:e,index:t,itemKey:r,columns:i,selectionMode:s,isSelected:l,isActive:a,isFocused:f===t,isDragging:m===S,isDragOver:p===S,canDrag:H,columnWidths:y,pinnedColumns:C,lastLeftPinnedColumnKey:b,firstRightPinnedColumnKey:w,showTooltip:x,onItemClick:I,onItemContextMenu:M,onCheckboxChange:E,onCellEditStart:P,onDragStart:D,onDragOver:K,onDragLeave:L,onDrop:T,onDragEnd:A,dragIndex:S,renderCell:O,getCellText:F,getLeftOffset:_,getRightOffset:B,isDraggingState:v,rowActions:W,openMenuKey:U,onMenuToggle:j,onMenuDismiss:G,enableCellSelection:X,cellSelectionIndex:t,isCellSelected:Y,getCellRangeInfo:J,isRowAboveRange:!!Q&&Q(t),isColumnInRange:Z,getColumnRangeInfo:$,onCellMouseDown:ee,onCellMouseEnter:ne,onCellMouseUp:te},r)})})}function P(t){var o=t.columns,l=t.selectionMode,i=t.columnTotals,a=t.pinnedColumns,c=t.columnWidths,u=t.lastLeftPinnedColumnKey,s=t.firstRightPinnedColumnKey,d=t.totalCount,h=t.getLeftOffset,f=t.getRightOffset;return Object.values(i).some(function(e){return"count"===e})?n("tfoot",r({className:"hh-totals-sticky"},{children:e("tr",r({className:"hh-totals-row"},{children:["none"!==l&&n("td",{className:"hh-selection-column"}),o.map(function(e){var t=String(e.key),l=i[t]||"none",g=a[t]||e.pinned||null,m=o.findIndex(function(e){return String(e.key)===t}),p="left"===g?h(e,m):0,v="right"===g?f(e,m):0,y=c[t],C=r(r({textAlign:e.align,width:y?"".concat(y,"px"):e.width,position:g?"sticky":"relative"},"left"===g?{left:"".concat(p,"px"),zIndex:11}:{}),"right"===g?{right:"".concat(v,"px"),zIndex:11}:{}),b=[g?"hh-cell-pinned hh-pinned-".concat(g):"","left"===g&&e.key===u?"hh-pinned-last-left":"","right"===g&&e.key===s?"hh-pinned-first-right":""].filter(Boolean).join(" "),w="";return"count"===l&&(w="Count: ".concat(d.toLocaleString())),n("td",r({style:C,className:b},{children:w}),t)})]}))})):null}function D(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function K(e,n,t,o){void 0===o&&(o="export"),"csv"===e?function(e,n,t){void 0===t&&(t="export");var o=i([n.map(function(e){return e.label}).join(",")],l(e.map(function(e){return n.map(function(n){var t=e[n.key];if(null==t)return"";var o=String(t);return o.includes(",")||o.includes('"')||o.includes("\n")?'"'.concat(o.replace(/"/g,'""'),'"'):o}).join(",")})),!1).join("\n"),r=new Blob(["\ufeff"+o],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),c=URL.createObjectURL(r);a.setAttribute("href",c),a.setAttribute("download","".concat(t,".csv")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(c)}(n,t,o):function(e,n,t){void 0===t&&(t="export");var o=n.map(function(e){return e.label}),r=e.map(function(e){return n.map(function(n){var t=e[n.key];return null==t?"":t})}),l='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n';l+="<head>\n",l+='<meta charset="utf-8">\n',l+="\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Sheet1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e\n",l+="</head>\n",l+="<body>\n",l+="<table>\n",l+="<tr>\n",o.forEach(function(e){l+="<th>".concat(D(String(e)),"</th>\n")}),l+="</tr>\n",r.forEach(function(e){l+="<tr>\n",e.forEach(function(e){var n=null==e?"":String(e);l+="number"==typeof e?'<td style="mso-number-format:General">'.concat(n,"</td>\n"):"<td>".concat(D(n),"</td>\n")}),l+="</tr>\n"}),l+="</table>\n",l+="</body>\n",l+="</html>";var i=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=document.createElement("a"),c=URL.createObjectURL(i);a.setAttribute("href",c),a.setAttribute("download","".concat(t,".xlsx")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(c)}(n,t,o)}function L(t){var i=t.data,a=t.columns,c=t.format,u=t.filename,s=t.onBeforeExport,d=t.onAfterExport,h=l(o.useState(!1),2),f=h[0],g=h[1],m=o.useCallback(function(e){g(!0);try{var n=a.filter(function(e){return e.key&&e.label}).map(function(e){return{key:e.key,label:e.label}}),t=i;if(s){var o=s(i,a);o?K(e,t=o.data,o.columns.filter(function(e){return e.key&&e.label}).map(function(e){return{key:e.key,label:e.label}}),u):K(e,t,n,u)}else K(e,t,n,u);null==d||d(e,u)}catch(e){console.error("Export failed:",e)}finally{g(!1)}},[i,a,u,s,d]);return"both"===c?e("div",r({className:"hh-export-buttons"},{children:[e("button",r({className:"hh-export-button",onClick:function(){return m("csv")},disabled:f,title:"Export to CSV"},{children:[n(p,{width:16,height:16}),n("span",{children:"CSV"})]})),e("button",r({className:"hh-export-button",onClick:function(){return m("excel")},disabled:f,title:"Export to Excel"},{children:[n(p,{width:16,height:16}),n("span",{children:"Excel"})]}))]})):e("button",r({className:"hh-export-button",onClick:function(){return m(c)},disabled:f,title:"Export to ".concat("csv"===c?"CSV":"Excel")},{children:[n(p,{width:16,height:16}),n("span",{children:"csv"===c?"CSV":"Excel"})]}))}var T={mode:"light",colors:{background:"#ffffff",surface:"#ffffff",headerBackground:"#faf9f8",rowBackground:"#ffffff",rowBackgroundAlternate:"#f9f9f9",selectedRowBackground:"#edebe9",hoverRowBackground:"#f3f2f1",groupHeaderBackground:"#f3f2f1",text:"#323130",textSecondary:"#605e5c",headerText:"#323130",rowText:"#323130",selectedRowText:"#323130",border:"#edebe9",borderLight:"#f1f1f1",rowBorder:"#f1f1f1",focus:"#107c10",focusBorder:"#107c10",hover:"#f3f2f1",active:"#edebe9",disabled:"#a19f9d",primary:"#107c10",success:"#107c10",warning:"#ffaa44",error:"#d13438"},spacing:{cellPadding:"10px 12px",headerPadding:"10px 12px",rowHeight:"auto",rowHeightCompact:"32px",rowHeightSpacious:"56px",gap:"8px"},typography:{fontFamily:'"Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif',fontSize:"14px",fontSizeSmall:"12px",fontSizeLarge:"16px",fontWeight:"400",fontWeightBold:"600",lineHeight:"20px"},borderRadius:{table:"8px",cell:"0",button:"2px"},shadows:{table:"0 2px 8px rgba(0,0,0,0.08)",header:"none",callout:"0 3.2px 7.2px rgba(0, 0, 0, 0.132), 0 0.6px 1.8px rgba(0, 0, 0, 0.108)",panel:"-2px 0 8px rgba(0, 0, 0, 0.15), -1px 0 2px rgba(0, 0, 0, 0.1)"},transitions:{duration:"0.1s",easing:"cubic-bezier(0.1, 0.9, 0.2, 1)"}},A={mode:"dark",colors:{background:"#1a1a1a",surface:"#252526",headerBackground:"#2d2d30",rowBackground:"#252526",rowBackgroundAlternate:"#2d2d30",selectedRowBackground:"#3e3e42",hoverRowBackground:"#2d2d30",groupHeaderBackground:"#2d2d30",text:"#cccccc",textSecondary:"#858585",headerText:"#cccccc",rowText:"#cccccc",selectedRowText:"#ffffff",border:"#3e3e42",borderLight:"#2d2d30",rowBorder:"#3e3e42",focus:"#4ec9b0",focusBorder:"#4ec9b0",hover:"#2d2d30",active:"#3e3e42",disabled:"#858585",primary:"#4ec9b0",success:"#4ec9b0",warning:"#dcdcaa",error:"#f48771"},spacing:{cellPadding:"10px 12px",headerPadding:"10px 12px",rowHeight:"auto",rowHeightCompact:"32px",rowHeightSpacious:"56px",gap:"8px"},typography:{fontFamily:'"Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif',fontSize:"14px",fontSizeSmall:"12px",fontSizeLarge:"16px",fontWeight:"400",fontWeightBold:"600",lineHeight:"20px"},borderRadius:{table:"8px",cell:"0",button:"2px"},shadows:{table:"0 2px 8px rgba(0,0,0,0.3)",header:"none",callout:"0 3.2px 7.2px rgba(0, 0, 0, 0.4), 0 0.6px 1.8px rgba(0, 0, 0, 0.3)",panel:"-2px 0 8px rgba(0, 0, 0, 0.4), -1px 0 2px rgba(0, 0, 0, 0.3)"},transitions:{duration:"0.1s",easing:"cubic-bezier(0.1, 0.9, 0.2, 1)"}};function O(e){if(!e)return T;if("string"==typeof e)return"dark"===e?A:T;var n="dark"===e.mode?A:T;return r(r(r({},n),e),{colors:r(r({},n.colors),e.colors),spacing:e.spacing?r(r({},n.spacing),e.spacing):n.spacing,typography:e.typography?r(r({},n.typography),e.typography):n.typography,borderRadius:e.borderRadius?r(r({},n.borderRadius),e.borderRadius):n.borderRadius,shadows:e.shadows?r(r({},n.shadows),e.shadows):n.shadows,transitions:e.transitions?r(r({},n.transitions),e.transitions):n.transitions})}function F(e){var n=e.colors,t=e.spacing,o=e.typography,r=e.borderRadius,l=e.shadows,i=e.transitions;return{"--hh-color-background":n.background,"--hh-color-surface":n.surface,"--hh-color-header-background":n.headerBackground,"--hh-color-row-background":n.rowBackground,"--hh-color-row-background-alternate":n.rowBackgroundAlternate,"--hh-color-selected-row-background":n.selectedRowBackground,"--hh-color-hover-row-background":n.hoverRowBackground,"--hh-color-group-header-background":n.groupHeaderBackground,"--hh-color-text":n.text,"--hh-color-text-secondary":n.textSecondary,"--hh-color-header-text":n.headerText,"--hh-color-row-text":n.rowText,"--hh-color-selected-row-text":n.selectedRowText,"--hh-color-border":n.border,"--hh-color-border-light":n.borderLight,"--hh-color-row-border":n.rowBorder,"--hh-color-focus":n.focus,"--hh-color-focus-border":n.focusBorder,"--hh-color-hover":n.hover,"--hh-color-active":n.active,"--hh-color-disabled":n.disabled,"--hh-color-primary":n.primary,"--hh-color-success":n.success,"--hh-color-warning":n.warning,"--hh-color-error":n.error,"--hh-spacing-cell-padding":null==t?void 0:t.cellPadding,"--hh-spacing-header-padding":null==t?void 0:t.headerPadding,"--hh-spacing-row-height":null==t?void 0:t.rowHeight,"--hh-spacing-row-height-compact":null==t?void 0:t.rowHeightCompact,"--hh-spacing-row-height-spacious":null==t?void 0:t.rowHeightSpacious,"--hh-spacing-gap":null==t?void 0:t.gap,"--hh-typography-font-family":null==o?void 0:o.fontFamily,"--hh-typography-font-size":null==o?void 0:o.fontSize,"--hh-typography-font-size-small":null==o?void 0:o.fontSizeSmall,"--hh-typography-font-size-large":null==o?void 0:o.fontSizeLarge,"--hh-typography-font-weight":null==o?void 0:o.fontWeight,"--hh-typography-font-weight-bold":null==o?void 0:o.fontWeightBold,"--hh-typography-line-height":null==o?void 0:o.lineHeight,"--hh-border-radius-table":null==r?void 0:r.table,"--hh-border-radius-cell":null==r?void 0:r.cell,"--hh-border-radius-button":null==r?void 0:r.button,"--hh-shadow-table":null==l?void 0:l.table,"--hh-shadow-header":null==l?void 0:l.header,"--hh-shadow-callout":null==l?void 0:l.callout,"--hh-shadow-panel":null==l?void 0:l.panel,"--hh-transition-duration":null==i?void 0:i.duration,"--hh-transition-easing":null==i?void 0:i.easing}}function _(t){var d=t.columns,h=t.data,f=t.itemsPerPage,g=void 0===f?10:f,m=t.groupBy,p=t.onRenderCell,b=t.onRenderRow,w=t.onRenderHeader;t.onItemInvoked;var x=t.onColumnHeaderClick,S=t.getKey,R=t.onActiveItemChanged,I=t.onItemContextMenu,M=t.className,N=t.styles,D=t.selectionMode,K=void 0===D?"none":D,T=t.onSelectionChanged,A=t.showPagination,_=void 0===A||A,B=t.itemsPerPageOptions,H=t.onItemsPerPageChange,z=t.theme,V=t.maxHeight,W=t.onCellEdit,U=t.pinnedColumns,j=t.onColumnPin,G=t.showTooltip,q=void 0===G||G,X=t.loading,Y=void 0!==X&&X,J=t.onRenderLoading,Q=t.emptyMessage,Z=t.onRenderEmpty,$=t.stickyHeader,ee=void 0!==$&&$,ne=t.enableColumnVisibility,te=t.onColumnVisibilityChange,oe=t.enableColumnReorder,re=t.onColumnReorder,le=t.enableKeyboardNavigation,ie=void 0===le||le,ae=t.enableRowReorder,ce=void 0!==ae&&ae,ue=t.onRowReorder,se=t.enableExport,de=void 0!==se&&se,he=t.exportFormat,fe=void 0===he?"both":he,ge=t.exportFileName,me=void 0===ge?"export":ge,pe=t.onBeforeExport,ve=t.onAfterExport,ye=t.rowActions,Ce=t.enableCellSelection,be=void 0!==Ce&&Ce;!function(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(t[o[r]]=e[o[r]])}}(t,["columns","data","itemsPerPage","groupBy","onRenderCell","onRenderRow","onRenderHeader","onItemInvoked","onColumnHeaderClick","getKey","onActiveItemChanged","onItemContextMenu","className","styles","selectionMode","onSelectionChanged","showPagination","itemsPerPageOptions","onItemsPerPageChange","theme","maxHeight","onCellEdit","pinnedColumns","onColumnPin","showTooltip","loading","onRenderLoading","emptyMessage","onRenderEmpty","stickyHeader","enableColumnVisibility","onColumnVisibilityChange","enableColumnReorder","onColumnReorder","enableKeyboardNavigation","enableRowReorder","onRowReorder","enableExport","exportFormat","exportFileName","onBeforeExport","onAfterExport","rowActions","enableCellSelection"]);var we=l(o.useState(g),2),xe=we[0],ke=we[1],Se=l(o.useState(h),2),Re=Se[0],Ie=Se[1];o.useEffect(function(){Ie(h)},[h]),o.useEffect(function(){ke(g)},[g]);var Me=_?B||[10,25,50,100]:B,Ne=o.useCallback(function(e){ke(e),H&&H(e)},[H]),Ee=_?xe:Number.MAX_SAFE_INTEGER,Pe=Re,De=a(Pe,Ee),Ke=o.useRef({}),Le=o.useRef(null),Te=l(o.useState({}),2),Ae=Te[0],Oe=Te[1],Fe=l(o.useState(null),2),_e=Fe[0],Be=Fe[1],He=l(o.useState(null),2),ze=He[0],Ve=He[1],We=l(o.useState(m),2),Ue=We[0],je=We[1];o.useEffect(function(){void 0!==m&&je(m)},[m]);var Ge=void 0!==m?m:Ue,qe=l(o.useState(new Set),2),Xe=qe[0],Ye=qe[1],Je=o.useMemo(function(){return{key:"__rowNumber__",label:"STT",width:"80px",align:"center",sortable:!1,filterable:!1,resizable:!1,editable:!1,pinned:"left",showCallout:!1,onRenderCell:function(e,n,t){return(De.currentPage-1)*De.itemsPerPage+t+1}}},[De.currentPage,De.itemsPerPage]),Qe=function(e,n,t,a,c,u,s){var d=l(o.useState(n||{}),2),h=d[0],f=d[1],g=l(o.useState(new Set(e.map(function(e){return e.key}))),2),m=g[0],p=g[1],v=l(o.useState(e.map(function(e){return e.key})),2),y=v[0],C=v[1],b=l(o.useState(null),2),w=b[0],x=b[1],k=l(o.useState(null),2),S=k[0],R=k[1];o.useEffect(function(){t&&a&&a(Array.from(m))},[m,t,a]),o.useEffect(function(){c&&u&&u(y)},[y,c,u]);var I=o.useCallback(function(e){p(function(n){var t=new Set(n);return t.has(e)?t.delete(e):t.add(e),t})},[]),M=o.useCallback(function(e,n){f(function(t){var o=r({},t);return null===n?delete o[String(e)]:o[String(e)]=n,o}),s&&s(e,n)},[s]),N=o.useCallback(function(e){c&&x(e)},[c]),E=o.useCallback(function(e,n){c&&w&&w!==n&&(e.preventDefault(),R(n))},[c,w]),P=o.useCallback(function(e){c&&w&&w!==e&&(C(function(n){var t=i([],l(n),!1),o=t.indexOf(w),r=t.indexOf(e);return t.splice(o,1),t.splice(r,0,w),t}),x(null),R(null))},[c,w]),D=o.useMemo(function(){return t?e.filter(function(e){return m.has(e.key)}):e},[e,m,t]),K=o.useMemo(function(){if(!c)return D;var e=new Map(y.map(function(e,n){return[e,n]}));return i([],l(D),!1).sort(function(n,t){var o,r;return(null!==(o=e.get(n.key))&&void 0!==o?o:1/0)-(null!==(r=e.get(t.key))&&void 0!==r?r:1/0)})},[D,y,c]),L=o.useMemo(function(){var e=[],n=[],t=[];return K.forEach(function(o){var r=h[String(o.key)]||o.pinned||null;"left"===r?e.push(o):"right"===r?t.push(o):n.push(o)}),i(i(i([],l(e),!1),l(n),!1),l(t),!1)},[K,h]);return{internalPinnedColumns:h,visibleColumns:m,columnOrder:y,draggedColumn:w,dragOverColumn:S,sortedColumns:L,handleToggleColumnVisibility:I,handleColumnPin:M,handleColumnDragStart:N,handleColumnDragOver:E,handleColumnDrop:P}}(o.useMemo(function(){return be&&!d.some(function(e){return"__rowNumber__"===String(e.key)})?i([Je],l(d),!1):d},[be,d,Je]),U,ne,te,oe,re,j),Ze=Qe.internalPinnedColumns,$e=Qe.dragOverColumn,en=Qe.sortedColumns,nn=Qe.handleToggleColumnVisibility,tn=Qe.handleColumnPin,on=Qe.handleColumnDragStart,rn=Qe.handleColumnDragOver,ln=Qe.handleColumnDrop,an=function(e,n,t,r,a){var c=l(o.useState(new Set),2),u=c[0],s=c[1],d=l(o.useState(void 0),2),h=d[0],f=d[1],g=o.useCallback(function(e,n){return a?a(e,n):void 0!==e.id?e.id:n},[a]),m=o.useCallback(function(o,l,i){var a=g(o,l);s(function(o){var r=new Set(o);if("single"===n?(r.clear(),i&&r.add(a)):"multiple"===n&&(i?r.add(a):r.delete(a)),t){var l=e.filter(function(e,n){return r.has(g(e,n))});t(l)}return r}),f(l),r&&r(o,l)},[n,g,t,r,e]),p=o.useCallback(function(o,l,i){if(!i.target.closest(".hh-selection-checkbox")){if("none"!==n){var a=g(o,l);s(function(o){var r=new Set(o);if("single"===n?(r.clear(),r.add(a)):"multiple"===n&&(i.ctrlKey||i.metaKey?r.has(a)?r.delete(a):r.add(a):(r.clear(),r.add(a))),t){var l=e.filter(function(e,n){return r.has(g(e,n))});t(l)}return r})}f(l),r&&r(o,l)}},[n,g,t,r,e]),v=o.useCallback(function(o){"multiple"===n&&s(function(n){var r=o?new Set(e.map(function(e,n){return g(e,n)})):new Set;if(t){var a=o?i([],l(e),!1):[];t(a)}return r})},[n,e,g,t]),y=o.useMemo(function(){return"multiple"===n&&0!==e.length&&e.every(function(e,n){return u.has(g(e,n))})},[n,e,u,g]),C=o.useMemo(function(){if("multiple"!==n||0===e.length)return!1;var t=e.filter(function(e,n){return u.has(g(e,n))}).length;return t>0&&t<e.length},[n,e,u,g]),b=o.useCallback(function(e,n){return u.has(g(e,n))},[u,g]);return{selectedItems:u,activeItemIndex:h,isAllSelected:y,isIndeterminate:C,getItemKey:g,handleCheckboxChange:m,handleItemClick:p,handleSelectAll:v,isItemSelected:b,setSelectedItems:s}}(Pe,K,T,R,S),cn=an.selectedItems,un=an.activeItemIndex,sn=an.isAllSelected,dn=an.isIndeterminate,hn=an.getItemKey,fn=an.handleCheckboxChange,gn=an.handleItemClick,mn=an.handleSelectAll,pn=an.setSelectedItems,vn=o.useCallback(function(e,n){var t=hn(e,n),o="".concat(String(t),"-").concat(n);Ve(function(e){return e===o?null:o})},[hn]),yn=o.useCallback(function(){Ve(null)},[]),Cn=function(e){var n=l(o.useState({}),2),t=n[0],i=n[1],a=l(o.useState(null),2),c=a[0],u=a[1],s=l(o.useState(0),2);s[0];var d=s[1],h=l(o.useState(0),2);h[0];var f=h[1],g=o.useCallback(function(n,t){t.preventDefault(),t.stopPropagation();var o=String(n),l=e.current&&e.current[o],a=l&&l.parentElement;if(a){var c=a.offsetWidth,s=t.clientX;u(o),document.body.style.cursor="col-resize",document.body.style.userSelect="none",d(s),f(c);var h=function(e){var n=e.clientX-s,t=Math.max(50,c+n);i(function(e){var n;return r(r({},e),((n={})[o]=t,n))})},g=function(){document.body.style.cursor="",document.body.style.userSelect="",u(null),document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",g)};document.addEventListener("mousemove",h),document.addEventListener("mouseup",g)}},[e,void 0]);return{columnWidths:t,resizingColumn:c,handleResizeStart:g}}(Ke),bn=Cn.columnWidths,wn=Cn.resizingColumn,xn=Cn.handleResizeStart,kn=function(e){var n=l(o.useState(null),2),t=n[0],r=n[1],i=o.useRef(null),a=o.useCallback(function(n){e||(i.current&&clearTimeout(i.current),i.current=setTimeout(function(){r(n)},150))},[e]),c=o.useCallback(function(){i.current&&clearTimeout(i.current),i.current=setTimeout(function(){r(null)},200)},[]),u=o.useCallback(function(){i.current&&clearTimeout(i.current)},[]),s=o.useCallback(function(){i.current&&clearTimeout(i.current),i.current=setTimeout(function(){r(null)},200)},[]),d=o.useCallback(function(){i.current&&clearTimeout(i.current),r(null)},[]);return o.useEffect(function(){return function(){i.current&&clearTimeout(i.current)}},[]),{calloutKey:t,setCalloutKey:r,handleHeaderMouseEnter:a,handleHeaderMouseLeave:c,handleCalloutMouseEnter:u,handleCalloutMouseLeave:s,dismissCallout:d}}(wn),Sn=o.useCallback(function(e,n,t){var o=d.find(function(e){return e.key===t});return o&&o.validate&&o.validate(e,n,t)||null},[d]),Rn=o.useCallback(function(e,n,t,o){var a=Sn(t,e,n);a?console.warn("Validation failed for column ".concat(String(n),": ").concat(a)):(Ie(function(a){var c,u=i([],l(a),!1),s=u.findIndex(function(n){return n===e}),d=s>=0?s:o;return d>=0&&d<u.length&&(u[d]=r(r({},u[d]),((c={})[n]=t,c))),u}),W&&W(e,n,t,o))},[Re,Sn,W]),In=function(e,n){var t=l(o.useState(null),2),r=t[0],i=t[1],a=l(o.useState(""),2),c=a[0],u=a[1],s=l(o.useState(null),2),d=s[0],h=s[1],f=l(o.useState(null),2),g=f[0],m=f[1],p=o.useRef(null),v=o.useCallback(function(e,n,t){!0===n.editable&&(i({rowIndex:t,columnKey:n.key}),u(String(null!=e[n.key]?e[n.key]:"")),m(e),h(null))},[]),y=o.useCallback(function(t,o,r){var l=null==n?void 0:n.find(function(e){return e.key===o});if(null==l?void 0:l.validate){var a=l.validate(c,t,o);if(a)return h(a),!1}return h(null),e&&e(t,o,c,r),i(null),u(""),m(null),!0},[e,c,n]),C=o.useCallback(function(){i(null),u(""),h(null),m(null)},[]);o.useEffect(function(){r&&p.current&&setTimeout(function(){if(p.current){p.current.focus();var e=p.current.value.length;p.current.setSelectionRange(e,e)}},0)},[r]);var b=o.useRef(null);return o.useEffect(function(){return r&&g&&(b.current&&clearTimeout(b.current),b.current=setTimeout(function(){var e=null==n?void 0:n.find(function(e){return e.key===r.columnKey});if(null==e?void 0:e.validate){var t=e.validate(c,g,r.columnKey);h(t||null)}else h(null)},150)),function(){b.current&&clearTimeout(b.current)}},[c,r,g,n]),{editingCell:r,editValue:c,editInputRef:p,setEditValue:u,validationError:d,handleCellEditStart:v,handleCellEditSave:y,handleCellEditCancel:C}}(Rn,d),Mn=In.editingCell,Nn=In.editValue,En=In.editInputRef,Pn=In.setEditValue,Dn=In.validationError,Kn=In.handleCellEditStart,Ln=In.handleCellEditSave,Tn=In.handleCellEditCancel,An=o.useCallback(function(e,n,t){"__rowNumber__"!==String(n.key)&&Kn(e,n,t)},[Kn]),On=function(e,n,t,r,a){var c=l(o.useState(null),2),u=c[0],s=c[1],d=l(o.useState(null),2),h=d[0],f=d[1],g=l(o.useState(!1),2),m=g[0],p=g[1],v=l(o.useState(null),2),y=v[0],C=v[1],b=y||n;o.useEffect(function(){C(null)},[n]);var w=o.useCallback(function(n,t){e?(n.stopPropagation(),p(!0),s(t),n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text/plain",String(t)),n.currentTarget&&(n.currentTarget.style.opacity="0.5")):n.preventDefault()},[e]),x=o.useCallback(function(n,t){e&&null!==u&&(n.preventDefault(),n.dataTransfer.dropEffect="move",h!==t&&f(t))},[e,u,h]),k=o.useCallback(function(n){e&&(n.currentTarget===n.target||n.currentTarget.contains(n.relatedTarget)||f(null))},[e]),S=o.useCallback(function(n,o){if(!e||null===u||u===o)return s(null),void f(null);if(n.preventDefault(),n.stopPropagation(),r)return s(null),void f(null);var c=i([],l(b),!1),d=t[u],h=t[o],g=c.findIndex(function(e){return e===d}),m=c.findIndex(function(e){return e===h});if(-1===g||-1===m||g===m)return s(null),void f(null);var p=i([],l(c),!1),v=p[g];p.splice(g,1);var y=g<m?m-1:m;p.splice(y,0,v),C(p),a&&a(p,v,g,y),s(null),f(null)},[e,u,r,t,b,a]),R=o.useCallback(function(n){e&&(n.currentTarget&&(n.currentTarget.style.opacity="1"),p(!1),s(null),f(null),setTimeout(function(){p(!1)},100))},[e]);return{draggedRowIndex:u,dragOverRowIndex:h,isDragging:m,reorderedData:y,effectiveData:b,handleRowDragStart:w,handleRowDragOver:x,handleRowDragLeave:k,handleRowDrop:S,handleRowDragEnd:R}}(ce,Pe,De.filtered,Ge,ue),Fn=On.draggedRowIndex,_n=On.dragOverRowIndex,Bn=On.isDragging,Hn=On.handleRowDragStart,zn=On.handleRowDragOver,Vn=On.handleRowDragLeave,Wn=On.handleRowDrop,Un=On.handleRowDragEnd,jn=function(e,n,t){void 0===t&&(t=!0);var r=l(o.useState(new Set),2),i=r[0],a=r[1],c=l(o.useState(null),2),u=c[0],s=c[1],d=l(o.useState(!1),2),h=d[0],f=d[1],g=l(o.useState(null),2),m=g[0],p=g[1],v=l(o.useState(!1),2),y=v[0],C=v[1],b=l(o.useState(null),2),w=b[0],x=b[1],k=o.useCallback(function(e,n){return"".concat(e,"-").concat(n)},[]),S=o.useCallback(function(e,t){var o=Math.min(e.rowIndex,t.rowIndex),r=Math.max(e.rowIndex,t.rowIndex),l=n.findIndex(function(n){return String(n.key)===e.colKey}),i=n.findIndex(function(e){return String(e.key)===t.colKey}),a=l>=0?l:0,c=i>=0?i:n.length-1,u=Math.min(a,c),s=Math.max(a,c);return{start:{rowIndex:o,colKey:String(n[Math.max(0,u)]&&n[Math.max(0,u)].key||e.colKey)},end:{rowIndex:r,colKey:String(n[Math.min(n.length-1,s)]&&n[Math.min(n.length-1,s)].key||t.colKey)}}},[n]),R=o.useCallback(function(e){for(var t=[],o=Math.min(e.start.rowIndex,e.end.rowIndex),r=Math.max(e.start.rowIndex,e.end.rowIndex),l=n.findIndex(function(n){return String(n.key)===e.start.colKey}),i=n.findIndex(function(n){return String(n.key)===e.end.colKey}),a=l>=0?l:0,c=i>=0?i:n.length-1,u=Math.min(a,c),s=Math.max(a,c),d=o;d<=r;d++)for(var h=u;h<=s;h++)n[h]&&t.push({rowIndex:d,colKey:String(n[h].key)});return t},[n]),I=o.useCallback(function(e,n,o){if(t){var r={rowIndex:e,colKey:n};if(p(r),f(!0),o&&u){var l=S(u.start,r);s(l);var i=R(l);a(new Set(i.map(function(e){return k(e.rowIndex,e.colKey)})))}else s({start:r,end:r}),a(new Set([k(e,n)]))}},[t,u,S,R,k]),M=o.useCallback(function(e,n){if(t&&h&&m){var o=S(m,{rowIndex:e,colKey:n});s(o);var r=R(o);a(new Set(r.map(function(e){return k(e.rowIndex,e.colKey)})))}},[t,h,m,S,R,k]),N=o.useCallback(function(){f(!1),p(null)},[]),E=o.useCallback(function(){a(new Set),s(null),f(!1),p(null),C(!1)},[]),P=o.useCallback(function(){x(null)},[]),D=o.useCallback(function(e,n){t&&(x({rowIndex:e,colKey:n}),0===i.size&&I(e,n,!1))},[t,i.size,I]),K=o.useCallback(function(o,r){var l;if(void 0===r&&(r=!1),!t)return null;var i=w;if(!i&&u&&(i=u.end),!i){if(!(e.length>0&&n.length>0))return null;i={rowIndex:0,colKey:String(n[0].key)}}var c=i.rowIndex,d=n.findIndex(function(e){return String(e.key)===i.colKey});if(-1===d)return null;var h=c,f=d,g=e.length-1;switch(o){case"up":h=Math.max(0,c-1);break;case"down":h=Math.min(g,c+1);break;case"left":f=Math.max(0,d-1);break;case"right":f=Math.min(n.length-1,d+1)}var p=String(null===(l=n[f])||void 0===l?void 0:l.key);if(!p)return null;var v={rowIndex:h,colKey:p};if(x(v),r){var y=m||(null==u?void 0:u.start)||i,C=S(y,v);s(C);var b=R(C);a(new Set(b.map(function(e){return k(e.rowIndex,e.colKey)})))}else I(h,p,!1);return v},[t,w,u,m,e,n,S,R,k,I]),L=o.useCallback(function(e){C(e)},[]),T=o.useCallback(function(e,n){if(t){var o=S(e,n);s(o);var r=R(o);a(new Set(r.map(function(e){return k(e.rowIndex,e.colKey)}))),f(!1),p(null)}},[t,S,R,k]),A=o.useCallback(function(e,n){return i.has(k(e,n))},[i,k]),O=o.useCallback(function(){return u?R(u):Array.from(i).map(function(e){var n=l(e.split("-"),2),t=n[0],o=n[1];return{rowIndex:parseInt(t,10),colKey:o}})},[u,i,R]),F=o.useCallback(function(){return u},[u]);return{selectedCells:i,selectedRange:u,isSelecting:h,isCopied:y,focusedCell:w,startSelection:I,updateSelection:M,endSelection:N,clearSelection:E,clearFocus:P,setCopied:L,setFocusedCell:D,setSelectionRange:T,moveFocus:K,isCellSelected:A,getSelectedCells:O,getSelectedRange:F}}(De.paged,en,be),Gn=o.useRef(De.currentPage);o.useEffect(function(){be&&Gn.current!==De.currentPage&&(jn.clearSelection(),jn.clearFocus(),Gn.current=De.currentPage)},[De.currentPage,be,jn.clearSelection,jn.clearFocus]);var qn=function(){var e=this,n=l(o.useState(null),2),t=n[0],r=n[1],a=l(o.useState(!1),2),c=a[0],u=a[1],s=l(o.useState([]),2),d=s[0],h=s[1],f=o.useCallback(function(e,n,t){if(0!==e.length){var o=i([],l(e),!1).sort(function(e,n){return e.rowIndex!==n.rowIndex?e.rowIndex-n.rowIndex:t.findIndex(function(n){return String(n.key)===e.colKey})-t.findIndex(function(e){return String(e.key)===n.colKey})}),a=new Map;o.forEach(function(e){a.has(e.rowIndex)||a.set(e.rowIndex,[]),a.get(e.rowIndex).push(e)});var c=[];a.forEach(function(e,o){var r=[];e.sort(function(e,n){return t.findIndex(function(n){return String(n.key)===e.colKey})-t.findIndex(function(e){return String(e.key)===n.colKey})}),e.forEach(function(e){var t=n[o];if(t){var l=t[e.colKey];r.push(null!=l?String(l):"")}else r.push("")}),c.push(r)}),r(c),u(!1),h([]);var s=c.map(function(e){return e.join("\t")}).join("\n");navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(s).catch(function(){var e=document.createElement("textarea");e.value=s,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)})}},[]),g=o.useCallback(function(e,n,t){f(e,n,t),u(!0),h(e)},[f]),m=o.useCallback(function(e,n,o,r){if(t&&0!==t.length&&0!==e.length){if(1===t.length&&1===t[0].length){var l=t[0][0];e.forEach(function(e){var t=n[e.rowIndex];t&&r(t,e.colKey,l,e.rowIndex)})}else{var i=e[0];if(!i)return;var a=o.findIndex(function(e){return String(e.key)===i.colKey});if(-1===a)return;t.forEach(function(e,t){var l=i.rowIndex+t;if(!(l<0||l>=n.length)){var c=n[l];c&&e.forEach(function(e,n){var t=a+n;if(!(t<0||t>=o.length)){var i=o[t];if(i)try{r(c,i.key,e,l)}catch(e){}}})}})}c&&d.length>0&&(d.forEach(function(e){var t=n[e.rowIndex];t&&r(t,e.colKey,"",e.rowIndex)}),u(!1),h([]))}},[t,c,d]),p=o.useCallback(function(n,t,o,r){return l=e,i=void 0,c=function(){var e,l,i,a,c,u,s;return function(e,n){var t,o,r,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=a(0),i.throw=a(1),i.return=a(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(l=0)),l;)try{if(t=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,o=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!((r=(r=l.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){l=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){l.label=a[1];break}if(6===a[0]&&l.label<r[1]){l.label=r[1],r=a;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(a);break}r[2]&&l.ops.pop(),l.trys.pop();continue}a=n.call(e,l)}catch(e){a=[6,e],o=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,function(d){switch(d.label){case 0:if(0===n.length)return[2,!1];d.label=1;case 1:return d.trys.push([1,5,,6]),e="",navigator.clipboard&&navigator.clipboard.readText?[4,navigator.clipboard.readText()]:[3,3];case 2:return e=d.sent(),[3,4];case 3:return[2,!1];case 4:return e&&0!==e.trim().length?0===(l=e.split(/\r?\n/).filter(function(e){return e.trim().length>0})).length||0===(i=l.map(function(e){for(var n=[],t="",o=!1,r=0;r<e.length;r++){var l=e[r];'"'===l?o&&'"'===e[r+1]?(t+='"',r++):o=!o:"\t"!==l||o?t+=l:(n.push(t),t="")}return n.push(t),n})).length||0===i[0].length?[2,!1]:(n[0],1===i.length&&1===i[0].length?(a=i[0][0],n.forEach(function(e){var n=t[e.rowIndex];n&&r(n,e.colKey,a,e.rowIndex)}),[2,!0]):(c=!1,(u=n[0])?-1===(s=o.findIndex(function(e){return String(e.key)===u.colKey}))?[2,!1]:(i.forEach(function(e,n){var l=u.rowIndex+n;if(!(l<0||l>=t.length)){var i=t[l];i&&e.forEach(function(e,n){var t=s+n;if(!(t<0||t>=o.length)){var a=o[t];if(a)try{r(i,a.key,e,l),c=!0}catch(e){}}})}}),[2,c]):[2,!1])):[2,!1];case 5:return d.sent(),[2,!1];case 6:return[2]}})},new((a=void 0)||(a=Promise))(function(e,n){function t(e){try{r(c.next(e))}catch(e){n(e)}}function o(e){try{r(c.throw(e))}catch(e){n(e)}}function r(n){var r;n.done?e(n.value):(r=n.value,r instanceof a?r:new a(function(e){e(r)})).then(t,o)}r((c=c.apply(l,i||[])).next())});var l,i,a,c},[]),v=o.useCallback(function(){return null!==t&&t.length>0},[t]),y=o.useCallback(function(){return t},[t]),C=o.useCallback(function(){r(null),u(!1),h([])},[]);return{copyCells:f,cutCells:g,pasteCells:m,pasteFromSystemClipboard:p,canPaste:v,getClipboardData:y,clearClipboard:C}}(),Xn=o.useCallback(function(e,n,t){if(be&&"__rowNumber__"!==n){t.stopPropagation();var o=t.shiftKey;jn.startSelection(e,n,o),jn.setFocusedCell(e,n),jn.setCopied(!1)}},[be,jn]),Yn=o.useCallback(function(e,n,t){be&&jn.isSelecting&&"__rowNumber__"!==n&&jn.updateSelection(e,n)},[be,jn]),Jn=o.useCallback(function(e,n,t){be&&"__rowNumber__"!==n&&jn.endSelection()},[be,jn]),Qn=o.useCallback(function(e,n){if(!be)return{isStart:!1,isEnd:!1,isInRange:!1,isTopRow:!1,isBottomRow:!1,isLeftCol:!1,isRightCol:!1,isCopied:!1,isFocused:!1};var t=jn.focusedCell&&jn.focusedCell.rowIndex===e&&jn.focusedCell.colKey===n;if(!jn.selectedRange)return{isStart:!1,isEnd:!1,isInRange:!1,isTopRow:!1,isBottomRow:!1,isLeftCol:!1,isRightCol:!1,isCopied:!1,isFocused:t};var o=jn.selectedRange,r=Math.min(o.start.rowIndex,o.end.rowIndex),l=Math.max(o.start.rowIndex,o.end.rowIndex),i=en.findIndex(function(e){return String(e.key)===o.start.colKey}),a=en.findIndex(function(e){return String(e.key)===o.end.colKey}),c=Math.min(i>=0?i:0,a>=0?a:en.length-1),u=Math.max(i>=0?i:0,a>=0?a:en.length-1),s=en.findIndex(function(e){return String(e.key)===n});return{isStart:o.start.rowIndex===e&&o.start.colKey===n,isEnd:o.end.rowIndex===e&&o.end.colKey===n,isInRange:jn.isCellSelected(e,n),isTopRow:e===r,isBottomRow:e===l,isLeftCol:s===c,isRightCol:s===u,isCopied:jn.isCopied,isFocused:t}},[be,jn,en]),Zn=o.useCallback(function(e){if(!be||!jn.selectedRange)return!1;var n=jn.selectedRange,t=Math.min(n.start.rowIndex,n.end.rowIndex);return t>0&&e===t-1},[be,jn]),$n=o.useCallback(function(){if(!be||!jn.selectedRange)return!1;var e=jn.selectedRange;return 0===Math.min(e.start.rowIndex,e.end.rowIndex)},[be,jn]),et=o.useCallback(function(e){if(!be||!jn.selectedRange)return!1;var n=jn.selectedRange,t=en.findIndex(function(e){return String(e.key)===n.start.colKey}),o=en.findIndex(function(e){return String(e.key)===n.end.colKey}),r=Math.min(t>=0?t:0,o>=0?o:en.length-1),l=Math.max(t>=0?t:0,o>=0?o:en.length-1),i=en.findIndex(function(n){return String(n.key)===e});return i>=r&&i<=l},[be,jn,en]),nt=o.useCallback(function(e){if(!be||!jn.selectedRange)return{isInRange:!1,isLeftCol:!1,isRightCol:!1};var n=jn.selectedRange,t=en.findIndex(function(e){return String(e.key)===n.start.colKey}),o=en.findIndex(function(e){return String(e.key)===n.end.colKey}),r=Math.min(t>=0?t:0,o>=0?o:en.length-1),l=Math.max(t>=0?t:0,o>=0?o:en.length-1),i=en.findIndex(function(n){return String(n.key)===e});return{isInRange:i>=r&&i<=l,isLeftCol:i===r,isRightCol:i===l}},[be,jn,en]);o.useEffect(function(){if(be){var e=function(e){if(Le.current){var n=e.target;n&&!Le.current.contains(n)&&(jn.clearSelection(),jn.clearFocus())}};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}},[be,jn]),o.useEffect(function(){if(be&&Le.current){var e=function(e){if(Le.current){var n=e.relatedTarget;n&&!Le.current.contains(n)&&(jn.clearSelection(),jn.clearFocus())}},n=Le.current;return n.addEventListener("focusout",e),function(){n.removeEventListener("focusout",e)}}},[be,jn]),o.useEffect(function(){if(be){var e=function(e){var n,t=document.activeElement;if(Le.current&&t&&Le.current.contains(t))if("INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&"true"!==t.getAttribute("contenteditable"))if((e.ctrlKey||e.metaKey)&&"c"===e.key){if((S=(d=jn.getSelectedCells()).filter(function(e){return"__rowNumber__"!==e.colKey})).length>0){e.preventDefault();var o=Ge?De.filtered:De.sorted,r=(De.currentPage-1)*De.itemsPerPage,l=S.map(function(e){var n=r+e.rowIndex,t=De.paged[e.rowIndex];if(t){var l=o.findIndex(function(e){return e===t||hn(e,-1)===hn(t,-1)});if(l>=0)return{rowIndex:l,colKey:e.colKey}}return{rowIndex:n,colKey:e.colKey}}),i=en.filter(function(e){return"__rowNumber__"!==String(e.key)}).map(function(e){return{key:e.key,label:e.label}});qn.copyCells(l,o,i),jn.setCopied(!0)}}else if((e.ctrlKey||e.metaKey)&&"x"===e.key){if((S=(d=jn.getSelectedCells()).filter(function(e){return"__rowNumber__"!==e.colKey})).length>0){e.preventDefault();var a=Ge?De.filtered:De.sorted,c=(De.currentPage-1)*De.itemsPerPage;l=S.map(function(e){var n=c+e.rowIndex,t=De.paged[e.rowIndex];if(t){var o=a.findIndex(function(e){return e===t||hn(e,-1)===hn(t,-1)});if(o>=0)return{rowIndex:o,colKey:e.colKey}}return{rowIndex:n,colKey:e.colKey}}),i=en.filter(function(e){return"__rowNumber__"!==String(e.key)}).map(function(e){return{key:e.key,label:e.label}}),qn.cutCells(l,a,i)}}else if((e.ctrlKey||e.metaKey)&&"v"===e.key){var u=jn.focusedCell,s=jn.selectedRange,d=jn.getSelectedCells(),f=null;if(u?f={rowIndex:u.rowIndex,colKey:u.colKey}:s?f={rowIndex:s.start.rowIndex,colKey:s.start.colKey}:d.length>0&&(f=d[0]),f){e.preventDefault();var g=Ge?De.filtered:De.sorted,m=De.paged[f.rowIndex],p=f.rowIndex;if(m){var v=g.findIndex(function(e){return e===m||hn(e,-1)===hn(m,-1)});if(v>=0)p=v;else{var y=(De.currentPage-1)*De.itemsPerPage;(p=y+f.rowIndex)>=g.length&&(p=g.length-1)}}else y=(De.currentPage-1)*De.itemsPerPage,(p=y+f.rowIndex)>=g.length&&(p=g.length-1);var C=function(e,n,t,o){var r=Pe.find(function(n){return n===e||hn(n,-1)===hn(e,-1)});if(r){var l=Pe.findIndex(function(e){return e===r});Rn(r,n,t,l>=0?l:o)}else Rn(e,n,t,o)},b=[{rowIndex:p,colKey:f.colKey}],w=f.colKey,x=function(e,n){var t=p,o=Math.min(p+e-1,g.length-1),r=en.findIndex(function(e){return String(e.key)===w}),l=Math.min(r+n-1,en.length-1);if(r>=0&&l>=0&&t>=0&&o>=0){var i=String(en[r].key),a=String(en[l].key),c=(De.currentPage-1)*De.itemsPerPage,u=t-c,s=o-c;u>=0&&s>=0&&u<De.paged.length&&s<De.paged.length&&requestAnimationFrame(function(){requestAnimationFrame(function(){jn.setCopied(!1),jn.setSelectionRange({rowIndex:u,colKey:i},{rowIndex:s,colKey:a}),jn.setFocusedCell(u,i)})})}},k=en.filter(function(e){return"__rowNumber__"!==String(e.key)}).map(function(e){return{key:e.key,label:e.label}});qn.pasteFromSystemClipboard(b,g,k,C).then(function(e){if(e){var n=(o=qn.getClipboardData())&&o.length||1,t=o&&o[0]&&o[0].length||1;requestAnimationFrame(function(){requestAnimationFrame(function(){x(n,t)})})}else if(qn.canPaste()){var o,r=(o=qn.getClipboardData())&&o.length||1,l=o&&o[0]&&o[0].length||1;qn.pasteCells(b,g,k,C),requestAnimationFrame(function(){requestAnimationFrame(function(){x(r,l)})})}}).catch(function(){if(qn.canPaste()){var e=qn.getClipboardData(),n=e&&e.length||1,t=e&&e[0]&&e[0].length||1;qn.pasteCells(b,g,k,C),requestAnimationFrame(function(){requestAnimationFrame(function(){x(n,t)})})}})}}else if("Delete"===e.key||"Backspace"===e.key){var S;if((S=(d=jn.getSelectedCells()).filter(function(e){return"__rowNumber__"!==e.colKey})).length>0){e.preventDefault();var R=Ge?De.filtered:Pe;S.forEach(function(e){var n=R[e.rowIndex];if(n){var t=Pe.findIndex(function(e){return e===n});Rn(n,e.colKey,"",t>=0?t:e.rowIndex)}})}}else if("Escape"===e.key)jn.clearSelection(),jn.setCopied(!1);else if("ArrowUp"===e.key||"ArrowDown"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key){if(!Mn){e.preventDefault();var I="ArrowUp"===e.key?"up":"ArrowDown"===e.key?"down":"ArrowLeft"===e.key?"left":"right",M=e.shiftKey;(T=jn.moveFocus(I,M))&&Le.current&&(A=Le.current.querySelector('[data-row-index="'.concat(T.rowIndex,'"][data-col-key="').concat(T.colKey,'"]')))&&A.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}}else if("Tab"!==e.key||Mn)if("Enter"!==e.key||Mn)if("Home"!==e.key&&"End"!==e.key||Mn){if((e.ctrlKey||e.metaKey)&&("ArrowUp"===e.key||"ArrowDown"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key)&&!Mn){e.preventDefault();var N=jn.focusedCell||jn.selectedRange&&jn.selectedRange.end;if(N){var E=Ge?De.filtered:h,P=N.rowIndex;L=en.findIndex(function(e){return String(e.key)===N.colKey}),"ArrowUp"===e.key?P=0:"ArrowDown"===e.key?P=E.length-1:"ArrowLeft"===e.key?L=0:"ArrowRight"===e.key&&(L=en.length-1),(K=String(null===(n=en[L])||void 0===n?void 0:n.key))&&(jn.setFocusedCell(P,K),jn.startSelection(P,K,e.shiftKey),Le.current&&(A=Le.current.querySelector('[data-row-index="'.concat(P,'"][data-col-key="').concat(K,'"]')))&&A.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}))}}}else{e.preventDefault();var D=jn.focusedCell||jn.selectedRange&&jn.selectedRange.end;if(D&&en.findIndex(function(e){return String(e.key)===D.colKey})>=0){var K,L="Home"===e.key?0:en.length-1;(K=String(en[L]&&en[L].key||""))&&(jn.setFocusedCell(D.rowIndex,K),jn.startSelection(D.rowIndex,K,e.shiftKey))}}else e.preventDefault(),I=e.shiftKey?"up":"down",(T=jn.moveFocus(I,!1))&&Le.current&&(A=Le.current.querySelector('[data-row-index="'.concat(T.rowIndex,'"][data-col-key="').concat(T.colKey,'"]')))&&A.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"});else{e.preventDefault();var T,A;I=e.shiftKey?"left":"right";(T=jn.moveFocus(I,!1))&&Le.current&&(A=Le.current.querySelector('[data-row-index="'.concat(T.rowIndex,'"][data-col-key="').concat(T.colKey,'"]')))&&A.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}else(e.ctrlKey||e.metaKey)&&("c"===e.key||"x"===e.key||e.key)};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}},[be,jn,qn,De.paged,en,W,Ge,h,Mn,De.filtered]);var tt=o.useMemo(function(){return _e?Array.from(new Set(h.map(function(e){return String(e[_e])}))):[]},[_e,h]);o.useEffect(function(){Ge&&De.setCurrentPage(1)},[Ge]);var ot=o.useMemo(function(){if(!Ge)return null;var e={};return(De.sortKey?i([],l(De.filtered),!1).sort(function(e,n){var t=e[De.sortKey],o=n[De.sortKey];if(null==t)return 1;if(null==o)return-1;if(t===o)return 0;var r=String(t).localeCompare(String(o),void 0,{numeric:!0,sensitivity:"base"});return"asc"===De.sortDir?r:-r}):De.filtered).forEach(function(n){var t=String(n[Ge]);e[t]||(e[t]=[]),e[t].push(n)}),e},[De.filtered,De.sortKey,De.sortDir,Ge]);o.useEffect(function(){if(Ge&&ot){var e=Object.keys(ot).length,n=Math.ceil(e/De.itemsPerPage);De.currentPage>n&&n>0&&De.setCurrentPage(1)}},[ot,Ge,De.itemsPerPage,De.currentPage,De.setCurrentPage]);var rt=o.useMemo(function(){if(!Ge||!ot)return null;var e=Object.entries(ot);e.sort(function(e,n){var t=l(e,1)[0],o=l(n,1)[0];return t.localeCompare(o)});var n=(De.currentPage-1)*De.itemsPerPage,t=n+De.itemsPerPage;return e.slice(n,t)},[ot,De.currentPage,De.itemsPerPage,Ge]);o.useEffect(function(){Ge&&ot?Ye(new Set(Object.keys(ot))):Ge||Ye(new Set)},[Ge,ot]);var lt=o.useCallback(function(e,n){if(n.onRenderCell){var t=n.onRenderCell(e,n.key,0);return String("string"==typeof t||"number"==typeof t?t:null!=e[n.key]?e[n.key]:"")}return p?(t=p(e,n.key,0),String("string"==typeof t||"number"==typeof t?t:null!=e[n.key]?e[n.key]:"")):String(null!=e[n.key]?e[n.key]:"")},[p]),it=o.useCallback(function(t,o,l){var i=Mn&&Mn.rowIndex===l&&Mn.columnKey===o.key,a=i&&null!==Dn;return i&&o.editable?e("div",be?r({className:"hh-cell-edit-wrapper"},{children:[n("input",{ref:En,type:"text",className:"hh-cell-edit-input hh-cell-edit-input-excel ".concat(a?"hh-cell-edit-input-error":""),value:Nn,onChange:function(e){return Pn(e.target.value)},onBlur:function(){!1===Ln(t,o.key,l)&&En.current&&setTimeout(function(){En.current&&En.current.focus()},0)},onKeyDown:function(e){"Enter"===e.key?(e.preventDefault(),!1===Ln(t,o.key,l)&&En.current&&En.current.focus()):"Escape"===e.key&&(e.preventDefault(),Tn()),"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Tab"!==e.key&&"Home"!==e.key&&"End"!==e.key||e.stopPropagation()},onClick:function(e){e.stopPropagation()},onFocus:function(e){var n=e.target;n&&setTimeout(function(){var e=n.value.length;n.setSelectionRange(e,e)},0)},onMouseDown:function(e){e.stopPropagation()}}),a&&n("div",r({className:"hh-cell-edit-error-message"},{children:Dn}))]}):r({className:"hh-cell-edit-container"},{children:[n("input",{ref:En,type:"text",className:"hh-cell-edit-input ".concat(a?"hh-cell-edit-input-error":""),value:Nn,onChange:function(e){return Pn(e.target.value)},onKeyDown:function(e){"Enter"===e.key?(e.preventDefault(),!1===Ln(t,o.key,l)&&En.current&&En.current.focus()):"Escape"===e.key&&(e.preventDefault(),Tn()),"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Tab"!==e.key&&"Home"!==e.key&&"End"!==e.key||e.stopPropagation()},onClick:function(e){e.stopPropagation()},onFocus:function(e){var n=e.target;n&&setTimeout(function(){var e=n.value.length;n.setSelectionRange(e,e)},0)},onMouseDown:function(e){e.stopPropagation()}}),e("div",r({className:"hh-cell-edit-buttons"},{children:[n("button",r({type:"button",className:"hh-cell-edit-button hh-cell-edit-save",onClick:function(e){e.stopPropagation(),e.preventDefault(),!1===Ln(t,o.key,l)&&En.current&&En.current.focus()},onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},title:"Save"},{children:n(u,{width:12,height:12})})),n("button",r({type:"button",className:"hh-cell-edit-button hh-cell-edit-cancel",onClick:function(e){e.stopPropagation(),e.preventDefault(),Tn()},onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},title:"Cancel"},{children:n(s,{width:12,height:12})}))]})),a&&n("div",r({className:"hh-cell-edit-error-message"},{children:Dn}))]})):o.onRenderCell?o.onRenderCell(t,o.key,l):p?p(t,o.key,l):String(null!=t[o.key]?t[o.key]:"")},[p,Mn,Nn,Dn,Ln,Tn]),at=o.useMemo(function(){return O(z)},[z]),ct=o.useMemo(function(){return F(at)},[at]),ut=o.useMemo(function(){return Ge&&rt?rt.flatMap(function(e){var n=l(e,2);return n[0],n[1]}):De.paged},[Ge,rt,De.paged]),st=function(e,n,t,r,i,a,c){var u=l(o.useState(null),2),s=u[0],d=u[1];return o.useEffect(function(){if(n&&e.current&&!t){var o=function(e){if(!t&&0!==r.length){var n=document.activeElement;if(!n||"INPUT"!==n.tagName&&"TEXTAREA"!==n.tagName&&"true"!==n.getAttribute("contenteditable")){var o=null!=s?s:0;switch(e.key){case"ArrowDown":e.preventDefault(),o=Math.min(o+1,r.length-1),d(o);break;case"ArrowUp":e.preventDefault(),o=Math.max(o-1,0),d(o);break;case"Enter":case" ":if(e.preventDefault(),null!==s&&"none"!==i){var l=r[s],u=a(l,s);c&&c(new Set([u]))}break;case"Escape":e.preventDefault(),d(null),c&&c(new Set)}}}};return e.current.addEventListener("keydown",o),function(){e.current&&e.current.removeEventListener("keydown",o)}}},[n,t,s,i,r,a,c,e]),{focusedRowIndex:s,setFocusedRowIndex:d}}(Le,ie,Y,ut,K,hn,function(e){return pn(e)}),dt=st.focusedRowIndex,ht=Pe.length>0,ft=!Y&&!ht,gt=!Y&&ht,mt=o.useCallback(function(e,n){var t=String(e.key);if("left"!==(Ze[t]||e.pinned||null))return 0;var o=0;"none"!==K&&(o+=48);for(var r=0;r<n;r++){var l=en[r];"left"===(Ze[String(l.key)]||l.pinned||null)&&(o+=bn[String(l.key)]||("number"==typeof l.width?l.width:parseFloat(l.width||"0"))||("string"==typeof l.width&&l.width.includes("px")?parseFloat(l.width):100))}return o},[en,Ze,bn,K]),pt=o.useCallback(function(e,n){var t=String(e.key);if("right"!==(Ze[t]||e.pinned||null))return 0;for(var o=0,r=n+1;r<en.length;r++){var l=en[r];"right"===(Ze[String(l.key)]||l.pinned||null)&&(o+=bn[String(l.key)]||("number"==typeof l.width?l.width:parseFloat(l.width||"0"))||("string"==typeof l.width&&l.width.includes("px")?parseFloat(l.width):100))}return o},[en,Ze,bn]),vt=o.useMemo(function(){for(var e=null,n=0;n<en.length;n++){var t=en[n];if("left"===(Ze[String(t.key)]||t.pinned||null))e=t.key;else if(null!==e)break}return e},[en,Ze]),yt=o.useMemo(function(){for(var e=0;e<en.length;e++){var n=en[e];if("right"===(Ze[String(n.key)]||n.pinned||null))return n.key}return null},[en,Ze]);return e("div",r({ref:Le,className:"hh-table ".concat(M||""," hh-theme-").concat(at.mode||"light"," ").concat(wn?"resizing":""," ").concat(ee?"hh-sticky-header":""," ").concat(be?"enable-cell-selection":""),style:r(r(r(r({},ct),N),V?{maxHeight:"number"==typeof V?"".concat(V,"px"):V,overflow:"auto"}:{}),wn?{cursor:"col-resize"}:{}),onScroll:o.useCallback(function(e){requestAnimationFrame(function(){})},[]),tabIndex:be||ie?0:void 0},{children:[de&&n("div",r({className:"hh-export-toolbar"},{children:n(L,{data:De.filtered,columns:en,format:fe,filename:me,onBeforeExport:pe,onAfterExport:ve})})),Y&&n(y,{columns:en,itemsPerPage:g,selectionMode:K,onRenderLoading:J}),ft&&n(C,{emptyMessage:Q,onRenderEmpty:Z}),gt&&n("div",r({style:r({overflowX:"auto",overflowY:ee&&!V?"auto":"visible",width:"100%"},ee&&!V?{maxHeight:"calc(100vh - 200px)"}:{})},{children:e("table",{children:[n(k,{columns:en,selectionMode:K,isAllSelected:sn,isIndeterminate:dn,onSelectAll:mn,columnWidths:bn,pinnedColumns:Ze,lastLeftPinnedColumnKey:vt,firstRightPinnedColumnKey:yt,stickyHeader:ee,enableColumnReorder:oe||!1,dragOverColumn:$e,sortKey:De.sortKey,sortDir:De.sortDir,filters:De.filters,anchorRefs:Ke,calloutKey:kn.calloutKey,resizingColumn:wn,onRenderHeader:w,onColumnHeaderClick:x,onHeaderMouseEnter:function(e){if("__rowNumber__"!==e){var n=en.find(function(n){return String(n.key)===e});n&&!1===n.showCallout||kn.handleHeaderMouseEnter(e)}},onHeaderMouseLeave:kn.handleHeaderMouseLeave,onCalloutMouseEnter:kn.handleCalloutMouseEnter,onCalloutMouseLeave:kn.handleCalloutMouseLeave,onColumnDragStart:on,onColumnDragOver:rn,onColumnDrop:ln,onResizeStart:xn,onSortAsc:function(e){"__rowNumber__"!==String(e.key)&&!1!==e.sortable&&De.handleSort(e.key,"asc")},onSortDesc:function(e){"__rowNumber__"!==String(e.key)&&!1!==e.sortable&&De.handleSort(e.key,"desc")},onFilter:function(e){var n;"__rowNumber__"!==String(e.key)&&!1!==e.filterable&&(n=e.key,Be(String(n)),kn.dismissCallout())},onClearFilter:function(e){"__rowNumber__"!==String(e.key)&&!1!==e.filterable&&De.setFilter(String(e.key),[])},onPinLeft:function(e){"__rowNumber__"!==String(e.key)&&tn(e.key,"left")},onPinRight:function(e){"__rowNumber__"!==String(e.key)&&tn(e.key,"right")},onUnpin:function(e){"__rowNumber__"!==String(e.key)&&tn(e.key,null)},onToggleVisibility:function(e){"__rowNumber__"!==String(e.key)&&ne&&nn(e.key)},onGroupBy:function(e){"__rowNumber__"!==String(e.key)&&(Ge===e.key?je(void 0):je(e.key))},currentGroupBy:Ge,enableColumnVisibility:ne||!1,onTotalsChange:function(e,n){Oe(function(t){var o;return r(r({},t),((o={})[String(e.key)]=n,o))})},columnTotals:Ae,getLeftOffset:mt,getRightOffset:pt,dismissCallout:kn.dismissCallout,enableRowActions:!!ye,enableCellSelection:be,isRangeFromFirstRow:$n(),isColumnInRange:et,getColumnRangeInfo:nt,isCopied:jn.isCopied}),n(E,{data:Pe,columns:en,paginatedGroups:rt||void 0,currentGroupBy:Ge,expandedGroups:Xe,selectionMode:K,selectedItems:cn,activeItemIndex:un,focusedRowIndex:null!=dt?dt:void 0,enableRowReorder:ce,draggedRowIndex:Fn,dragOverRowIndex:_n,isDragging:Bn,columnWidths:bn,pinnedColumns:Ze,lastLeftPinnedColumnKey:vt||void 0,firstRightPinnedColumnKey:yt||void 0,showTooltip:q,onRenderRow:b,getItemKey:hn,onItemClick:gn,onItemContextMenu:I,onCheckboxChange:fn,onCellEditStart:An,onRowDragStart:Hn,onRowDragOver:zn,onRowDragLeave:Vn,onRowDrop:Wn,onRowDragEnd:Un,renderCell:it,getCellText:lt,getLeftOffset:mt,getRightOffset:pt,toggleGroup:function(e){Ye(function(n){var t=new Set(n);return t.has(e)?t.delete(e):t.add(e),t})},filteredData:De.filtered,pagedData:De.paged,rowActions:ye,openMenuKey:ze,onMenuToggle:vn,onMenuDismiss:yn,enableCellSelection:be,isCellSelected:jn.isCellSelected,getCellRangeInfo:Qn,isRowAboveRange:Zn,isColumnInRange:et,getColumnRangeInfo:nt,onCellMouseDown:Xn,onCellMouseEnter:Yn,onCellMouseUp:Jn}),n(P,{columns:en,selectionMode:K,columnTotals:Ae,pinnedColumns:Ze,columnWidths:bn,lastLeftPinnedColumnKey:vt||void 0,firstRightPinnedColumnKey:yt||void 0,totalCount:De.filtered.length,getLeftOffset:mt,getRightOffset:pt})]})})),gt&&_&&n(c,{totalItems:Ge&&ot?Object.keys(ot).length:De.filtered.length,itemsPerPage:De.itemsPerPage,currentPage:De.currentPage,onPageChange:De.setCurrentPage,itemsPerPageOptions:Me,onItemsPerPageChange:function(e){Ne(e),De.setCurrentPage(1)}}),_e&&n(v,{field:_e,values:tt,selected:De.filters[_e]||[],onApply:function(e){De.setFilter(_e,e),Be(null)},onDismiss:function(){return Be(null)}})]}))}export{_ as ReactTabletify,F as applyTheme,A as defaultDarkTheme,T as defaultLightTheme,O as getTheme,a as useTable};
