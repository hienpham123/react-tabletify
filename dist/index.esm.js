import{jsxs as e,jsx as n,Fragment as t}from"react/jsx-runtime";import*as o from"react";var r=function(){return r=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},r.apply(this,arguments)};function l(e,n,t,o){return new(t||(t=Promise))(function(r,l){function i(e){try{c(o.next(e))}catch(e){l(e)}}function a(e){try{c(o.throw(e))}catch(e){l(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(i,a)}c((o=o.apply(e,n||[])).next())})}function i(e,n){var t,o,r,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=a(0),i.throw=a(1),i.return=a(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(l=0)),l;)try{if(t=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,o=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!(r=l.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){l=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){l.label=a[1];break}if(6===a[0]&&l.label<r[1]){l.label=r[1],r=a;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(a);break}r[2]&&l.ops.pop(),l.trys.pop();continue}a=n.call(e,l)}catch(e){a=[6,e],o=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function a(e,n,t){if(t||2===arguments.length)for(var o,r=0,l=n.length;r<l;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}function c(e,n){void 0===n&&(n=10);var t=o.useState(""),l=t[0],i=t[1],c=o.useState(null),u=c[0],s=c[1],d=o.useState("asc"),f=d[0],h=d[1],g=o.useState(1),m=g[0],p=g[1],v=o.useState({}),y=v[0],C=v[1],b=function(e,n){C(function(t){var o=r({},t);return 0===n.length?delete o[e]:o[e]=n,o})},w=o.useMemo(function(){var n=e;if(Object.entries(y).forEach(function(e){var t=e[0],o=e[1];o.length>0&&(n=n.filter(function(e){return o.includes(String(e[t]))}))}),l.trim()){var t=l.toLowerCase();n=n.filter(function(e){return Object.values(e).some(function(e){return String(e).toLowerCase().includes(t)})})}return n},[e,l,y]),x=o.useMemo(function(){return u?a([],w,!0).sort(function(e,n){var t=e[u],o=n[u];if(null==t)return 1;if(null==o)return-1;if(t===o)return 0;var r=String(t).localeCompare(String(o),void 0,{numeric:!0,sensitivity:"base"});return"asc"===f?r:-r}):w},[w,u,f]),k=Math.ceil(x.length/n),S=o.useMemo(function(){var e=(m-1)*n;return x.slice(e,e+n)},[x,m,n]);o.useEffect(function(){p(1)},[l,u,f,y]);var R=o.useCallback(function(){i("")},[]),I=o.useCallback(function(){C({})},[]),M=o.useCallback(function(e){b(e,[])},[b]),N=o.useCallback(function(){s(null),h("asc")},[]),P=o.useCallback(function(){i(""),C({}),s(null),h("asc"),p(1)},[]),E=o.useCallback(function(){p(1)},[]),D=o.useCallback(function(){p(k)},[k]),K=o.useCallback(function(){p(function(e){return Math.min(e+1,k)})},[k]),L=o.useCallback(function(){p(function(e){return Math.max(e-1,1)})},[]);return{filtered:w,sorted:x,paged:S,currentPage:m,setCurrentPage:p,totalPages:k,itemsPerPage:n,goToFirstPage:E,goToLastPage:D,goToNextPage:K,goToPrevPage:L,search:l,setSearch:i,clearSearch:R,sortKey:u,sortDir:f,handleSort:function(e,n){n?(s(e),h(n)):u===e?h(function(e){return"asc"===e?"desc":"asc"}):(s(e),h("asc"))},resetSort:N,filters:y,setFilter:b,clearFilter:M,clearFilters:I,resetAll:P}}"function"==typeof SuppressedError&&SuppressedError;var u=function(o){var l=o.totalItems,i=o.itemsPerPage,a=o.currentPage,c=o.onPageChange,u=o.maxVisible,s=void 0===u?5:u,d=o.itemsPerPageOptions,f=o.onItemsPerPageChange,h=Math.ceil(l/i),g=Math.floor(s/2),m=Math.max(1,a-g),p=Math.min(h,m+s-1);p-m<s-1&&(m=Math.max(1,p-s+1));var v=Array.from({length:p-m+1},function(e,n){return m+n}),y=function(e){e<1||e>h||e===a||c(e)};return!(h<=0)||d&&f?e("div",r({className:"th-pagination"},{children:[n("button",r({onClick:function(){return y(a-1)},disabled:1===a,className:"th-pagination-btn th-pagination-arrow","aria-label":"Previous page"},{children:"<"})),m>1&&e(t,{children:[n("button",r({className:"th-pagination-btn",onClick:function(){return y(1)}},{children:"1"})),m>2&&n("span",r({className:"th-pagination-ellipsis"},{children:"..."}))]}),v.map(function(e){return n("button",r({onClick:function(){return y(e)},className:"th-pagination-btn ".concat(e===a?"th-page-active":"")},{children:e}),e)}),p<h&&e(t,{children:[p<h-1&&n("span",r({className:"th-pagination-ellipsis"},{children:"..."})),n("button",r({className:"th-pagination-btn",onClick:function(){return y(h)}},{children:h}))]}),n("button",r({onClick:function(){return y(a+1)},disabled:a===h,className:"th-pagination-btn th-pagination-arrow","aria-label":"Next page"},{children:">"})),d&&f&&e("div",r({className:"th-pagination-items-per-page"},{children:[n("label",r({htmlFor:"th-items-per-page-select",style:{marginRight:"8px"}},{children:"Rows per page:"})),n("select",r({id:"th-items-per-page-select",value:i,onChange:function(e){var n=Number(e.target.value);f(n),c(1)},className:"th-pagination-select"},{children:d.map(function(e){return n("option",r({value:e},{children:e}),e)})}))]}))]})):null};function s(t){var l=t.field,i=t.values,c=t.selected,u=t.onApply,s=t.onDismiss,d=o.useState(c),f=d[0],h=d[1],g=o.useState(""),m=g[0],p=g[1];o.useEffect(function(){h(c),p("")},[l]);var v=o.useMemo(function(){if(!m.trim())return i;var e=m.toLowerCase();return i.filter(function(n){return n.toLowerCase().includes(e)})},[i,m]);return e("div",r({className:"th-filter-panel open"},{children:[e("div",r({className:"th-filter-header"},{children:[e("strong",{children:["Filter by '",l,"'"]}),n("button",r({className:"th-filter-close",onClick:s,"aria-label":"Close"},{children:n("svg",r({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:n("path",{d:"M12.8536 3.85355C13.0488 3.65829 13.0488 3.34171 12.8536 3.14645C12.6583 2.95118 12.3417 2.95118 12.1464 3.14645L8 7.29289L3.85355 3.14645C3.65829 2.95118 3.34171 2.95118 3.14645 3.14645C2.95118 3.34171 2.95118 3.65829 3.14645 3.85355L7.29289 8L3.14645 12.1464C2.95118 12.3417 2.95118 12.6583 3.14645 12.8536C3.34171 13.0488 3.65829 13.0488 3.85355 12.8536L8 8.70711L12.1464 12.8536C12.3417 13.0488 12.6583 13.0488 12.8536 12.8536C13.0488 12.6583 13.0488 12.3417 12.8536 12.1464L8.70711 8L12.8536 3.85355Z",fill:"currentColor"})}))}))]})),e("div",r({className:"th-filter-content"},{children:[n("div",r({className:"th-filter-search"},{children:n("input",{type:"text",className:"th-filter-search-input",placeholder:"Select ".concat(l," to display..."),value:m,onChange:function(e){return p(e.target.value)}})})),n("div",r({className:"th-filter-options-list"},{children:v.length>0?v.map(function(t){return e("div",r({className:"th-filter-option"},{children:[n("input",{type:"checkbox",id:"filter-".concat(l,"-").concat(t),checked:f.includes(t),onChange:function(){return function(e){h(function(n){return n.includes(e)?n.filter(function(n){return n!==e}):a(a([],n,!0),[e],!1)})}(t)}}),n("label",r({htmlFor:"filter-".concat(l,"-").concat(t)},{children:t}))]}),t)}):n("div",r({className:"th-filter-no-results"},{children:"No results found"}))}))]})),e("div",r({className:"th-filter-footer"},{children:[n("button",r({className:"th-btn",onClick:function(){h([])}},{children:"Clear all"})),n("button",r({className:"th-btn primary",onClick:function(){return u(f)}},{children:"Apply"}))]}))]}))}function d(o){var l=o.columns,i=o.itemsPerPage,a=o.selectionMode,c=o.onRenderLoading;return c?n(t,{children:c()}):e("div",r({className:"th-loading-skeleton"},{children:[e("div",r({className:"th-skeleton-header"},{children:["none"!==a&&n("div",{className:"th-skeleton-cell",style:{width:"48px"}}),l.map(function(e,t){return n("div",{className:"th-skeleton-cell",style:{width:e.width||"150px"}},t)})]})),Array.from({length:i}).map(function(t,o){return e("div",r({className:"th-skeleton-row"},{children:["none"!==a&&n("div",{className:"th-skeleton-cell",style:{width:"48px"}}),l.map(function(e,t){return n("div",{className:"th-skeleton-cell",style:{width:e.width||"150px"}},t)})]}),o)})]}))}function f(o){var l=o.emptyMessage,i=o.onRenderEmpty;return i?n(t,{children:i()}):e("div",r({className:"th-empty-state"},{children:[n("div",r({className:"th-empty-icon"},{children:"ðŸ“‹"})),n("div",r({className:"th-empty-message"},{children:l||"No data available"}))]}))}function h(e){var t=e.selectionMode,o=e.checked,l=e.indeterminate,i=e.onChange,a=e.onSelectAll;if("none"===t)return null;var c=void 0!==a;return n("td",r({className:"th-selection-column"},{children:n("div",r({className:"th-selection-checkbox-wrapper"},{children:"multiple"===t?n("input",{type:"checkbox",className:"th-selection-checkbox",checked:o,ref:function(e){e&&void 0!==l&&(e.indeterminate=l)},onChange:function(e){c&&a?a(e.target.checked):i(e.target.checked)},onClick:function(e){return e.stopPropagation()}}):c?n("div",{className:"th-selection-checkbox-wrapper"}):n("input",{type:"radio",className:"th-selection-checkbox",checked:o,onChange:function(e){return i(e.target.checked)},onClick:function(e){return e.stopPropagation()}})}))}))}function g(l){var i=l.anchorRef,a=l.onSortAsc,c=l.onSortDesc,u=l.onFilter,s=l.onClearFilter,d=l.onPinLeft,f=l.onPinRight,h=l.onUnpin,g=l.onToggleVisibility,m=l.onGroupBy,p=l.isGrouped,v=void 0!==p&&p,y=l.onColumnSettings,C=l.onTotalsChange,b=l.totalsValue,w=void 0===b?"none":b,x=l.columnLabel,k=void 0===x?"Column":x;l.onDismiss;var S=l.onMouseEnter,R=l.onMouseLeave,I=l.sortable,M=void 0===I||I,N=l.filterable,P=void 0===N||N,E=l.hasFilter,D=void 0!==E&&E,K=l.pinned,L=void 0===K?null:K,T=l.visible,A=void 0===T||T,O=l.enableColumnVisibility,_=void 0!==O&&O;l.enableColumnReorder;var F=l.enableGroupBy,B=void 0!==F&&F,H=l.enableTotals,z=void 0!==H&&H,V=o.useRef(null),U=o.useState(null),W=U[0],G=U[1],j=o.useRef(null);if(o.useEffect(function(){return function(){j.current&&clearTimeout(j.current)}},[]),!i.current)return null;var q=i.current.getBoundingClientRect(),X=function(e){j.current&&clearTimeout(j.current),G(e)},Y=function(){j.current=setTimeout(function(){G(null)},150)};return n(t,{children:e("div",r({ref:V,className:"th-callout",style:{top:q.bottom+6,left:q.left,position:"fixed"},onMouseEnter:S,onMouseLeave:R},{children:[M&&e(t,{children:[n("button",r({onClick:a,className:"th-callout-item"},{children:n("span",r({className:"th-callout-text"},{children:"Ascending"}))})),n("button",r({onClick:c,className:"th-callout-item"},{children:n("span",r({className:"th-callout-text"},{children:"Descending"}))}))]}),M&&P&&n("hr",{className:"th-callout-divider"}),P&&D&&s&&n("button",r({onClick:s,className:"th-callout-item"},{children:n("span",r({className:"th-callout-text"},{children:"Clear filter"}))})),P&&D&&s&&n("hr",{className:"th-callout-divider"}),P&&n("button",r({onClick:u,className:"th-callout-item"},{children:n("span",r({className:"th-callout-text"},{children:"Filter by"}))})),B&&m&&e(t,{children:[n("hr",{className:"th-callout-divider"}),e("button",r({onClick:m,className:"th-callout-item ".concat(v?"th-callout-item-selected":"")},{children:[e("span",r({className:"th-callout-text"},{children:["Group by ",k]})),v&&n("span",r({className:"th-callout-checkmark"},{children:"âœ“"}))]}))]}),(d||f||h||y||z)&&n("hr",{className:"th-callout-divider"}),y?e("div",r({className:"th-callout-item th-callout-item-with-submenu",onMouseEnter:function(){return X("column-settings")},onMouseLeave:Y},{children:[n("span",r({className:"th-callout-text"},{children:"Column settings"})),n("span",r({className:"th-callout-arrow"},{children:"â€º"})),"column-settings"===W&&e("div",r({className:"th-callout-submenu",onMouseEnter:function(){return X("column-settings")},onMouseLeave:Y},{children:[null===L&&d&&n("button",r({onClick:d,className:"th-callout-submenu-item"},{children:n("span",r({className:"th-callout-text"},{children:"Pin left"}))})),null===L&&f&&n("button",r({onClick:f,className:"th-callout-submenu-item"},{children:n("span",r({className:"th-callout-text"},{children:"Pin right"}))})),null!==L&&h&&n("button",r({onClick:h,className:"th-callout-submenu-item"},{children:n("span",r({className:"th-callout-text"},{children:"Unpin"}))})),_&&g&&e(t,{children:[(d||f||h)&&n("hr",{className:"th-callout-divider"}),n("button",r({onClick:g,className:"th-callout-submenu-item"},{children:n("span",r({className:"th-callout-text"},{children:A?"Hide column":"Show column"}))}))]})]}))]})):e(t,{children:[null===L&&d&&n("button",r({onClick:d,className:"th-callout-item"},{children:n("span",r({className:"th-callout-text"},{children:"Pin left"}))})),null===L&&f&&n("button",r({onClick:f,className:"th-callout-item"},{children:n("span",r({className:"th-callout-text"},{children:"Pin right"}))})),null!==L&&h&&n("button",r({onClick:h,className:"th-callout-item"},{children:n("span",r({className:"th-callout-text"},{children:"Unpin"}))}))]}),z&&C&&e("div",r({className:"th-callout-item th-callout-item-with-submenu",onMouseEnter:function(){return X("totals")},onMouseLeave:Y},{children:[n("span",r({className:"th-callout-text"},{children:"Totals"})),n("span",r({className:"th-callout-arrow"},{children:"â€º"})),"totals"===W&&e("div",r({className:"th-callout-submenu",onMouseEnter:function(){return X("totals")},onMouseLeave:Y},{children:[e("button",r({onClick:function(){return C("none")},className:"th-callout-submenu-item ".concat("none"===w?"th-callout-item-selected":"")},{children:[n("span",r({className:"th-callout-text"},{children:"None"})),"none"===w&&n("span",r({className:"th-callout-checkmark"},{children:"âœ“"}))]})),e("button",r({onClick:function(){return C("count")},className:"th-callout-submenu-item ".concat("count"===w?"th-callout-item-selected":"")},{children:[n("span",r({className:"th-callout-text"},{children:"Count"})),"count"===w&&n("span",r({className:"th-callout-checkmark"},{children:"âœ“"}))]}))]}))]})),!y&&_&&g&&e(t,{children:[n("hr",{className:"th-callout-divider"}),n("button",r({onClick:g,className:"th-callout-item"},{children:n("span",r({className:"th-callout-text"},{children:A?"Hide column":"Show column"}))}))]})]}))})}function m(t){var o=t.column,l=t.columnIndex,i=t.resizedWidth,a=t.pinPosition,c=t.leftOffset,u=t.rightOffset,s=t.lastLeftPinnedColumnKey,d=t.firstRightPinnedColumnKey,f=t.stickyHeader,h=t.enableColumnReorder,m=t.isDragOver,p=t.sortKey,v=t.sortDir,y=t.hasFilter,C=t.anchorRef,b=t.anchorRefForCallout,w=t.calloutKey,x=t.resizingColumn,k=t.onRenderHeader,S=t.onColumnHeaderClick,R=t.onHeaderMouseEnter,I=t.onHeaderMouseLeave,M=t.onCalloutMouseEnter,N=t.onCalloutMouseLeave,P=t.onColumnDragStart,E=t.onColumnDragOver,D=t.onColumnDrop,K=t.onResizeStart,L=t.onSortAsc,T=t.onSortDesc,A=t.onFilter,O=t.onClearFilter,_=t.onPinLeft,F=t.onPinRight,B=t.onUnpin,H=t.onToggleVisibility,z=t.onGroupBy,V=t.isGrouped,U=t.enableColumnVisibility,W=t.enableGroupBy,G=t.enableTotals,j=t.onTotalsChange,q=t.totalsValue,X=t.onDismiss,Y=t.enableCellSelection,Z=void 0!==Y&&Y,J=t.isInRangeColumn,Q=void 0!==J&&J,$=t.isLeftColInRange,ee=void 0!==$&&$,ne=t.isRightColInRange,te=void 0!==ne&&ne,oe=t.isCopied,re=void 0!==oe&&oe,le=String(o.key),ie=r(r(r(r({},o.style),{width:i?"".concat(i,"px"):o.width,minWidth:o.minWidth,maxWidth:o.maxWidth,textAlign:o.align,position:a?"sticky":"relative"}),"left"===a?{left:"".concat(c,"px"),zIndex:f?15:5}:{}),"right"===a?{right:"".concat(u,"px"),zIndex:f?15:5}:{}),ae=o.className?"th-header-cell ".concat(a?"th-header-pinned th-pinned-".concat(a):""," ").concat(o.className):a?"th-header-cell th-header-pinned th-pinned-".concat(a):"th-header-cell",ce=[m?"th-drag-over":"",a?"th-pinned-".concat(a):"","left"===a&&o.key===s?"th-pinned-last-left":"","right"===a&&o.key===d?"th-pinned-first-right":"",Z&&re?"th-cell-copied":""].filter(Boolean).join(" ");return e("th",r({style:ie,draggable:h,onDragStart:function(){return P(o.key)},onDragOver:function(e){return E(e,o.key)},onDrop:function(){return D(o.key)},onDragLeave:function(){},className:ce,"data-in-range-column":Z&&Q?"true":void 0,"data-left-col-in-range":Z&&ee?"true":void 0,"data-right-col-in-range":Z&&te?"true":void 0},{children:[k?k(o,l):e("div",r({className:ae,ref:function(e){C(e)},onMouseEnter:function(){return R(le)},onMouseLeave:I,onClick:function(e){return null==S?void 0:S(o,e)}},{children:[e("span",r({className:"th-header-label"},{children:[o.label,!1!==o.showCallout&&n("span",r({className:"th-header-chevron-icon",role:"presentation","aria-hidden":"true"},{children:n("svg",r({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",fill:"currentColor"},{children:n("path",{d:"M1799 349l242 241-1017 1017L7 590l242-241 775 775 775-775z"})}))}))]})),e("div",r({className:"th-header-icons"},{children:[a&&n("span",r({className:"th-header-pin-icon",title:"Pinned ".concat(a)},{children:n("svg",r({xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 2048 2048",fill:"currentColor"},{children:n("path",{d:"M1990 748q-33 33-64 60t-66 47-73 29-89 11q-34 0-65-6l-379 379q13 38 19 78t6 80q0 65-13 118t-37 100-60 89-79 87l-386-386-568 569-136 45 45-136 569-568-386-386q44-44 86-79t89-59 100-38 119-13q40 0 80 6t78 19l379-379q-6-31-6-65 0-49 10-88t30-74 46-65 61-65l690 690z"})}))})),y&&n("span",r({className:"th-header-filter-icon",title:"Filtered",role:"presentation","aria-hidden":"true"},{children:n("svg",r({xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 2048 2048",fill:"currentColor"},{children:n("path",{d:"M2048 128v219l-768 768v805H768v-805L0 347V128h2048z"})}))})),p===o.key&&n("span",r({className:"th-header-sort-icon"},{children:n("span",r({className:"th-sort-arrow"},"asc"===v?{children:"â†‘"}:{children:"â†“"}))}))]})),n("span",r({className:"th-header-action"},{children:"â‹®"}))]})),!1!==o.resizable&&n("div",{className:"th-resize-handle",onMouseDown:function(e){return K(le,e)},style:{cursor:"col-resize",position:"absolute",right:0,top:0,bottom:0,width:"4px",zIndex:10,userSelect:"none"}}),w===le&&!x&&!1!==o.showCallout&&n(g,{anchorRef:b,onSortAsc:L,onSortDesc:T,onFilter:A,onClearFilter:O,onPinLeft:_,onPinRight:F,onUnpin:B,onToggleVisibility:H,onGroupBy:z,isGrouped:V,onColumnSettings:!(!B&&!U)||void 0,onTotalsChange:j,totalsValue:q,columnLabel:o.label,onDismiss:X,onMouseEnter:M,onMouseLeave:N,sortable:!1!==o.sortable,filterable:!1!==o.filterable,hasFilter:y,pinned:a,visible:!0,enableColumnVisibility:U,enableGroupBy:W,enableTotals:G})]}),le)}function p(t){var o=t.columns,l=t.selectionMode,i=t.isAllSelected,a=t.isIndeterminate,c=t.onSelectAll,u=t.columnWidths,s=t.pinnedColumns,d=t.lastLeftPinnedColumnKey,f=t.firstRightPinnedColumnKey,g=t.stickyHeader,p=t.enableColumnReorder,v=t.dragOverColumn,y=t.sortKey,C=t.sortDir,b=t.filters,w=t.anchorRefs,x=t.calloutKey,k=t.resizingColumn,S=t.onRenderHeader,R=t.onColumnHeaderClick,I=t.onHeaderMouseEnter,M=t.onHeaderMouseLeave,N=t.onCalloutMouseEnter,P=t.onCalloutMouseLeave,E=t.onColumnDragStart,D=t.onColumnDragOver,K=t.onColumnDrop,L=t.onResizeStart,T=t.onSortAsc,A=t.onSortDesc,O=t.onFilter,_=t.onClearFilter,F=t.onPinLeft,B=t.onPinRight,H=t.onUnpin,z=t.onToggleVisibility,V=t.onGroupBy,U=t.currentGroupBy,W=t.enableColumnVisibility,G=t.enableGroupBy,j=t.enableTotals,q=t.onTotalsChange,X=t.columnTotals,Y=t.getLeftOffset,Z=t.getRightOffset,J=t.dismissCallout,Q=t.enableRowActions,$=void 0!==Q&&Q,ee=t.enableCellSelection,ne=void 0!==ee&&ee,te=t.isRangeFromFirstRow,oe=void 0!==te&&te;t.isColumnInRange;var re=t.getColumnRangeInfo,le=t.isCopied,ie=void 0!==le&&le;return n("thead",{children:e("tr",{children:["none"!==l&&n(h,{selectionMode:l,checked:i,indeterminate:a,onChange:function(){},onSelectAll:c}),$&&n("th",r({className:"th-row-actions-column"},{children:n("div",r({className:"th-header-cell"},{children:n("span",{className:"th-header-label"})}))})),o.map(function(e,t){var o=String(e.key),r=u[o],l=s[o]||e.pinned||null,i="left"===l?Y(e,t):0,a="right"===l?Z(e,t):0,c=ne&&oe&&re?re(o):{isInRange:!1,isLeftCol:!1,isRightCol:!1},h=ne&&oe&&ie&&c.isInRange,Q={get current(){return w.current[o]||null},set current(e){}};return n(m,{column:e,columnIndex:t,resizedWidth:r,pinPosition:l,leftOffset:i,rightOffset:a,lastLeftPinnedColumnKey:null!=d?d:void 0,firstRightPinnedColumnKey:null!=f?f:void 0,stickyHeader:g,enableColumnReorder:p,isDragOver:v===e.key,sortKey:y,sortDir:C,hasFilter:!!(b[o]&&b[o].length>0),anchorRef:function(e){e&&(w.current[o]=e)},anchorRefForCallout:Q,calloutKey:x===e.key?o:null,resizingColumn:k,onRenderHeader:S,onColumnHeaderClick:R,onHeaderMouseEnter:I,onHeaderMouseLeave:M,onCalloutMouseEnter:N,onCalloutMouseLeave:P,onColumnDragStart:E,onColumnDragOver:D,onColumnDrop:K,onResizeStart:L,enableCellSelection:ne,isInRangeColumn:c.isInRange,isLeftColInRange:c.isLeftCol,isRightColInRange:c.isRightCol,isCopied:h,onSortAsc:function(){!1!==e.sortable&&(T(e),J())},onSortDesc:function(){!1!==e.sortable&&(A(e),J())},onFilter:function(){!1!==e.filterable&&O(e)},onClearFilter:function(){!1!==e.filterable&&(_(e),J())},onPinLeft:function(){F(e),J()},onPinRight:function(){B(e),J()},onUnpin:function(){H(e),J()},onToggleVisibility:function(){W&&(z(e),J())},onGroupBy:function(){V(e),J()},isGrouped:U===e.key,enableColumnVisibility:W,enableGroupBy:G,enableTotals:j,onTotalsChange:function(n){q(e,n),J()},totalsValue:X[o]||"none",onDismiss:J},o)})]})})}function v(t){var o=t.groupKey,l=t.groupLabel,i=t.rowCount,a=t.isExpanded,c=t.onToggle,u=t.colSpan;return n("tr",r({className:"th-group-header"},{children:n("td",r({colSpan:u,className:"th-group-header-cell"},{children:e("button",r({className:"th-group-toggle",onClick:c,"aria-expanded":a},{children:[n("svg",r({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:a?"expanded":""},{children:n("path",{d:"M6 4L10 8L6 12",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})),e("span",r({className:"th-group-label"},{children:[l,": ",o]})),e("span",r({className:"th-group-count"},{children:["(",i,")"]}))]}))}))}))}function y(e){var t=e.column,o=e.item,l=e.index,i=e.resizedWidth,a=e.pinPosition,c=e.leftOffset,u=e.rightOffset,s=e.lastLeftPinnedColumnKey,d=e.firstRightPinnedColumnKey,f=e.showTooltip,h=e.onDoubleClick,g=e.renderCell,m=e.getCellText,p=e.isSelected,v=void 0!==p&&p,y=e.isRangeStart,C=void 0!==y&&y,b=e.isRangeEnd,w=void 0!==b&&b,x=e.isInRange,k=void 0!==x&&x,S=e.isTopRow,R=void 0!==S&&S,I=e.isBottomRow,M=void 0!==I&&I,N=e.isLeftCol,P=void 0!==N&&N,E=e.isRightCol,D=void 0!==E&&E,K=e.isInRangeColumn,L=void 0!==K&&K,T=e.isLeftColInRange,A=void 0!==T&&T,O=e.isRightColInRange,_=void 0!==O&&O,F=e.isCopied,B=void 0!==F&&F,H=e.isFocused,z=void 0!==H&&H,V=e.rowIndex,U=e.colKey,W=e.onMouseDown,G=e.onMouseEnter,j=e.onMouseUp,q=e.enableCellSelection,X=void 0!==q&&q,Y=String(t.key),Z=r(r(r(r({},t.cellStyle),{textAlign:t.align,width:i?"".concat(i,"px"):t.width,position:a?"sticky":"relative"}),"left"===a?{left:"".concat(c,"px"),zIndex:3}:{}),"right"===a?{right:"".concat(u,"px"),zIndex:3}:{}),J=[t.cellClassName,t.editable?"th-cell-editable":"",a?"th-cell-pinned th-pinned-".concat(a):"","left"===a&&t.key===s?"th-pinned-last-left":"","right"===a&&t.key===d?"th-pinned-first-right":"",X&&v?"th-cell-selected":"",X&&z?"th-cell-focused":"",X&&C?"th-cell-range-start":"",X&&w?"th-cell-range-end":"",X&&k?"th-cell-in-range":"",X&&R?"th-cell-range-top":"",X&&M?"th-cell-range-bottom":"",X&&P?"th-cell-range-left":"",X&&D?"th-cell-range-right":"",X&&B?"th-cell-copied":"",f?"th-cell-with-tooltip":"th-cell-no-tooltip"].filter(Boolean).join(" "),Q=f&&m?m(o,t):void 0;return n("td",r({style:Z,className:J,onDoubleClick:h,title:Q||void 0,onMouseDown:X?W:void 0,onMouseEnter:X?G:void 0,onMouseUp:X?j:void 0,"data-in-range-column":X&&L?"true":void 0,"data-left-col-in-range":X&&A?"true":void 0,"data-right-col-in-range":X&&_?"true":void 0,"data-row-index":X&&void 0!==V?V:void 0,"data-col-key":X&&U?U:void 0},{children:g(o,t,l)}),Y)}function C(t){var o=t.item,l=t.index,i=t.actions,a=t.onMenuToggle,c=t.isMenuOpen,u=t.buttonRef;return i&&0!==i.length?n("td",r({className:"th-row-actions-column"},{children:n("button",r({ref:u,type:"button",className:"th-row-actions-button ".concat(c?"th-row-actions-button-active":""),onClick:function(e){e.preventDefault(),e.stopPropagation(),a(o,l)},onContextMenu:function(e){e.preventDefault(),e.stopPropagation()},"aria-label":"Row actions","aria-haspopup":"true","aria-expanded":c},{children:e("svg",r({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block"}},{children:[n("circle",{cx:"4",cy:"8",r:"1.5",fill:"currentColor"}),n("circle",{cx:"8",cy:"8",r:"1.5",fill:"currentColor"}),n("circle",{cx:"12",cy:"8",r:"1.5",fill:"currentColor"})]}))}))})):n("td",{className:"th-row-actions-column"})}function b(t){var l=t.anchorRef,i=t.actions,a=t.item,c=t.index,u=t.onDismiss,s=t.onMouseEnter,d=t.onMouseLeave,f=o.useRef(null);if(o.useEffect(function(){var e=function(e){f.current&&!f.current.contains(e.target)&&l.current&&!l.current.contains(e.target)&&u()},n=function(e){"Escape"===e.key&&u()};return document.addEventListener("mousedown",e),document.addEventListener("keydown",n),function(){document.removeEventListener("mousedown",e),document.removeEventListener("keydown",n)}},[u,l]),!l.current||0===i.length)return null;var h=l.current.getBoundingClientRect(),g=32*i.length+8,m=window.innerHeight-h.bottom,p=h.top,v=m<g&&p>m?h.top-g-4:h.bottom+4;return n("div",r({ref:f,className:"th-row-actions-menu",style:{position:"fixed",top:"".concat(v,"px"),left:"".concat(h.left,"px"),zIndex:1e3},onMouseEnter:s,onMouseLeave:d},{children:i.map(function(t){return e("button",r({className:"th-row-actions-menu-item ".concat(t.disabled?"th-row-actions-menu-item-disabled":""),onClick:function(){return function(e){e.disabled||(e.onClick(a,c),u())}(t)},disabled:t.disabled},{children:[t.icon&&n("span",r({className:"th-row-actions-menu-icon"},{children:t.icon})),n("span",r({className:"th-row-actions-menu-text"},{children:t.label}))]}),t.key)})}))}function w(l){var i=l.item,a=l.index,c=l.itemKey,u=l.columns,s=l.selectionMode,d=l.isSelected,f=l.isActive,g=l.isFocused,m=void 0!==g&&g,p=l.isDragging,v=void 0!==p&&p,w=l.isDragOver,x=void 0!==w&&w,k=l.canDrag,S=l.columnWidths,R=l.pinnedColumns,I=l.lastLeftPinnedColumnKey,M=l.firstRightPinnedColumnKey,N=l.showTooltip,P=l.onItemClick,E=l.onItemContextMenu,D=l.onCheckboxChange,K=l.onCellEditStart,L=l.onDragStart,T=l.onDragOver,A=l.onDragLeave,O=l.onDrop,_=l.onDragEnd,F=l.renderCell,B=l.getCellText,H=l.getLeftOffset,z=l.getRightOffset,V=l.isDraggingState,U=l.rowActions,W=l.openMenuKey,G=l.onMenuToggle,j=l.onMenuDismiss,q=l.enableCellSelection,X=void 0!==q&&q,Y=l.cellSelectionIndex,Z=l.isCellSelected,J=l.getCellRangeInfo,Q=l.isRowAboveRange,$=void 0!==Q&&Q;l.isColumnInRange;var ee=l.getColumnRangeInfo,ne=l.onCellMouseDown,te=l.onCellMouseEnter,oe=l.onCellMouseUp,re=[d?"th-row-selected":"",!X&&f?"th-row-active":"",!X&&m?"th-row-focused":"",k?"th-row-draggable":"",v?"th-row-dragging":"",x?"th-row-drag-over":"",X&&$?"th-row-above-range":""].filter(Boolean).join(" "),le=U?U(i,a):[],ie=W===o.useMemo(function(){return"".concat(String(c),"-").concat(a)},[c,a]),ae=o.useRef(null);return e(t,{children:[e("tr",r({className:re,draggable:k,onDragStart:function(e){return L(e,a)},onDragOver:function(e){return T(e,a)},onDragLeave:A,onDrop:function(e){return O(e,a)},onDragEnd:_,onClick:function(e){V||X||P(i,a,e)},onContextMenu:function(e){return null==E?void 0:E(i,a,e)}},{children:["none"!==s&&n(h,{selectionMode:s,checked:d,onChange:function(e){return D(i,a,e)}}),le.length>0&&n(C,{item:i,index:a,actions:le,onMenuToggle:G,isMenuOpen:ie,buttonRef:ae}),u.map(function(e,t){var o,r,l=String(e.key),c=S[l],s=R[l]||e.pinned||null,d=u.findIndex(function(e){return String(e.key)===l}),f="left"===s?H(e,d):0,h="right"===s?z(e,d):0,g=void 0!==Y?Y:a,m=!(!X||!Z)&&Z(g,l),p=X&&J?J(g,l):{isStart:!1,isEnd:!1,isInRange:!1,isTopRow:!1,isBottomRow:!1,isLeftCol:!1,isRightCol:!1,isCopied:!1,isFocused:!1},v=null!==(o=p.isCopied)&&void 0!==o&&o,C=null!==(r=p.isFocused)&&void 0!==r&&r,b=X&&$&&ee?ee(l):{isInRange:!1,isLeftCol:!1,isRightCol:!1},w=b.isInRange;return n(y,{column:e,item:i,index:a,resizedWidth:c,pinPosition:s,leftOffset:f,rightOffset:h,lastLeftPinnedColumnKey:I,firstRightPinnedColumnKey:M,showTooltip:N,onDoubleClick:function(){return K(i,e,a)},renderCell:F,getCellText:B,enableCellSelection:X,isSelected:m,isFocused:C,isRangeStart:p.isStart,isRangeEnd:p.isEnd,isInRange:p.isInRange,isTopRow:p.isTopRow,isBottomRow:p.isBottomRow,isLeftCol:p.isLeftCol,isRightCol:p.isRightCol,isInRangeColumn:w,isLeftColInRange:b.isLeftCol,isRightColInRange:b.isRightCol,isCopied:v,rowIndex:g,colKey:l,onMouseDown:X&&ne?function(e){return ne(g,l,e)}:void 0,onMouseEnter:X&&te?function(e){return te(g,l,e)}:void 0,onMouseUp:X&&oe?function(e){return oe(g,l,e)}:void 0},l)})]}),c),ie&&le.length>0&&n(b,{anchorRef:ae,actions:le,item:i,index:a,onDismiss:j})]})}function x(t){var r=t.data,l=t.columns,i=t.paginatedGroups,a=t.currentGroupBy,c=t.expandedGroups,u=t.selectionMode,s=t.selectedItems,d=t.activeItemIndex,f=t.focusedRowIndex,h=t.enableRowReorder,g=t.draggedRowIndex,m=t.dragOverRowIndex,p=t.isDragging,y=t.columnWidths,C=t.pinnedColumns,b=t.lastLeftPinnedColumnKey,x=t.firstRightPinnedColumnKey,k=t.showTooltip,S=t.onRenderRow,R=t.getItemKey,I=t.onItemClick,M=t.onItemContextMenu,N=t.onCheckboxChange,P=t.onCellEditStart,E=t.onRowDragStart,D=t.onRowDragOver,K=t.onRowDragLeave,L=t.onRowDrop,T=t.onRowDragEnd,A=t.renderCell,O=t.getCellText,_=t.getLeftOffset,F=t.getRightOffset,B=t.toggleGroup,H=t.filteredData,z=t.pagedData,V=t.rowActions,U=t.openMenuKey,W=t.onMenuToggle,G=t.onMenuDismiss,j=t.enableCellSelection,q=void 0!==j&&j,X=t.isCellSelected,Y=t.getCellRangeInfo,Z=t.isRowAboveRange,J=t.isColumnInRange,Q=t.getColumnRangeInfo,$=t.onCellMouseDown,ee=t.onCellMouseEnter,ne=t.onCellMouseUp,te=a?l.find(function(e){return e.key===a}):null,oe=(null==te?void 0:te.label)||(a?String(a):"");return n("tbody",{children:a&&i?i.map(function(t){var i=t[0],f=t[1],j=c.has(i);return e(o.Fragment,{children:[n(v,{groupKey:i,groupLabel:oe,rowCount:f.length,isExpanded:j,onToggle:function(){return B(i)},colSpan:l.length+("none"!==u?1:0)+(V?1:0)}),j&&f.map(function(e,t){var i=r.findIndex(function(n){return n===e}),c=i>=0?i:H.findIndex(function(n){return n===e}),f=i>=0?i:c>=0?c:t,v=z.findIndex(function(n){return n===e}),B=v>=0?v:t,j=R(e,f),te=s.has(j),oe=i>=0&&d===i,re=H.findIndex(function(n){return n===e}),le=re>=0?re:f,ie=h&&!a;return S?n(o.Fragment,{children:S(e,f,l)},j):n(w,{item:e,index:f,itemKey:j,columns:l,selectionMode:u,isSelected:te,isActive:oe,isFocused:!1,isDragging:g===le,isDragOver:m===le,canDrag:ie,columnWidths:y,pinnedColumns:C,lastLeftPinnedColumnKey:b,firstRightPinnedColumnKey:x,showTooltip:k,onItemClick:I,onItemContextMenu:M,onCheckboxChange:N,onCellEditStart:P,onDragStart:E,onDragOver:D,onDragLeave:K,onDrop:L,onDragEnd:T,renderCell:A,getCellText:O,getLeftOffset:_,getRightOffset:F,isDraggingState:p,rowActions:V,openMenuKey:U,onMenuToggle:W,onMenuDismiss:G,enableCellSelection:q,cellSelectionIndex:B,isCellSelected:X,getCellRangeInfo:Y,isRowAboveRange:!!Z&&Z(B),isColumnInRange:J,getColumnRangeInfo:Q,onCellMouseDown:$,onCellMouseEnter:ee,onCellMouseUp:ne},j)})]},i)}):z.map(function(e,t){var r=R(e,t),i=s.has(r),c=d===t,v=H.findIndex(function(n){return n===e}),B=v>=0?v:t,z=h&&!a;return S?n(o.Fragment,{children:S(e,t,l)},r):n(w,{item:e,index:t,itemKey:r,columns:l,selectionMode:u,isSelected:i,isActive:c,isFocused:f===t,isDragging:g===B,isDragOver:m===B,canDrag:z,columnWidths:y,pinnedColumns:C,lastLeftPinnedColumnKey:b,firstRightPinnedColumnKey:x,showTooltip:k,onItemClick:I,onItemContextMenu:M,onCheckboxChange:N,onCellEditStart:P,onDragStart:E,onDragOver:D,onDragLeave:K,onDrop:L,onDragEnd:T,renderCell:A,getCellText:O,getLeftOffset:_,getRightOffset:F,isDraggingState:p,rowActions:V,openMenuKey:U,onMenuToggle:W,onMenuDismiss:G,enableCellSelection:q,cellSelectionIndex:t,isCellSelected:X,getCellRangeInfo:Y,isRowAboveRange:!!Z&&Z(t),isColumnInRange:J,getColumnRangeInfo:Q,onCellMouseDown:$,onCellMouseEnter:ee,onCellMouseUp:ne},r)})})}function k(t){var o=t.columns,l=t.selectionMode,i=t.columnTotals,a=t.pinnedColumns,c=t.columnWidths,u=t.lastLeftPinnedColumnKey,s=t.firstRightPinnedColumnKey,d=t.totalCount,f=t.getLeftOffset,h=t.getRightOffset;return Object.values(i).some(function(e){return"count"===e})?n("tfoot",r({className:"th-totals-sticky"},{children:e("tr",r({className:"th-totals-row"},{children:["none"!==l&&n("td",{className:"th-selection-column"}),o.map(function(e){var t=String(e.key),l=i[t]||"none",g=a[t]||e.pinned||null,m=o.findIndex(function(e){return String(e.key)===t}),p="left"===g?f(e,m):0,v="right"===g?h(e,m):0,y=c[t],C=r(r({textAlign:e.align,width:y?"".concat(y,"px"):e.width,position:g?"sticky":"relative"},"left"===g?{left:"".concat(p,"px"),zIndex:11}:{}),"right"===g?{right:"".concat(v,"px"),zIndex:11}:{}),b=[g?"th-cell-pinned th-pinned-".concat(g):"","left"===g&&e.key===u?"th-pinned-last-left":"","right"===g&&e.key===s?"th-pinned-first-right":""].filter(Boolean).join(" "),w="";return"count"===l&&(w="Count: ".concat(d.toLocaleString())),n("td",r({style:C,className:b},{children:w}),t)})]}))})):null}function S(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function R(e,n,t,o){void 0===o&&(o="export"),"csv"===e?function(e,n,t){void 0===t&&(t="export");var o=a([n.map(function(e){return e.label}).join(",")],e.map(function(e){return n.map(function(n){var t=e[n.key];if(null==t)return"";var o=String(t);return o.includes(",")||o.includes('"')||o.includes("\n")?'"'.concat(o.replace(/"/g,'""'),'"'):o}).join(",")}),!0).join("\n"),r=new Blob(["\ufeff"+o],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),i=URL.createObjectURL(r);l.setAttribute("href",i),l.setAttribute("download","".concat(t,".csv")),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i)}(n,t,o):function(e,n,t){void 0===t&&(t="export");var o=n.map(function(e){return e.label}),r=e.map(function(e){return n.map(function(n){var t=e[n.key];return null==t?"":t})}),l='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n';l+="<head>\n",l+='<meta charset="utf-8">\n',l+="\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Sheet1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e\n",l+="</head>\n",l+="<body>\n",l+="<table>\n",l+="<tr>\n",o.forEach(function(e){l+="<th>".concat(S(String(e)),"</th>\n")}),l+="</tr>\n",r.forEach(function(e){l+="<tr>\n",e.forEach(function(e){var n=null==e?"":String(e);l+="number"==typeof e?'<td style="mso-number-format:General">'.concat(n,"</td>\n"):"<td>".concat(S(n),"</td>\n")}),l+="</tr>\n"}),l+="</table>\n",l+="</body>\n",l+="</html>";var i=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=document.createElement("a"),c=URL.createObjectURL(i);a.setAttribute("href",c),a.setAttribute("download","".concat(t,".xlsx")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(c)}(n,t,o)}function I(t){var l=t.data,i=t.columns,a=t.format,c=t.filename,u=t.onBeforeExport,s=t.onAfterExport,d=o.useState(!1),f=d[0],h=d[1],g=o.useCallback(function(e){h(!0);try{var n=i.filter(function(e){return e.key&&e.label}).map(function(e){return{key:e.key,label:e.label}}),t=l;if(u){var o=u(l,i);if(o)R(e,t=o.data,o.columns.filter(function(e){return e.key&&e.label}).map(function(e){return{key:e.key,label:e.label}}),c);else R(e,t,n,c)}else R(e,t,n,c);null==s||s(e,c)}catch(e){console.error("Export failed:",e)}finally{h(!1)}},[l,i,c,u,s]);return"both"===a?e("div",r({className:"th-export-buttons"},{children:[e("button",r({className:"th-export-button",onClick:function(){return g("csv")},disabled:f,title:"Export to CSV"},{children:[n("svg",r({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:n("path",{d:"M2 2h12v12H2V2zm1 1v10h10V3H3zm1 1h8v1H4V4zm0 2h8v1H4V6zm0 2h8v1H4V8zm0 2h5v1H4v-1z",fill:"currentColor"})})),n("span",{children:"CSV"})]})),e("button",r({className:"th-export-button",onClick:function(){return g("excel")},disabled:f,title:"Export to Excel"},{children:[n("svg",r({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:n("path",{d:"M2 2h12v12H2V2zm1 1v10h10V3H3zm1 1h8v1H4V4zm0 2h8v1H4V6zm0 2h8v1H4V8zm0 2h5v1H4v-1z",fill:"currentColor"})})),n("span",{children:"Excel"})]}))]})):e("button",r({className:"th-export-button",onClick:function(){return g(a)},disabled:f,title:"Export to ".concat("csv"===a?"CSV":"Excel")},{children:[n("svg",r({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:n("path",{d:"M2 2h12v12H2V2zm1 1v10h10V3H3zm1 1h8v1H4V4zm0 2h8v1H4V6zm0 2h8v1H4V8zm0 2h5v1H4v-1z",fill:"currentColor"})})),n("span",{children:"csv"===a?"CSV":"Excel"})]}))}var M={mode:"light",colors:{background:"#ffffff",surface:"#ffffff",headerBackground:"#faf9f8",rowBackground:"#ffffff",rowBackgroundAlternate:"#f9f9f9",selectedRowBackground:"#edebe9",hoverRowBackground:"#f3f2f1",groupHeaderBackground:"#f3f2f1",text:"#323130",textSecondary:"#605e5c",headerText:"#323130",rowText:"#323130",selectedRowText:"#323130",border:"#edebe9",borderLight:"#f1f1f1",rowBorder:"#f1f1f1",focus:"#107c10",focusBorder:"#107c10",hover:"#f3f2f1",active:"#edebe9",disabled:"#a19f9d",primary:"#107c10",success:"#107c10",warning:"#ffaa44",error:"#d13438"},spacing:{cellPadding:"10px 12px",headerPadding:"10px 12px",rowHeight:"auto",rowHeightCompact:"32px",rowHeightSpacious:"56px",gap:"8px"},typography:{fontFamily:'"Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif',fontSize:"14px",fontSizeSmall:"12px",fontSizeLarge:"16px",fontWeight:"400",fontWeightBold:"600",lineHeight:"20px"},borderRadius:{table:"8px",cell:"0",button:"2px"},shadows:{table:"0 2px 8px rgba(0,0,0,0.08)",header:"none",callout:"0 3.2px 7.2px rgba(0, 0, 0, 0.132), 0 0.6px 1.8px rgba(0, 0, 0, 0.108)",panel:"-2px 0 8px rgba(0, 0, 0, 0.15), -1px 0 2px rgba(0, 0, 0, 0.1)"},transitions:{duration:"0.1s",easing:"cubic-bezier(0.1, 0.9, 0.2, 1)"}},N={mode:"dark",colors:{background:"#1a1a1a",surface:"#252526",headerBackground:"#2d2d30",rowBackground:"#252526",rowBackgroundAlternate:"#2d2d30",selectedRowBackground:"#3e3e42",hoverRowBackground:"#2d2d30",groupHeaderBackground:"#2d2d30",text:"#cccccc",textSecondary:"#858585",headerText:"#cccccc",rowText:"#cccccc",selectedRowText:"#ffffff",border:"#3e3e42",borderLight:"#2d2d30",rowBorder:"#3e3e42",focus:"#4ec9b0",focusBorder:"#4ec9b0",hover:"#2d2d30",active:"#3e3e42",disabled:"#858585",primary:"#4ec9b0",success:"#4ec9b0",warning:"#dcdcaa",error:"#f48771"},spacing:{cellPadding:"10px 12px",headerPadding:"10px 12px",rowHeight:"auto",rowHeightCompact:"32px",rowHeightSpacious:"56px",gap:"8px"},typography:{fontFamily:'"Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif',fontSize:"14px",fontSizeSmall:"12px",fontSizeLarge:"16px",fontWeight:"400",fontWeightBold:"600",lineHeight:"20px"},borderRadius:{table:"8px",cell:"0",button:"2px"},shadows:{table:"0 2px 8px rgba(0,0,0,0.3)",header:"none",callout:"0 3.2px 7.2px rgba(0, 0, 0, 0.4), 0 0.6px 1.8px rgba(0, 0, 0, 0.3)",panel:"-2px 0 8px rgba(0, 0, 0, 0.4), -1px 0 2px rgba(0, 0, 0, 0.3)"},transitions:{duration:"0.1s",easing:"cubic-bezier(0.1, 0.9, 0.2, 1)"}};function P(e){if(!e)return M;if("string"==typeof e)return"dark"===e?N:M;var n="dark"===e.mode?N:M;return r(r(r({},n),e),{colors:r(r({},n.colors),e.colors),spacing:e.spacing?r(r({},n.spacing),e.spacing):n.spacing,typography:e.typography?r(r({},n.typography),e.typography):n.typography,borderRadius:e.borderRadius?r(r({},n.borderRadius),e.borderRadius):n.borderRadius,shadows:e.shadows?r(r({},n.shadows),e.shadows):n.shadows,transitions:e.transitions?r(r({},n.transitions),e.transitions):n.transitions})}function E(e){var n=e.colors,t=e.spacing,o=e.typography,r=e.borderRadius,l=e.shadows,i=e.transitions;return{"--th-color-background":n.background,"--th-color-surface":n.surface,"--th-color-header-background":n.headerBackground,"--th-color-row-background":n.rowBackground,"--th-color-row-background-alternate":n.rowBackgroundAlternate,"--th-color-selected-row-background":n.selectedRowBackground,"--th-color-hover-row-background":n.hoverRowBackground,"--th-color-group-header-background":n.groupHeaderBackground,"--th-color-text":n.text,"--th-color-text-secondary":n.textSecondary,"--th-color-header-text":n.headerText,"--th-color-row-text":n.rowText,"--th-color-selected-row-text":n.selectedRowText,"--th-color-border":n.border,"--th-color-border-light":n.borderLight,"--th-color-row-border":n.rowBorder,"--th-color-focus":n.focus,"--th-color-focus-border":n.focusBorder,"--th-color-hover":n.hover,"--th-color-active":n.active,"--th-color-disabled":n.disabled,"--th-color-primary":n.primary,"--th-color-success":n.success,"--th-color-warning":n.warning,"--th-color-error":n.error,"--th-spacing-cell-padding":null==t?void 0:t.cellPadding,"--th-spacing-header-padding":null==t?void 0:t.headerPadding,"--th-spacing-row-height":null==t?void 0:t.rowHeight,"--th-spacing-row-height-compact":null==t?void 0:t.rowHeightCompact,"--th-spacing-row-height-spacious":null==t?void 0:t.rowHeightSpacious,"--th-spacing-gap":null==t?void 0:t.gap,"--th-typography-font-family":null==o?void 0:o.fontFamily,"--th-typography-font-size":null==o?void 0:o.fontSize,"--th-typography-font-size-small":null==o?void 0:o.fontSizeSmall,"--th-typography-font-size-large":null==o?void 0:o.fontSizeLarge,"--th-typography-font-weight":null==o?void 0:o.fontWeight,"--th-typography-font-weight-bold":null==o?void 0:o.fontWeightBold,"--th-typography-line-height":null==o?void 0:o.lineHeight,"--th-border-radius-table":null==r?void 0:r.table,"--th-border-radius-cell":null==r?void 0:r.cell,"--th-border-radius-button":null==r?void 0:r.button,"--th-shadow-table":null==l?void 0:l.table,"--th-shadow-header":null==l?void 0:l.header,"--th-shadow-callout":null==l?void 0:l.callout,"--th-shadow-panel":null==l?void 0:l.panel,"--th-transition-duration":null==i?void 0:i.duration,"--th-transition-easing":null==i?void 0:i.easing}}function D(t){var h=t.columns,g=t.data,m=t.itemsPerPage,v=void 0===m?10:m,y=t.groupBy,C=t.onRenderCell,b=t.onRenderRow,w=t.onRenderHeader;t.onItemInvoked;var S=t.onColumnHeaderClick,R=t.getKey,M=t.onActiveItemChanged,N=t.onItemContextMenu,D=t.className,K=t.styles,L=t.selectionMode,T=void 0===L?"none":L,A=t.onSelectionChanged,O=t.showPagination,_=void 0===O||O,F=t.itemsPerPageOptions,B=t.onItemsPerPageChange,H=t.theme,z=t.maxHeight,V=t.onCellEdit,U=t.pinnedColumns,W=t.onColumnPin,G=t.showTooltip,j=void 0===G||G,q=t.loading,X=void 0!==q&&q,Y=t.onRenderLoading,Z=t.emptyMessage,J=t.onRenderEmpty,Q=t.stickyHeader,$=void 0!==Q&&Q,ee=t.enableColumnVisibility,ne=t.onColumnVisibilityChange,te=t.enableColumnReorder,oe=t.onColumnReorder,re=t.enableKeyboardNavigation,le=void 0===re||re,ie=t.enableRowReorder,ae=void 0!==ie&&ie,ce=t.onRowReorder,ue=t.enableExport,se=void 0!==ue&&ue,de=t.exportFormat,fe=void 0===de?"both":de,he=t.exportFileName,ge=void 0===he?"export":he,me=t.onBeforeExport,pe=t.onAfterExport,ve=t.rowActions,ye=t.enableCellSelection,Ce=void 0!==ye&&ye;!function(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(t[o[r]]=e[o[r]])}}(t,["columns","data","itemsPerPage","groupBy","onRenderCell","onRenderRow","onRenderHeader","onItemInvoked","onColumnHeaderClick","getKey","onActiveItemChanged","onItemContextMenu","className","styles","selectionMode","onSelectionChanged","showPagination","itemsPerPageOptions","onItemsPerPageChange","theme","maxHeight","onCellEdit","pinnedColumns","onColumnPin","showTooltip","loading","onRenderLoading","emptyMessage","onRenderEmpty","stickyHeader","enableColumnVisibility","onColumnVisibilityChange","enableColumnReorder","onColumnReorder","enableKeyboardNavigation","enableRowReorder","onRowReorder","enableExport","exportFormat","exportFileName","onBeforeExport","onAfterExport","rowActions","enableCellSelection"]);var be=o.useState(v),we=be[0],xe=be[1],ke=o.useState(g),Se=ke[0],Re=ke[1];o.useEffect(function(){Re(g)},[g]),o.useEffect(function(){xe(v)},[v]);var Ie=_?F||[10,25,50,100]:F,Me=o.useCallback(function(e){xe(e),null==B||B(e)},[B]),Ne=_?we:Number.MAX_SAFE_INTEGER,Pe=Se,Ee=c(Pe,Ne),De=o.useRef({}),Ke=o.useRef(null),Le=o.useState({}),Te=Le[0],Ae=Le[1],Oe=o.useState(null),_e=Oe[0],Fe=Oe[1],Be=o.useState(null),He=Be[0],ze=Be[1],Ve=o.useState(y),Ue=Ve[0],We=Ve[1];o.useEffect(function(){void 0!==y&&We(y)},[y]);var Ge=void 0!==y?y:Ue,je=o.useState(new Set),qe=je[0],Xe=je[1],Ye=o.useMemo(function(){return{key:"__rowNumber__",label:"STT",width:"80px",align:"center",sortable:!1,filterable:!1,resizable:!1,editable:!1,pinned:"left",showCallout:!1,onRenderCell:function(e,n,t){return(Ee.currentPage-1)*Ee.itemsPerPage+t+1}}},[Ee.currentPage,Ee.itemsPerPage]),Ze=function(e,n,t,l,i,c,u){var s=o.useState(n||{}),d=s[0],f=s[1],h=o.useState(new Set(e.map(function(e){return e.key}))),g=h[0],m=h[1],p=o.useState(e.map(function(e){return e.key})),v=p[0],y=p[1],C=o.useState(null),b=C[0],w=C[1],x=o.useState(null),k=x[0],S=x[1];o.useEffect(function(){t&&l&&l(Array.from(g))},[g,t,l]),o.useEffect(function(){i&&c&&c(v)},[v,i,c]);var R=o.useCallback(function(e){m(function(n){var t=new Set(n);return t.has(e)?t.delete(e):t.add(e),t})},[]),I=o.useCallback(function(e,n){f(function(t){var o=r({},t);return null===n?delete o[String(e)]:o[String(e)]=n,o}),null==u||u(e,n)},[u]),M=o.useCallback(function(e){i&&w(e)},[i]),N=o.useCallback(function(e,n){i&&b&&b!==n&&(e.preventDefault(),S(n))},[i,b]),P=o.useCallback(function(e){i&&b&&b!==e&&(y(function(n){var t=a([],n,!0),o=t.indexOf(b),r=t.indexOf(e);return t.splice(o,1),t.splice(r,0,b),t}),w(null),S(null))},[i,b]),E=o.useMemo(function(){return t?e.filter(function(e){return g.has(e.key)}):e},[e,g,t]),D=o.useMemo(function(){if(!i)return E;var e=new Map(v.map(function(e,n){return[e,n]}));return a([],E,!0).sort(function(n,t){var o,r;return(null!==(o=e.get(n.key))&&void 0!==o?o:1/0)-(null!==(r=e.get(t.key))&&void 0!==r?r:1/0)})},[E,v,i]),K=o.useMemo(function(){var e=[],n=[],t=[];return D.forEach(function(o){var r=d[String(o.key)]||o.pinned||null;"left"===r?e.push(o):"right"===r?t.push(o):n.push(o)}),a(a(a([],e,!0),n,!0),t,!0)},[D,d]);return{internalPinnedColumns:d,visibleColumns:g,columnOrder:v,draggedColumn:b,dragOverColumn:k,sortedColumns:K,handleToggleColumnVisibility:R,handleColumnPin:I,handleColumnDragStart:M,handleColumnDragOver:N,handleColumnDrop:P}}(o.useMemo(function(){if(Ce&&!h.some(function(e){return"__rowNumber__"===String(e.key)}))return a([Ye],h,!0);return h},[Ce,h,Ye]),U,ee,ne,te,oe,W),Je=Ze.internalPinnedColumns,Qe=Ze.dragOverColumn,$e=Ze.sortedColumns,en=Ze.handleToggleColumnVisibility,nn=Ze.handleColumnPin,tn=Ze.handleColumnDragStart,on=Ze.handleColumnDragOver,rn=Ze.handleColumnDrop,ln=function(e,n,t,r,l){var i=o.useState(new Set),c=i[0],u=i[1],s=o.useState(void 0),d=s[0],f=s[1],h=o.useCallback(function(e,n){return l?l(e,n):void 0!==e.id?e.id:n},[l]),g=o.useCallback(function(o,l,i){var a=h(o,l);u(function(o){var r=new Set(o);if("single"===n?(r.clear(),i&&r.add(a)):"multiple"===n&&(i?r.add(a):r.delete(a)),t){var l=e.filter(function(e,n){return r.has(h(e,n))});t(l)}return r}),f(l),r&&r(o,l)},[n,h,t,r,e]),m=o.useCallback(function(o,l,i){if(!i.target.closest(".th-selection-checkbox")){if("none"!==n){var a=h(o,l);u(function(o){var r=new Set(o);if("single"===n?(r.clear(),r.add(a)):"multiple"===n&&(i.ctrlKey||i.metaKey?r.has(a)?r.delete(a):r.add(a):(r.clear(),r.add(a))),t){var l=e.filter(function(e,n){return r.has(h(e,n))});t(l)}return r})}f(l),r&&r(o,l)}},[n,h,t,r,e]),p=o.useCallback(function(o){"multiple"===n&&u(function(n){var r=o?new Set(e.map(function(e,n){return h(e,n)})):new Set;if(t){var l=o?a([],e,!0):[];t(l)}return r})},[n,e,h,t]),v=o.useMemo(function(){return"multiple"===n&&0!==e.length&&e.every(function(e,n){return c.has(h(e,n))})},[n,e,c,h]),y=o.useMemo(function(){if("multiple"!==n||0===e.length)return!1;var t=e.filter(function(e,n){return c.has(h(e,n))}).length;return t>0&&t<e.length},[n,e,c,h]),C=o.useCallback(function(e,n){return c.has(h(e,n))},[c,h]);return{selectedItems:c,activeItemIndex:d,isAllSelected:v,isIndeterminate:y,getItemKey:h,handleCheckboxChange:g,handleItemClick:m,handleSelectAll:p,isItemSelected:C,setSelectedItems:u}}(Pe,T,A,M,R),an=ln.selectedItems,cn=ln.activeItemIndex,un=ln.isAllSelected,sn=ln.isIndeterminate,dn=ln.getItemKey,fn=ln.handleCheckboxChange,hn=ln.handleItemClick,gn=ln.handleSelectAll,mn=ln.setSelectedItems,pn=o.useCallback(function(e,n){var t=dn(e,n),o="".concat(String(t),"-").concat(n);ze(function(e){return e===o?null:o})},[dn]),vn=o.useCallback(function(){ze(null)},[]),yn=function(e,n){var t=o.useState({}),l=t[0],i=t[1],a=o.useState(null),c=a[0],u=a[1],s=o.useState(0);s[0];var d=s[1],f=o.useState(0);f[0];var h=f[1],g=o.useCallback(function(n,t){var o,l;t.preventDefault(),t.stopPropagation();var a=String(n),c=null===(l=null===(o=e.current)||void 0===o?void 0:o[a])||void 0===l?void 0:l.parentElement;if(c){var s=c.offsetWidth,f=t.clientX;u(a),document.body.style.cursor="col-resize",document.body.style.userSelect="none",d(f),h(s);var g=function(e){var n=e.clientX-f,t=Math.max(50,s+n);i(function(e){var n;return r(r({},e),((n={})[a]=t,n))})},m=function(){document.body.style.cursor="",document.body.style.userSelect="",u(null),document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",m)};document.addEventListener("mousemove",g),document.addEventListener("mouseup",m)}},[e,n]);return{columnWidths:l,resizingColumn:c,handleResizeStart:g}}(De),Cn=yn.columnWidths,bn=yn.resizingColumn,wn=yn.handleResizeStart,xn=function(e){var n=o.useState(null),t=n[0],r=n[1],l=o.useRef(null),i=o.useCallback(function(n){e||(l.current&&clearTimeout(l.current),l.current=setTimeout(function(){r(n)},150))},[e]),a=o.useCallback(function(){l.current&&clearTimeout(l.current),l.current=setTimeout(function(){r(null)},200)},[]),c=o.useCallback(function(){l.current&&clearTimeout(l.current)},[]),u=o.useCallback(function(){l.current&&clearTimeout(l.current),l.current=setTimeout(function(){r(null)},200)},[]),s=o.useCallback(function(){l.current&&clearTimeout(l.current),r(null)},[]);return o.useEffect(function(){return function(){l.current&&clearTimeout(l.current)}},[]),{calloutKey:t,setCalloutKey:r,handleHeaderMouseEnter:i,handleHeaderMouseLeave:a,handleCalloutMouseEnter:c,handleCalloutMouseLeave:u,dismissCallout:s}}(bn),kn=o.useCallback(function(e,n,t,o){Re(function(l){var i,c=a([],l,!0),u=c.findIndex(function(n){return n===e}),s=u>=0?u:o;return s>=0&&s<c.length&&(c[s]=r(r({},c[s]),((i={})[n]=t,i))),c}),null==V||V(e,n,t,o)},[Se]),Sn=function(e){var n=o.useState(null),t=n[0],r=n[1],l=o.useState(""),i=l[0],a=l[1],c=o.useRef(null),u=o.useCallback(function(e,n,t){var o;!0===n.editable&&(r({rowIndex:t,columnKey:n.key}),a(String(null!==(o=e[n.key])&&void 0!==o?o:"")))},[]),s=o.useCallback(function(n,t,o){e&&e(n,t,i,o),r(null),a("")},[e,i]),d=o.useCallback(function(){r(null),a("")},[]);return o.useEffect(function(){t&&c.current&&setTimeout(function(){if(c.current){c.current.focus();var e=c.current.value.length;c.current.setSelectionRange(e,e)}},0)},[t]),{editingCell:t,editValue:i,editInputRef:c,setEditValue:a,handleCellEditStart:u,handleCellEditSave:s,handleCellEditCancel:d}}(kn),Rn=Sn.editingCell,In=Sn.editValue,Mn=Sn.editInputRef,Nn=Sn.setEditValue,Pn=Sn.handleCellEditStart,En=Sn.handleCellEditSave,Dn=Sn.handleCellEditCancel,Kn=o.useCallback(function(e,n,t){"__rowNumber__"!==String(n.key)&&Pn(e,n,t)},[Pn]),Ln=function(e,n,t,r,l){var i=o.useState(null),c=i[0],u=i[1],s=o.useState(null),d=s[0],f=s[1],h=o.useState(!1),g=h[0],m=h[1],p=o.useState(null),v=p[0],y=p[1],C=v||n;o.useEffect(function(){y(null)},[n]);var b=o.useCallback(function(n,t){e?(n.stopPropagation(),m(!0),u(t),n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text/plain",String(t)),n.currentTarget&&(n.currentTarget.style.opacity="0.5")):n.preventDefault()},[e]),w=o.useCallback(function(n,t){e&&null!==c&&(n.preventDefault(),n.dataTransfer.dropEffect="move",d!==t&&f(t))},[e,c,d]),x=o.useCallback(function(n){e&&(n.currentTarget===n.target||n.currentTarget.contains(n.relatedTarget)||f(null))},[e]),k=o.useCallback(function(n,o){if(!e||null===c||c===o)return u(null),void f(null);if(n.preventDefault(),n.stopPropagation(),r)return u(null),void f(null);var i=a([],C,!0),s=t[c],d=t[o],h=i.findIndex(function(e){return e===s}),g=i.findIndex(function(e){return e===d});if(-1===h||-1===g||h===g)return u(null),void f(null);var m=a([],i,!0),p=m[h];m.splice(h,1);var v=h<g?g-1:g;m.splice(v,0,p),y(m),l&&l(m,p,h,v),u(null),f(null)},[e,c,r,t,C,l]),S=o.useCallback(function(n){e&&(n.currentTarget&&(n.currentTarget.style.opacity="1"),m(!1),u(null),f(null),setTimeout(function(){m(!1)},100))},[e]);return{draggedRowIndex:c,dragOverRowIndex:d,isDragging:g,reorderedData:v,effectiveData:C,handleRowDragStart:b,handleRowDragOver:w,handleRowDragLeave:x,handleRowDrop:k,handleRowDragEnd:S}}(ae,Pe,Ee.filtered,Ge,ce),Tn=Ln.draggedRowIndex,An=Ln.dragOverRowIndex,On=Ln.isDragging,_n=Ln.handleRowDragStart,Fn=Ln.handleRowDragOver,Bn=Ln.handleRowDragLeave,Hn=Ln.handleRowDrop,zn=Ln.handleRowDragEnd,Vn=function(e,n,t){void 0===t&&(t=!0);var r=o.useState(new Set),l=r[0],i=r[1],a=o.useState(null),c=a[0],u=a[1],s=o.useState(!1),d=s[0],f=s[1],h=o.useState(null),g=h[0],m=h[1],p=o.useState(!1),v=p[0],y=p[1],C=o.useState(null),b=C[0],w=C[1],x=o.useCallback(function(e,n){return"".concat(e,"-").concat(n)},[]),k=o.useCallback(function(e,t){var o,r,l=Math.min(e.rowIndex,t.rowIndex),i=Math.max(e.rowIndex,t.rowIndex),a=n.findIndex(function(n){return String(n.key)===e.colKey}),c=n.findIndex(function(e){return String(e.key)===t.colKey}),u=a>=0?a:0,s=c>=0?c:n.length-1,d=Math.min(u,s),f=Math.max(u,s);return{start:{rowIndex:l,colKey:String((null===(o=n[Math.max(0,d)])||void 0===o?void 0:o.key)||e.colKey)},end:{rowIndex:i,colKey:String((null===(r=n[Math.min(n.length-1,f)])||void 0===r?void 0:r.key)||t.colKey)}}},[n]),S=o.useCallback(function(e){for(var t=[],o=Math.min(e.start.rowIndex,e.end.rowIndex),r=Math.max(e.start.rowIndex,e.end.rowIndex),l=n.findIndex(function(n){return String(n.key)===e.start.colKey}),i=n.findIndex(function(n){return String(n.key)===e.end.colKey}),a=l>=0?l:0,c=i>=0?i:n.length-1,u=Math.min(a,c),s=Math.max(a,c),d=o;d<=r;d++)for(var f=u;f<=s;f++)n[f]&&t.push({rowIndex:d,colKey:String(n[f].key)});return t},[n]),R=o.useCallback(function(e,n,o){if(t){var r={rowIndex:e,colKey:n};if(m(r),f(!0),o&&c){var l=k(c.start,r);u(l);var a=S(l);i(new Set(a.map(function(e){return x(e.rowIndex,e.colKey)})))}else u({start:r,end:r}),i(new Set([x(e,n)]))}},[t,c,k,S,x]),I=o.useCallback(function(e,n){if(t&&d&&g){var o=k(g,{rowIndex:e,colKey:n});u(o);var r=S(o);i(new Set(r.map(function(e){return x(e.rowIndex,e.colKey)})))}},[t,d,g,k,S,x]),M=o.useCallback(function(){f(!1),m(null)},[]),N=o.useCallback(function(){i(new Set),u(null),f(!1),m(null),y(!1)},[]),P=o.useCallback(function(){w(null)},[]),E=o.useCallback(function(e,n){t&&(w({rowIndex:e,colKey:n}),0===l.size&&R(e,n,!1))},[t,l.size,R]),D=o.useCallback(function(o,r){var l;if(void 0===r&&(r=!1),!t)return null;var a=b;if(!a&&c&&(a=c.end),!a){if(!(e.length>0&&n.length>0))return null;a={rowIndex:0,colKey:String(n[0].key)}}var s=a.rowIndex,d=n.findIndex(function(e){return String(e.key)===a.colKey});if(-1===d)return null;var f=s,h=d,m=e.length-1;switch(o){case"up":f=Math.max(0,s-1);break;case"down":f=Math.min(m,s+1);break;case"left":h=Math.max(0,d-1);break;case"right":h=Math.min(n.length-1,d+1)}var p=String(null===(l=n[h])||void 0===l?void 0:l.key);if(!p)return null;var v={rowIndex:f,colKey:p};if(w(v),r){var y=g||(null==c?void 0:c.start)||a,C=k(y,v);u(C);var I=S(C);i(new Set(I.map(function(e){return x(e.rowIndex,e.colKey)})))}else R(f,p,!1);return v},[t,b,c,g,e,n,k,S,x,R]),K=o.useCallback(function(e){y(e)},[]),L=o.useCallback(function(e,n){if(t){var o=k(e,n);u(o);var r=S(o);i(new Set(r.map(function(e){return x(e.rowIndex,e.colKey)}))),f(!1),m(null)}},[t,k,S,x]),T=o.useCallback(function(e,n){return l.has(x(e,n))},[l,x]),A=o.useCallback(function(){return c?S(c):Array.from(l).map(function(e){var n=e.split("-"),t=n[0],o=n[1];return{rowIndex:parseInt(t,10),colKey:o}})},[c,l,S]),O=o.useCallback(function(){return c},[c]);return{selectedCells:l,selectedRange:c,isSelecting:d,isCopied:v,focusedCell:b,startSelection:R,updateSelection:I,endSelection:M,clearSelection:N,clearFocus:P,setCopied:K,setFocusedCell:E,setSelectionRange:L,moveFocus:D,isCellSelected:T,getSelectedCells:A,getSelectedRange:O}}(Ee.paged,$e,Ce),Un=o.useRef(Ee.currentPage);o.useEffect(function(){Ce&&Un.current!==Ee.currentPage&&(Vn.clearSelection(),Vn.clearFocus(),Un.current=Ee.currentPage)},[Ee.currentPage,Ce,Vn.clearSelection,Vn.clearFocus]);var Wn=function(){var e=this,n=o.useState(null),t=n[0],r=n[1],c=o.useState(!1),u=c[0],s=c[1],d=o.useState([]),f=d[0],h=d[1],g=o.useCallback(function(e,n,t){if(0!==e.length){var o=a([],e,!0).sort(function(e,n){return e.rowIndex!==n.rowIndex?e.rowIndex-n.rowIndex:t.findIndex(function(n){return String(n.key)===e.colKey})-t.findIndex(function(e){return String(e.key)===n.colKey})}),l=new Map;o.forEach(function(e){l.has(e.rowIndex)||l.set(e.rowIndex,[]),l.get(e.rowIndex).push(e)});var i=[];l.forEach(function(e,o){var r=[];e.sort(function(e,n){return t.findIndex(function(n){return String(n.key)===e.colKey})-t.findIndex(function(e){return String(e.key)===n.colKey})}),e.forEach(function(e){var t=n[o];if(t){var l=t[e.colKey];r.push(null!=l?String(l):"")}else r.push("")}),i.push(r)}),r(i),s(!1),h([]);var c=i.map(function(e){return e.join("\t")}).join("\n");navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(c).catch(function(){var e=document.createElement("textarea");e.value=c,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)})}},[]),m=o.useCallback(function(e,n,t){g(e,n,t),s(!0),h(e)},[g]),p=o.useCallback(function(e,n,o,r){if(t&&0!==t.length&&0!==e.length){if(1===t.length&&1===t[0].length){var l=t[0][0];e.forEach(function(e){var t=n[e.rowIndex];t&&r(t,e.colKey,l,e.rowIndex)})}else{var i=e[0];if(!i)return;var a=o.findIndex(function(e){return String(e.key)===i.colKey});if(-1===a)return;t.forEach(function(e,t){var l=i.rowIndex+t;if(!(l<0||l>=n.length)){var c=n[l];c&&e.forEach(function(e,n){var t=a+n;if(!(t<0||t>=o.length)){var i=o[t];if(i)try{r(c,i.key,e,l)}catch(e){}}})}})}u&&f.length>0&&(f.forEach(function(e){var t=n[e.rowIndex];t&&r(t,e.colKey,"",e.rowIndex)}),s(!1),h([]))}},[t,u,f]),v=o.useCallback(function(n,t,o,r){return l(e,void 0,void 0,function(){var e,l,a,c,u,s,d;return i(this,function(i){switch(i.label){case 0:if(0===n.length)return[2,!1];i.label=1;case 1:return i.trys.push([1,5,,6]),e="",navigator.clipboard&&navigator.clipboard.readText?[4,navigator.clipboard.readText()]:[3,3];case 2:return e=i.sent(),[3,4];case 3:return[2,!1];case 4:return e&&0!==e.trim().length?0===(l=e.split(/\r?\n/).filter(function(e){return e.trim().length>0})).length||0===(a=l.map(function(e){for(var n=[],t="",o=!1,r=0;r<e.length;r++){var l=e[r];'"'===l?o&&'"'===e[r+1]?(t+='"',r++):o=!o:"\t"!==l||o?t+=l:(n.push(t),t="")}return n.push(t),n})).length||0===a[0].length?[2,!1]:(n[0],1===a.length&&1===a[0].length?(c=a[0][0],n.forEach(function(e){var n=t[e.rowIndex];n&&r(n,e.colKey,c,e.rowIndex)}),[2,!0]):(u=!1,(s=n[0])?-1===(d=o.findIndex(function(e){return String(e.key)===s.colKey}))?[2,!1]:(a.forEach(function(e,n){var l=s.rowIndex+n;if(!(l<0||l>=t.length)){var i=t[l];i&&e.forEach(function(e,n){var t=d+n;if(!(t<0||t>=o.length)){var a=o[t];if(a)try{r(i,a.key,e,l),u=!0}catch(e){}}})}}),[2,u]):[2,!1])):[2,!1];case 5:return i.sent(),[2,!1];case 6:return[2]}})})},[]),y=o.useCallback(function(){return null!==t&&t.length>0},[t]),C=o.useCallback(function(){return t},[t]),b=o.useCallback(function(){r(null),s(!1),h([])},[]);return{copyCells:g,cutCells:m,pasteCells:p,pasteFromSystemClipboard:v,canPaste:y,getClipboardData:C,clearClipboard:b}}(),Gn=o.useCallback(function(e,n,t){if(Ce&&"__rowNumber__"!==n){t.stopPropagation();var o=t.shiftKey;Vn.startSelection(e,n,o),Vn.setFocusedCell(e,n),Vn.setCopied(!1)}},[Ce,Vn]),jn=o.useCallback(function(e,n,t){Ce&&Vn.isSelecting&&"__rowNumber__"!==n&&Vn.updateSelection(e,n)},[Ce,Vn]),qn=o.useCallback(function(e,n,t){Ce&&"__rowNumber__"!==n&&Vn.endSelection()},[Ce,Vn]),Xn=o.useCallback(function(e,n){var t,o;if(!Ce)return{isStart:!1,isEnd:!1,isInRange:!1,isTopRow:!1,isBottomRow:!1,isLeftCol:!1,isRightCol:!1,isCopied:!1,isFocused:!1};var r=(null===(t=Vn.focusedCell)||void 0===t?void 0:t.rowIndex)===e&&(null===(o=Vn.focusedCell)||void 0===o?void 0:o.colKey)===n;if(!Vn.selectedRange)return{isStart:!1,isEnd:!1,isInRange:!1,isTopRow:!1,isBottomRow:!1,isLeftCol:!1,isRightCol:!1,isCopied:!1,isFocused:r};var l=Vn.selectedRange,i=Math.min(l.start.rowIndex,l.end.rowIndex),a=Math.max(l.start.rowIndex,l.end.rowIndex),c=$e.findIndex(function(e){return String(e.key)===l.start.colKey}),u=$e.findIndex(function(e){return String(e.key)===l.end.colKey}),s=Math.min(c>=0?c:0,u>=0?u:$e.length-1),d=Math.max(c>=0?c:0,u>=0?u:$e.length-1),f=$e.findIndex(function(e){return String(e.key)===n});return{isStart:l.start.rowIndex===e&&l.start.colKey===n,isEnd:l.end.rowIndex===e&&l.end.colKey===n,isInRange:Vn.isCellSelected(e,n),isTopRow:e===i,isBottomRow:e===a,isLeftCol:f===s,isRightCol:f===d,isCopied:Vn.isCopied,isFocused:r}},[Ce,Vn,$e]),Yn=o.useCallback(function(e){if(!Ce||!Vn.selectedRange)return!1;var n=Vn.selectedRange,t=Math.min(n.start.rowIndex,n.end.rowIndex);return t>0&&e===t-1},[Ce,Vn]),Zn=o.useCallback(function(){if(!Ce||!Vn.selectedRange)return!1;var e=Vn.selectedRange;return 0===Math.min(e.start.rowIndex,e.end.rowIndex)},[Ce,Vn]),Jn=o.useCallback(function(e){if(!Ce||!Vn.selectedRange)return!1;var n=Vn.selectedRange,t=$e.findIndex(function(e){return String(e.key)===n.start.colKey}),o=$e.findIndex(function(e){return String(e.key)===n.end.colKey}),r=Math.min(t>=0?t:0,o>=0?o:$e.length-1),l=Math.max(t>=0?t:0,o>=0?o:$e.length-1),i=$e.findIndex(function(n){return String(n.key)===e});return i>=r&&i<=l},[Ce,Vn,$e]),Qn=o.useCallback(function(e){if(!Ce||!Vn.selectedRange)return{isInRange:!1,isLeftCol:!1,isRightCol:!1};var n=Vn.selectedRange,t=$e.findIndex(function(e){return String(e.key)===n.start.colKey}),o=$e.findIndex(function(e){return String(e.key)===n.end.colKey}),r=Math.min(t>=0?t:0,o>=0?o:$e.length-1),l=Math.max(t>=0?t:0,o>=0?o:$e.length-1),i=$e.findIndex(function(n){return String(n.key)===e});return{isInRange:i>=r&&i<=l,isLeftCol:i===r,isRightCol:i===l}},[Ce,Vn,$e]);o.useEffect(function(){if(Ce){var e=function(e){if(Ke.current){var n=e.target;n&&!Ke.current.contains(n)&&(Vn.clearSelection(),Vn.clearFocus())}};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}},[Ce,Vn]),o.useEffect(function(){if(Ce&&Ke.current){var e=function(e){if(Ke.current){var n=e.relatedTarget;n&&!Ke.current.contains(n)&&(Vn.clearSelection(),Vn.clearFocus())}},n=Ke.current;return n.addEventListener("focusout",e),function(){n.removeEventListener("focusout",e)}}},[Ce,Vn]),o.useEffect(function(){if(Ce){var e=function(e){var n,t,o,r,l=document.activeElement;if(Ke.current&&l&&Ke.current.contains(l))if("INPUT"!==l.tagName&&"TEXTAREA"!==l.tagName&&"true"!==l.getAttribute("contenteditable"))if((e.ctrlKey||e.metaKey)&&"c"===e.key){if((M=(m=Vn.getSelectedCells()).filter(function(e){return"__rowNumber__"!==e.colKey})).length>0){e.preventDefault();var i=Ge?Ee.filtered:Ee.sorted,a=(Ee.currentPage-1)*Ee.itemsPerPage,c=M.map(function(e){var n=a+e.rowIndex,t=Ee.paged[e.rowIndex];if(t){var o=i.findIndex(function(e){return e===t||dn(e,-1)===dn(t,-1)});if(o>=0)return{rowIndex:o,colKey:e.colKey}}return{rowIndex:n,colKey:e.colKey}}),u=$e.filter(function(e){return"__rowNumber__"!==String(e.key)}).map(function(e){return{key:e.key,label:e.label}});Wn.copyCells(c,i,u),Vn.setCopied(!0)}}else if((e.ctrlKey||e.metaKey)&&"x"===e.key){if((M=(m=Vn.getSelectedCells()).filter(function(e){return"__rowNumber__"!==e.colKey})).length>0){e.preventDefault();var s=Ge?Ee.filtered:Ee.sorted,d=(Ee.currentPage-1)*Ee.itemsPerPage;c=M.map(function(e){var n=d+e.rowIndex,t=Ee.paged[e.rowIndex];if(t){var o=s.findIndex(function(e){return e===t||dn(e,-1)===dn(t,-1)});if(o>=0)return{rowIndex:o,colKey:e.colKey}}return{rowIndex:n,colKey:e.colKey}}),u=$e.filter(function(e){return"__rowNumber__"!==String(e.key)}).map(function(e){return{key:e.key,label:e.label}});Wn.cutCells(c,s,u)}}else if((e.ctrlKey||e.metaKey)&&"v"===e.key){var f=Vn.focusedCell,h=Vn.selectedRange,m=Vn.getSelectedCells(),p=null;if(f?p={rowIndex:f.rowIndex,colKey:f.colKey}:h?p={rowIndex:h.start.rowIndex,colKey:h.start.colKey}:m.length>0&&(p=m[0]),p){e.preventDefault();var v=Ge?Ee.filtered:Ee.sorted,y=Ee.paged[p.rowIndex],C=p.rowIndex;if(y){var b=v.findIndex(function(e){return e===y||dn(e,-1)===dn(y,-1)});if(b>=0)C=b;else{var w=(Ee.currentPage-1)*Ee.itemsPerPage;(C=w+p.rowIndex)>=v.length&&(C=v.length-1)}}else{w=(Ee.currentPage-1)*Ee.itemsPerPage;(C=w+p.rowIndex)>=v.length&&(C=v.length-1)}var x=function(e,n,t,o){var r=Pe.find(function(n){return n===e||dn(n,-1)===dn(e,-1)});if(r){var l=Pe.findIndex(function(e){return e===r});kn(r,n,t,l>=0?l:o)}else kn(e,n,t,o)},k=[{rowIndex:C,colKey:p.colKey}],S=p.colKey,R=function(e,n){var t=C,o=Math.min(C+e-1,v.length-1),r=$e.findIndex(function(e){return String(e.key)===S}),l=Math.min(r+n-1,$e.length-1);if(r>=0&&l>=0&&t>=0&&o>=0){var i=String($e[r].key),a=String($e[l].key),c=(Ee.currentPage-1)*Ee.itemsPerPage,u=t-c,s=o-c;u>=0&&s>=0&&u<Ee.paged.length&&s<Ee.paged.length&&requestAnimationFrame(function(){requestAnimationFrame(function(){Vn.setCopied(!1),Vn.setSelectionRange({rowIndex:u,colKey:i},{rowIndex:s,colKey:a}),Vn.setFocusedCell(u,i)})})}},I=$e.filter(function(e){return"__rowNumber__"!==String(e.key)}).map(function(e){return{key:e.key,label:e.label}});Wn.pasteFromSystemClipboard(k,v,I,x).then(function(e){var n,t;if(e){var o=(null==(l=Wn.getClipboardData())?void 0:l.length)||1,r=(null===(n=null==l?void 0:l[0])||void 0===n?void 0:n.length)||1;requestAnimationFrame(function(){requestAnimationFrame(function(){R(o,r)})})}else if(Wn.canPaste()){var l,i=(null==(l=Wn.getClipboardData())?void 0:l.length)||1,a=(null===(t=null==l?void 0:l[0])||void 0===t?void 0:t.length)||1;Wn.pasteCells(k,v,I,x),requestAnimationFrame(function(){requestAnimationFrame(function(){R(i,a)})})}}).catch(function(){var e;if(Wn.canPaste()){var n=Wn.getClipboardData(),t=(null==n?void 0:n.length)||1,o=(null===(e=null==n?void 0:n[0])||void 0===e?void 0:e.length)||1;Wn.pasteCells(k,v,I,x),requestAnimationFrame(function(){requestAnimationFrame(function(){R(t,o)})})}})}}else if("Delete"===e.key||"Backspace"===e.key){var M;if((M=(m=Vn.getSelectedCells()).filter(function(e){return"__rowNumber__"!==e.colKey})).length>0){e.preventDefault();var N=Ge?Ee.filtered:Pe;M.forEach(function(e){var n=N[e.rowIndex];if(n){var t=Pe.findIndex(function(e){return e===n});kn(n,e.colKey,"",t>=0?t:e.rowIndex)}})}}else if("Escape"===e.key)Vn.clearSelection(),Vn.setCopied(!1);else if("ArrowUp"===e.key||"ArrowDown"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key){if(!Rn){e.preventDefault();var P="ArrowUp"===e.key?"up":"ArrowDown"===e.key?"down":"ArrowLeft"===e.key?"left":"right",E=e.shiftKey;if((_=Vn.moveFocus(P,E))&&Ke.current)(F=Ke.current.querySelector('[data-row-index="'.concat(_.rowIndex,'"][data-col-key="').concat(_.colKey,'"]')))&&F.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}}else if("Tab"!==e.key||Rn)if("Enter"!==e.key||Rn)if("Home"!==e.key&&"End"!==e.key||Rn){if((e.ctrlKey||e.metaKey)&&("ArrowUp"===e.key||"ArrowDown"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key)&&!Rn){e.preventDefault();var D=Vn.focusedCell||(null===(o=Vn.selectedRange)||void 0===o?void 0:o.end);if(D){var K=Ge?Ee.filtered:g,L=D.rowIndex;O=$e.findIndex(function(e){return String(e.key)===D.colKey});if("ArrowUp"===e.key?L=0:"ArrowDown"===e.key?L=K.length-1:"ArrowLeft"===e.key?O=0:"ArrowRight"===e.key&&(O=$e.length-1),A=String(null===(r=$e[O])||void 0===r?void 0:r.key))if(Vn.setFocusedCell(L,A),Vn.startSelection(L,A,e.shiftKey),Ke.current)(F=Ke.current.querySelector('[data-row-index="'.concat(L,'"][data-col-key="').concat(A,'"]')))&&F.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}}}else{e.preventDefault();var T=Vn.focusedCell||(null===(n=Vn.selectedRange)||void 0===n?void 0:n.end);if(T)if($e.findIndex(function(e){return String(e.key)===T.colKey})>=0){var A,O="Home"===e.key?0:$e.length-1;(A=String(null===(t=$e[O])||void 0===t?void 0:t.key))&&(Vn.setFocusedCell(T.rowIndex,A),Vn.startSelection(T.rowIndex,A,e.shiftKey))}}else{e.preventDefault();P=e.shiftKey?"up":"down";if((_=Vn.moveFocus(P,!1))&&Ke.current)(F=Ke.current.querySelector('[data-row-index="'.concat(_.rowIndex,'"][data-col-key="').concat(_.colKey,'"]')))&&F.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}else{e.preventDefault();var _,F,P=e.shiftKey?"left":"right";if((_=Vn.moveFocus(P,!1))&&Ke.current)(F=Ke.current.querySelector('[data-row-index="'.concat(_.rowIndex,'"][data-col-key="').concat(_.colKey,'"]')))&&F.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}else(e.ctrlKey||e.metaKey)&&("c"===e.key||"x"===e.key||e.key)};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}},[Ce,Vn,Wn,Ee.paged,$e,V,Ge,g,Rn,Ee.filtered]);var $n=o.useMemo(function(){return _e?Array.from(new Set(g.map(function(e){return String(e[_e])}))):[]},[_e,g]);o.useEffect(function(){Ge&&Ee.setCurrentPage(1)},[Ge]);var et=o.useMemo(function(){if(!Ge)return null;var e={};return(Ee.sortKey?a([],Ee.filtered,!0).sort(function(e,n){var t=e[Ee.sortKey],o=n[Ee.sortKey];if(null==t)return 1;if(null==o)return-1;if(t===o)return 0;var r=String(t).localeCompare(String(o),void 0,{numeric:!0,sensitivity:"base"});return"asc"===Ee.sortDir?r:-r}):Ee.filtered).forEach(function(n){var t=String(n[Ge]);e[t]||(e[t]=[]),e[t].push(n)}),e},[Ee.filtered,Ee.sortKey,Ee.sortDir,Ge]);o.useEffect(function(){if(Ge&&et){var e=Object.keys(et).length,n=Math.ceil(e/Ee.itemsPerPage);Ee.currentPage>n&&n>0&&Ee.setCurrentPage(1)}},[et,Ge,Ee.itemsPerPage,Ee.currentPage,Ee.setCurrentPage]);var nt=o.useMemo(function(){if(!Ge||!et)return null;var e=Object.entries(et);e.sort(function(e,n){var t=e[0],o=n[0];return t.localeCompare(o)});var n=(Ee.currentPage-1)*Ee.itemsPerPage,t=n+Ee.itemsPerPage;return e.slice(n,t)},[et,Ee.currentPage,Ee.itemsPerPage,Ge]);o.useEffect(function(){Ge&&et?Xe(new Set(Object.keys(et))):Ge||Xe(new Set)},[Ge,et]);var tt=o.useCallback(function(e,n){var t,o,r;if(n.onRenderCell){var l=n.onRenderCell(e,n.key,0);return String("string"==typeof l||"number"==typeof l?l:null!==(t=e[n.key])&&void 0!==t?t:"")}if(C){l=C(e,n.key,0);return String("string"==typeof l||"number"==typeof l?l:null!==(o=e[n.key])&&void 0!==o?o:"")}return String(null!==(r=e[n.key])&&void 0!==r?r:"")},[C]),ot=o.useCallback(function(t,o,l){var i;return(null==Rn?void 0:Rn.rowIndex)===l&&(null==Rn?void 0:Rn.columnKey)===o.key&&o.editable?Ce?n("input",{ref:Mn,type:"text",className:"th-cell-edit-input th-cell-edit-input-excel",value:In,onChange:function(e){return Nn(e.target.value)},onBlur:function(){return En(t,o.key,l)},onKeyDown:function(e){"Enter"===e.key?(e.preventDefault(),En(t,o.key,l)):"Escape"===e.key&&(e.preventDefault(),Dn()),"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Tab"!==e.key&&"Home"!==e.key&&"End"!==e.key||e.stopPropagation()},onClick:function(e){e.stopPropagation()},onFocus:function(e){var n=e.target;n&&setTimeout(function(){var e=n.value.length;n.setSelectionRange(e,e)},0)},onMouseDown:function(e){e.stopPropagation()}}):e("div",r({className:"th-cell-edit-container"},{children:[n("input",{ref:Mn,type:"text",className:"th-cell-edit-input",value:In,onChange:function(e){return Nn(e.target.value)},onKeyDown:function(e){"Enter"===e.key?(e.preventDefault(),En(t,o.key,l)):"Escape"===e.key&&(e.preventDefault(),Dn()),"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Tab"!==e.key&&"Home"!==e.key&&"End"!==e.key||e.stopPropagation()},onClick:function(e){e.stopPropagation()},onFocus:function(e){var n=e.target;n&&setTimeout(function(){var e=n.value.length;n.setSelectionRange(e,e)},0)},onMouseDown:function(e){e.stopPropagation()}}),e("div",r({className:"th-cell-edit-buttons"},{children:[n("button",r({type:"button",className:"th-cell-edit-button th-cell-edit-save",onClick:function(e){e.stopPropagation(),e.preventDefault(),En(t,o.key,l)},onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},title:"Save"},{children:n("svg",r({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"12",height:"12"},{children:n("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}))})),n("button",r({type:"button",className:"th-cell-edit-button th-cell-edit-cancel",onClick:function(e){e.stopPropagation(),e.preventDefault(),Dn()},onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},title:"Cancel"},{children:n("svg",r({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"12",height:"12"},{children:n("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})}))}))]}))]})):o.onRenderCell?o.onRenderCell(t,o.key,l):C?C(t,o.key,l):String(null!==(i=t[o.key])&&void 0!==i?i:"")},[C,Rn,In,En,Dn]),rt=o.useMemo(function(){return P(H)},[H]),lt=o.useMemo(function(){return E(rt)},[rt]),it=o.useMemo(function(){return Ge&&nt?nt.flatMap(function(e){return e[0],e[1]}):Ee.paged},[Ge,nt,Ee.paged]),at=function(e,n,t,r,l,i,a){var c=o.useState(null),u=c[0],s=c[1];return o.useEffect(function(){if(n&&e.current&&!t){var o=function(e){if(!t&&0!==r.length){var n=document.activeElement;if(!n||"INPUT"!==n.tagName&&"TEXTAREA"!==n.tagName&&"true"!==n.getAttribute("contenteditable")){var o=null!=u?u:0;switch(e.key){case"ArrowDown":e.preventDefault(),o=Math.min(o+1,r.length-1),s(o);break;case"ArrowUp":e.preventDefault(),o=Math.max(o-1,0),s(o);break;case"Enter":case" ":if(e.preventDefault(),null!==u&&"none"!==l){var c=r[u],d=i(c,u);null==a||a(new Set([d]))}break;case"Escape":e.preventDefault(),s(null),null==a||a(new Set)}}}};return e.current.addEventListener("keydown",o),function(){var n;null===(n=e.current)||void 0===n||n.removeEventListener("keydown",o)}}},[n,t,u,l,r,i,a,e]),{focusedRowIndex:u,setFocusedRowIndex:s}}(Ke,le,X,it,T,dn,function(e){return mn(e)}),ct=at.focusedRowIndex,ut=Pe.length>0,st=!X&&!ut,dt=!X&&ut,ft=o.useCallback(function(e,n){var t=String(e.key);if("left"!==(Je[t]||e.pinned||null))return 0;var o=0;"none"!==T&&(o+=48);for(var r=0;r<n;r++){var l=$e[r];if("left"===(Je[String(l.key)]||l.pinned||null))o+=Cn[String(l.key)]||("number"==typeof l.width?l.width:parseFloat(l.width||"0"))||("string"==typeof l.width&&l.width.includes("px")?parseFloat(l.width):100)}return o},[$e,Je,Cn,T]),ht=o.useCallback(function(e,n){var t=String(e.key);if("right"!==(Je[t]||e.pinned||null))return 0;for(var o=0,r=n+1;r<$e.length;r++){var l=$e[r];if("right"===(Je[String(l.key)]||l.pinned||null))o+=Cn[String(l.key)]||("number"==typeof l.width?l.width:parseFloat(l.width||"0"))||("string"==typeof l.width&&l.width.includes("px")?parseFloat(l.width):100)}return o},[$e,Je,Cn]),gt=o.useMemo(function(){for(var e=null,n=0;n<$e.length;n++){var t=$e[n];if("left"===(Je[String(t.key)]||t.pinned||null))e=t.key;else if(null!==e)break}return e},[$e,Je]),mt=o.useMemo(function(){for(var e=0;e<$e.length;e++){var n=$e[e];if("right"===(Je[String(n.key)]||n.pinned||null))return n.key}return null},[$e,Je]);return e("div",r({ref:Ke,className:"th-table ".concat(D||""," th-theme-").concat(rt.mode||"light"," ").concat(bn?"resizing":""," ").concat($?"th-sticky-header":""," ").concat(Ce?"enable-cell-selection":""),style:r(r(r(r({},lt),K),z?{maxHeight:"number"==typeof z?"".concat(z,"px"):z,overflow:"auto"}:{}),bn?{cursor:"col-resize"}:{}),tabIndex:Ce||le?0:void 0},{children:[se&&n("div",r({className:"th-export-toolbar"},{children:n(I,{data:Ee.filtered,columns:$e,format:fe,filename:ge,onBeforeExport:me,onAfterExport:pe})})),X&&n(d,{columns:$e,itemsPerPage:v,selectionMode:T,onRenderLoading:Y}),st&&n(f,{emptyMessage:Z,onRenderEmpty:J}),dt&&n("div",r({style:r({overflowX:"auto",overflowY:$&&!z?"auto":"visible",width:"100%"},$&&!z?{maxHeight:"calc(100vh - 200px)"}:{})},{children:e("table",{children:[n(p,{columns:$e,selectionMode:T,isAllSelected:un,isIndeterminate:sn,onSelectAll:gn,columnWidths:Cn,pinnedColumns:Je,lastLeftPinnedColumnKey:gt,firstRightPinnedColumnKey:mt,stickyHeader:$,enableColumnReorder:te||!1,dragOverColumn:Qe,sortKey:Ee.sortKey,sortDir:Ee.sortDir,filters:Ee.filters,anchorRefs:De,calloutKey:xn.calloutKey,resizingColumn:bn,onRenderHeader:w,onColumnHeaderClick:S,onHeaderMouseEnter:function(e){if("__rowNumber__"!==e){var n=$e.find(function(n){return String(n.key)===e});n&&!1===n.showCallout||xn.handleHeaderMouseEnter(e)}},onHeaderMouseLeave:xn.handleHeaderMouseLeave,onCalloutMouseEnter:xn.handleCalloutMouseEnter,onCalloutMouseLeave:xn.handleCalloutMouseLeave,onColumnDragStart:tn,onColumnDragOver:on,onColumnDrop:rn,onResizeStart:wn,onSortAsc:function(e){"__rowNumber__"!==String(e.key)&&!1!==e.sortable&&Ee.handleSort(e.key,"asc")},onSortDesc:function(e){"__rowNumber__"!==String(e.key)&&!1!==e.sortable&&Ee.handleSort(e.key,"desc")},onFilter:function(e){var n;"__rowNumber__"!==String(e.key)&&(!1!==e.filterable&&(n=e.key,Fe(String(n)),xn.dismissCallout()))},onClearFilter:function(e){"__rowNumber__"!==String(e.key)&&!1!==e.filterable&&Ee.setFilter(String(e.key),[])},onPinLeft:function(e){"__rowNumber__"!==String(e.key)&&nn(e.key,"left")},onPinRight:function(e){"__rowNumber__"!==String(e.key)&&nn(e.key,"right")},onUnpin:function(e){"__rowNumber__"!==String(e.key)&&nn(e.key,null)},onToggleVisibility:function(e){"__rowNumber__"!==String(e.key)&&ee&&en(e.key)},onGroupBy:function(e){"__rowNumber__"!==String(e.key)&&(Ge===e.key?We(void 0):We(e.key))},currentGroupBy:Ge,enableColumnVisibility:ee||!1,enableGroupBy:!0,enableTotals:!0,onTotalsChange:function(e,n){Ae(function(t){var o;return r(r({},t),((o={})[String(e.key)]=n,o))})},columnTotals:Te,getLeftOffset:ft,getRightOffset:ht,dismissCallout:xn.dismissCallout,enableRowActions:!!ve,enableCellSelection:Ce,isRangeFromFirstRow:Zn(),isColumnInRange:Jn,getColumnRangeInfo:Qn,isCopied:Vn.isCopied}),n(x,{data:Pe,columns:$e,paginatedGroups:nt||void 0,currentGroupBy:Ge,expandedGroups:qe,selectionMode:T,selectedItems:an,activeItemIndex:cn,focusedRowIndex:null!=ct?ct:void 0,enableRowReorder:ae,draggedRowIndex:Tn,dragOverRowIndex:An,isDragging:On,columnWidths:Cn,pinnedColumns:Je,lastLeftPinnedColumnKey:gt||void 0,firstRightPinnedColumnKey:mt||void 0,showTooltip:j,onRenderRow:b,getItemKey:dn,onItemClick:hn,onItemContextMenu:N,onCheckboxChange:fn,onCellEditStart:Kn,onRowDragStart:_n,onRowDragOver:Fn,onRowDragLeave:Bn,onRowDrop:Hn,onRowDragEnd:zn,renderCell:ot,getCellText:tt,getLeftOffset:ft,getRightOffset:ht,toggleGroup:function(e){Xe(function(n){var t=new Set(n);return t.has(e)?t.delete(e):t.add(e),t})},filteredData:Ee.filtered,pagedData:Ee.paged,rowActions:ve,openMenuKey:He,onMenuToggle:pn,onMenuDismiss:vn,enableCellSelection:Ce,isCellSelected:Vn.isCellSelected,getCellRangeInfo:Xn,isRowAboveRange:Yn,isColumnInRange:Jn,getColumnRangeInfo:Qn,onCellMouseDown:Gn,onCellMouseEnter:jn,onCellMouseUp:qn}),n(k,{columns:$e,selectionMode:T,columnTotals:Te,pinnedColumns:Je,columnWidths:Cn,lastLeftPinnedColumnKey:gt||void 0,firstRightPinnedColumnKey:mt||void 0,totalCount:Ee.filtered.length,getLeftOffset:ft,getRightOffset:ht})]})})),dt&&_&&n(u,{totalItems:Ge&&et?Object.keys(et).length:Ee.filtered.length,itemsPerPage:Ee.itemsPerPage,currentPage:Ee.currentPage,onPageChange:Ee.setCurrentPage,itemsPerPageOptions:Ie,onItemsPerPageChange:function(e){Me(e),Ee.setCurrentPage(1)}}),_e&&n(s,{field:_e,values:$n,selected:Ee.filters[_e]||[],onApply:function(e){Ee.setFilter(_e,e),Fe(null)},onDismiss:function(){return Fe(null)}})]}))}export{D as ReactTabletify,E as applyTheme,N as defaultDarkTheme,M as defaultLightTheme,P as getTheme,c as useTable};
