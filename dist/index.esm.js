import{jsxs as e,jsx as n,Fragment as t}from"react/jsx-runtime";import*as o from"react";var r=function(){return r=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},r.apply(this,arguments)};function l(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var o,r,l=t.call(e),i=[];try{for(;(void 0===n||n-- >0)&&!(o=l.next()).done;)i.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(t=l.return)&&t.call(l)}finally{if(r)throw r.error}}return i}function i(e,n,t){if(t||2===arguments.length)for(var o,r=0,l=n.length;r<l;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}function a(e,n){void 0===n&&(n=10);var t=l(o.useState(""),2),a=t[0],c=t[1],u=l(o.useState(null),2),s=u[0],d=u[1],h=l(o.useState("asc"),2),f=h[0],g=h[1],p=l(o.useState(1),2),m=p[0],v=p[1],y=l(o.useState({}),2),w=y[0],b=y[1],C=function(e,n){b(function(t){var o=r({},t);return 0===n.length?delete o[e]:o[e]=n,o})},k=o.useMemo(function(){var n=e;if(Object.entries(w).forEach(function(e){var t=l(e,2),o=t[0],r=t[1];r.length>0&&(n=n.filter(function(e){return r.includes(String(e[o]))}))}),a.trim()){var t=a.toLowerCase();n=n.filter(function(e){return Object.values(e).some(function(e){return String(e).toLowerCase().includes(t)})})}return n},[e,a,w]),x=o.useMemo(function(){return s?i([],l(k),!1).sort(function(e,n){var t=e[s],o=n[s];if(null==t)return 1;if(null==o)return-1;if(t===o)return 0;var r=String(t).localeCompare(String(o),void 0,{numeric:!0,sensitivity:"base"});return"asc"===f?r:-r}):k},[k,s,f]),S=Math.ceil(x.length/n),R=o.useMemo(function(){var e=(m-1)*n;return x.slice(e,e+n)},[x,m,n]);o.useEffect(function(){v(1)},[a,s,f,w]);var I=o.useCallback(function(){c("")},[]),M=o.useCallback(function(){b({})},[]),D=o.useCallback(function(e){C(e,[])},[C]),N=o.useCallback(function(){d(null),g("asc")},[]),E=o.useCallback(function(){c(""),b({}),d(null),g("asc"),v(1)},[]),P=o.useCallback(function(){v(1)},[]),L=o.useCallback(function(){v(S)},[S]),K=o.useCallback(function(){v(function(e){return Math.min(e+1,S)})},[S]),T=o.useCallback(function(){v(function(e){return Math.max(e-1,1)})},[]);return{filtered:k,sorted:x,paged:R,currentPage:m,setCurrentPage:v,totalPages:S,itemsPerPage:n,goToFirstPage:P,goToLastPage:L,goToNextPage:K,goToPrevPage:T,search:a,setSearch:c,clearSearch:I,sortKey:s,sortDir:f,handleSort:function(e,n){n?(d(e),g(n)):s===e?g(function(e){return"asc"===e?"desc":"asc"}):(d(e),g("asc"))},resetSort:N,filters:w,setFilter:C,clearFilter:D,clearFilters:M,resetAll:E}}"function"==typeof SuppressedError&&SuppressedError;var c=function(o){var l=o.totalItems,i=o.itemsPerPage,a=o.currentPage,c=o.onPageChange,u=o.maxVisible,s=void 0===u?5:u,d=o.itemsPerPageOptions,h=o.onItemsPerPageChange,f=Math.ceil(l/i),g=Math.floor(s/2),p=Math.max(1,a-g),m=Math.min(f,p+s-1);m-p<s-1&&(p=Math.max(1,m-s+1));var v=Array.from({length:m-p+1},function(e,n){return p+n}),y=function(e){e<1||e>f||e===a||c(e)};return!(f<=0)||d&&h?e("div",r({className:"hh-pagination"},{children:[n("button",r({onClick:function(){return y(a-1)},disabled:1===a,className:"hh-pagination-btn hh-pagination-arrow","aria-label":"Previous page"},{children:"<"})),p>1&&e(t,{children:[n("button",r({className:"hh-pagination-btn",onClick:function(){return y(1)}},{children:"1"})),p>2&&n("span",r({className:"hh-pagination-ellipsis"},{children:"..."}))]}),v.map(function(e){return n("button",r({onClick:function(){return y(e)},className:"hh-pagination-btn ".concat(e===a?"hh-page-active":"")},{children:e}),e)}),m<f&&e(t,{children:[m<f-1&&n("span",r({className:"hh-pagination-ellipsis"},{children:"..."})),n("button",r({className:"hh-pagination-btn",onClick:function(){return y(f)}},{children:f}))]}),n("button",r({onClick:function(){return y(a+1)},disabled:a===f,className:"hh-pagination-btn hh-pagination-arrow","aria-label":"Next page"},{children:">"})),d&&h&&e("div",r({className:"hh-pagination-items-per-page"},{children:[n("label",r({htmlFor:"hh-items-per-page-select",style:{marginRight:"8px"}},{children:"Rows per page:"})),n("select",r({id:"hh-items-per-page-select",value:i,onChange:function(e){var n=Number(e.target.value);h(n),c(1)},className:"hh-pagination-select"},{children:d.map(function(e){return n("option",r({value:e},{children:e}),e)})}))]}))]})):null};function u(e){var t=e.width,o=void 0===t?12:t,l=e.height,i=void 0===l?12:l,a=e.className,c=e.style;return n("svg",r({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:o,height:i,className:a,style:c},{children:n("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}))}function s(e){var t=e.width,o=void 0===t?12:t,l=e.height,i=void 0===l?12:l,a=e.className,c=e.style;return n("svg",r({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:o,height:i,className:a,style:c},{children:n("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})}))}function d(e){var t=e.width,o=void 0===t?16:t,l=e.height,i=void 0===l?16:l,a=e.className,c=e.style;return n("svg",r({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",fill:"currentColor",width:o,height:i,className:a,style:c},{children:n("path",{d:"M1799 349l242 241-1017 1017L7 590l242-241 775 775 775-775z"})}))}function h(e){var t=e.width,o=void 0===t?14:t,l=e.height,i=void 0===l?14:l,a=e.className,c=e.style;return n("svg",r({xmlns:"http://www.w3.org/2000/svg",width:o,height:i,viewBox:"0 0 2048 2048",fill:"currentColor",className:a,style:c},{children:n("path",{d:"M1990 748q-33 33-64 60t-66 47-73 29-89 11q-34 0-65-6l-379 379q13 38 19 78t6 80q0 65-13 118t-37 100-60 89-79 87l-386-386-568 569-136 45 45-136 569-568-386-386q44-44 86-79t89-59 100-38 119-13q40 0 80 6t78 19l379-379q-6-31-6-65 0-49 10-88t30-74 46-65 61-65l690 690z"})}))}function f(e){var t=e.width,o=void 0===t?14:t,l=e.height,i=void 0===l?14:l,a=e.className,c=e.style;return n("svg",r({xmlns:"http://www.w3.org/2000/svg",width:o,height:i,viewBox:"0 0 2048 2048",fill:"currentColor",className:a,style:c},{children:n("path",{d:"M2048 128v219l-768 768v805H768v-805L0 347V128h2048z"})}))}function g(t){var o=t.width,l=void 0===o?16:o,i=t.height,a=void 0===i?16:i,c=t.className,u=t.style;return e("svg",r({width:l,height:a,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:c,style:u},{children:[n("circle",{cx:"4",cy:"8",r:"1.5",fill:"currentColor"}),n("circle",{cx:"8",cy:"8",r:"1.5",fill:"currentColor"}),n("circle",{cx:"12",cy:"8",r:"1.5",fill:"currentColor"})]}))}function p(e){var t=e.width,o=void 0===t?16:t,l=e.height,i=void 0===l?16:l,a=e.className,c=e.style;return n("svg",r({width:o,height:i,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:a,style:c},{children:n("path",{d:"M6 4L10 8L6 12",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})}))}function m(e){var t=e.width,o=void 0===t?16:t,l=e.height,i=void 0===l?16:l,a=e.className,c=e.style;return n("svg",r({width:o,height:i,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:a,style:c},{children:n("path",{d:"M2 2h12v12H2V2zm1 1v10h10V3H3zm1 1h8v1H4V4zm0 2h8v1H4V6zm0 2h8v1H4V8zm0 2h5v1H4v-1z",fill:"currentColor"})}))}function v(t){var a=t.field,c=t.values,u=t.selected,d=t.onApply,h=t.onDismiss,f=l(o.useState(u),2),g=f[0],p=f[1],m=l(o.useState(""),2),v=m[0],y=m[1];o.useEffect(function(){p(u),y("")},[a]);var w=o.useMemo(function(){if(!v.trim())return c;var e=v.toLowerCase();return c.filter(function(n){return n.toLowerCase().includes(e)})},[c,v]);return e("div",r({className:"hh-filter-panel open"},{children:[e("div",r({className:"hh-filter-header"},{children:[e("strong",{children:["Filter by '",a,"'"]}),n("button",r({className:"hh-filter-close",onClick:h,"aria-label":"Close"},{children:n(s,{width:16,height:16})}))]})),e("div",r({className:"hh-filter-content"},{children:[n("div",r({className:"hh-filter-search"},{children:n("input",{type:"text",className:"hh-filter-search-input",placeholder:"Select ".concat(a," to display..."),value:v,onChange:function(e){return y(e.target.value)}})})),n("div",r({className:"hh-filter-options-list"},{children:w.length>0?w.map(function(t){return e("div",r({className:"hh-filter-option"},{children:[n("input",{type:"checkbox",id:"filter-".concat(a,"-").concat(t),checked:g.includes(t),onChange:function(){return function(e){p(function(n){return n.includes(e)?n.filter(function(n){return n!==e}):i(i([],l(n),!1),[e],!1)})}(t)}}),n("label",r({htmlFor:"filter-".concat(a,"-").concat(t)},{children:t}))]}),t)}):n("div",r({className:"hh-filter-no-results"},{children:"No results found"}))}))]})),e("div",r({className:"hh-filter-footer"},{children:[n("button",r({className:"hh-btn",onClick:function(){p([])}},{children:"Clear all"})),n("button",r({className:"hh-btn primary",onClick:function(){return d(g)}},{children:"Apply"}))]}))]}))}function y(o){var l=o.columns,i=o.itemsPerPage,a=o.selectionMode,c=o.onRenderLoading;return c?n(t,{children:c()}):e("div",r({className:"hh-loading-skeleton"},{children:[e("div",r({className:"hh-skeleton-header"},{children:["none"!==a&&n("div",{className:"hh-skeleton-cell",style:{width:"48px"}}),l.map(function(e,t){return n("div",{className:"hh-skeleton-cell",style:{width:e.width||"150px"}},t)})]})),Array.from({length:i}).map(function(t,o){return e("div",r({className:"hh-skeleton-row"},{children:["none"!==a&&n("div",{className:"hh-skeleton-cell",style:{width:"48px"}}),l.map(function(e,t){return n("div",{className:"hh-skeleton-cell",style:{width:e.width||"150px"}},t)})]}),o)})]}))}function w(o){var l=o.emptyMessage,i=o.onRenderEmpty;return i?n(t,{children:i()}):e("div",r({className:"hh-empty-state"},{children:[n("div",r({className:"hh-empty-icon"},{children:"ðŸ“‹"})),n("div",r({className:"hh-empty-message"},{children:l||"No data available"}))]}))}function b(e){var t=e.selectionMode,o=e.checked,l=e.indeterminate,i=e.onChange,a=e.onSelectAll;if("none"===t)return null;var c=void 0!==a;return n("td",r({className:"hh-selection-column"},{children:n("div",r({className:"hh-selection-checkbox-wrapper"},{children:"multiple"===t?n("input",{type:"checkbox",className:"hh-selection-checkbox",checked:o,ref:function(e){e&&void 0!==l&&(e.indeterminate=l)},onChange:function(e){c&&a?a(e.target.checked):i(e.target.checked)},onClick:function(e){return e.stopPropagation()}}):c?n("div",{className:"hh-selection-checkbox-wrapper"}):n("input",{type:"radio",className:"hh-selection-checkbox",checked:o,onChange:function(e){return i(e.target.checked)},onClick:function(e){return e.stopPropagation()}})}))}))}function C(i){var a,c=i.anchorRef,u=i.onSortAsc,s=i.onSortDesc,d=i.onFilter,h=i.onClearFilter,f=i.onPinLeft,g=i.onPinRight,p=i.onUnpin,m=i.onToggleVisibility,v=i.onGroupBy,y=i.isGrouped,w=void 0!==y&&y,b=i.onColumnSettings,C=i.onTotalsChange,k=i.totalsValue,x=void 0===k?"none":k,S=i.columnLabel,R=void 0===S?"Column":S;i.onDismiss;var I=i.onMouseEnter,M=i.onMouseLeave,D=i.sortable,N=void 0===D||D,E=i.filterable,P=void 0===E||E,L=i.hasFilter,K=void 0!==L&&L,T=i.pinned,F=void 0===T?null:T,A=i.visible,O=void 0===A||A,B=i.enableColumnVisibility,_=void 0!==B&&B;i.enableColumnReorder;var z=i.groupable,H=void 0!==z&&z,V=i.settingsable,W=void 0!==V&&V,U=i.totalsable,j=void 0!==U&&U,Y=o.useRef(null),G=l(o.useState(null),2),q=G[0],X=G[1],J=o.useRef(null),Q=null===(a=c.current)||void 0===a?void 0:a.getBoundingClientRect(),Z=l(o.useState({top:Q?Q.bottom+6:0,left:Q?Q.left:0,position:"fixed"}),2),$=Z[0],ee=Z[1];if(o.useEffect(function(){return function(){J.current&&clearTimeout(J.current)}},[]),o.useEffect(function(){if(Y.current&&c.current){var e=function(){if(Y.current&&c.current){var e=c.current.getBoundingClientRect(),n=Y.current.getBoundingClientRect().height||200,t=window.innerHeight-e.bottom,o=e.top;ee(t<n&&o>t?{top:e.top-n-6,left:e.left,position:"fixed"}:{top:e.bottom+6,left:e.left,position:"fixed"})}};return setTimeout(e,0),window.addEventListener("scroll",e,!0),window.addEventListener("resize",e),function(){window.removeEventListener("scroll",e,!0),window.removeEventListener("resize",e)}}},[]),!c.current)return null;c.current.getBoundingClientRect();var ne=function(e){J.current&&clearTimeout(J.current),X(e)},te=function(){J.current=setTimeout(function(){X(null)},150)};return n(t,{children:e("div",r({ref:Y,className:"hh-callout",style:$,onMouseEnter:I,onMouseLeave:M},{children:[N&&e(t,{children:[n("button",r({onClick:u,className:"hh-callout-item"},{children:n("span",r({className:"hh-callout-text"},{children:"Ascending"}))})),n("button",r({onClick:s,className:"hh-callout-item"},{children:n("span",r({className:"hh-callout-text"},{children:"Descending"}))}))]}),N&&P&&n("hr",{className:"hh-callout-divider"}),P&&K&&h&&n("button",r({onClick:h,className:"hh-callout-item"},{children:n("span",r({className:"hh-callout-text"},{children:"Clear filter"}))})),P&&K&&h&&n("hr",{className:"hh-callout-divider"}),P&&n("button",r({onClick:d,className:"hh-callout-item"},{children:n("span",r({className:"hh-callout-text"},{children:"Filter by"}))})),H&&v&&e(t,{children:[n("hr",{className:"hh-callout-divider"}),e("button",r({onClick:v,className:"hh-callout-item ".concat(w?"hh-callout-item-selected":"")},{children:[e("span",r({className:"hh-callout-text"},{children:["Group by ",R]})),w&&n("span",r({className:"hh-callout-checkmark"},{children:"âœ“"}))]}))]}),(W&&b||j)&&n("hr",{className:"hh-callout-divider"}),W&&b&&e("div",r({className:"hh-callout-item hh-callout-item-with-submenu",onMouseEnter:function(){return ne("column-settings")},onMouseLeave:te},{children:[n("span",r({className:"hh-callout-text"},{children:"Column settings"})),n("span",r({className:"hh-callout-arrow"},{children:"â€º"})),"column-settings"===q&&e("div",r({className:"hh-callout-submenu",onMouseEnter:function(){return ne("column-settings")},onMouseLeave:te},{children:[null===F&&f&&n("button",r({onClick:f,className:"hh-callout-submenu-item"},{children:n("span",r({className:"hh-callout-text"},{children:"Pin left"}))})),null===F&&g&&n("button",r({onClick:g,className:"hh-callout-submenu-item"},{children:n("span",r({className:"hh-callout-text"},{children:"Pin right"}))})),null!==F&&p&&n("button",r({onClick:p,className:"hh-callout-submenu-item"},{children:n("span",r({className:"hh-callout-text"},{children:"Unpin"}))})),_&&m&&e(t,{children:[(f||g||p)&&n("hr",{className:"hh-callout-divider"}),n("button",r({onClick:m,className:"hh-callout-submenu-item"},{children:n("span",r({className:"hh-callout-text"},{children:O?"Hide column":"Show column"}))}))]})]}))]})),j&&C&&e("div",r({className:"hh-callout-item hh-callout-item-with-submenu",onMouseEnter:function(){return ne("totals")},onMouseLeave:te},{children:[n("span",r({className:"hh-callout-text"},{children:"Totals"})),n("span",r({className:"hh-callout-arrow"},{children:"â€º"})),"totals"===q&&e("div",r({className:"hh-callout-submenu",onMouseEnter:function(){return ne("totals")},onMouseLeave:te},{children:[e("button",r({onClick:function(){return C("none")},className:"hh-callout-submenu-item ".concat("none"===x?"hh-callout-item-selected":"")},{children:[n("span",r({className:"hh-callout-text"},{children:"None"})),"none"===x&&n("span",r({className:"hh-callout-checkmark"},{children:"âœ“"}))]})),e("button",r({onClick:function(){return C("count")},className:"hh-callout-submenu-item ".concat("count"===x?"hh-callout-item-selected":"")},{children:[n("span",r({className:"hh-callout-text"},{children:"Count"})),"count"===x&&n("span",r({className:"hh-callout-checkmark"},{children:"âœ“"}))]}))]}))]}))]}))})}function k(t){var o=t.column,l=t.columnIndex,i=t.resizedWidth,a=t.pinPosition,c=t.leftOffset,u=t.rightOffset,s=t.lastLeftPinnedColumnKey,g=t.firstRightPinnedColumnKey,p=t.stickyHeader,m=t.enableColumnReorder,v=t.isDragOver,y=t.sortKey,w=t.sortDir,b=t.hasFilter,k=t.anchorRef,x=t.anchorRefForCallout,S=t.calloutKey,R=t.resizingColumn,I=t.onRenderHeader,M=t.onColumnHeaderClick,D=t.onHeaderMouseEnter,N=t.onHeaderMouseLeave,E=t.onCalloutMouseEnter,P=t.onCalloutMouseLeave,L=t.onColumnDragStart,K=t.onColumnDragOver,T=t.onColumnDrop,F=t.onResizeStart,A=t.onSortAsc,O=t.onSortDesc,B=t.onFilter,_=t.onClearFilter,z=t.onPinLeft,H=t.onPinRight,V=t.onUnpin,W=t.onToggleVisibility,U=t.onGroupBy,j=t.isGrouped,Y=t.enableColumnVisibility,G=t.groupable,q=t.settingsable,X=t.totalsable,J=t.onTotalsChange,Q=t.totalsValue,Z=t.onDismiss,$=t.enableCellSelection,ee=void 0!==$&&$,ne=t.isInRangeColumn,te=void 0!==ne&&ne,oe=t.isLeftColInRange,re=void 0!==oe&&oe,le=t.isRightColInRange,ie=void 0!==le&&le,ae=t.isCopied,ce=void 0!==ae&&ae,ue=String(o.key),se=r(r(r(r({},o.style),{width:i?"".concat(i,"px"):o.width,minWidth:o.minWidth,maxWidth:o.maxWidth,textAlign:o.align,position:a?"sticky":"relative"}),"left"===a?{left:"".concat(c,"px"),zIndex:p?15:5}:{}),"right"===a?{right:"".concat(u,"px"),zIndex:p?15:5}:{}),de=o.className?"hh-header-cell ".concat(a?"hh-header-pinned hh-pinned-".concat(a):""," ").concat(o.className):a?"hh-header-cell hh-header-pinned hh-pinned-".concat(a):"hh-header-cell",he=[v?"hh-drag-over":"",a?"hh-pinned-".concat(a):"","left"===a&&o.key===s?"hh-pinned-last-left":"","right"===a&&o.key===g?"hh-pinned-first-right":"",ee&&ce?"hh-cell-copied":""].filter(Boolean).join(" ");return e("th",r({style:se,draggable:m,onDragStart:function(){return L(o.key)},onDragOver:function(e){return K(e,o.key)},onDrop:function(){return T(o.key)},onDragLeave:function(){},className:he,"data-in-range-column":ee&&te?"true":void 0,"data-left-col-in-range":ee&&re?"true":void 0,"data-right-col-in-range":ee&&ie?"true":void 0},{children:[I?I(o,l):e("div",r({className:de,ref:function(e){k(e)},onMouseEnter:function(){return D(ue)},onMouseLeave:N,onClick:function(e){return null==M?void 0:M(o,e)}},{children:[e("span",r({className:"hh-header-label"},{children:[o.label,!1!==o.showCallout&&n("span",r({className:"hh-header-chevron-icon",role:"presentation","aria-hidden":"true"},{children:n(d,{})}))]})),e("div",r({className:"hh-header-icons"},{children:[a&&n("span",r({className:"hh-header-pin-icon",title:"Pinned ".concat(a)},{children:n(h,{width:14,height:14})})),b&&n("span",r({className:"hh-header-filter-icon",title:"Filtered",role:"presentation","aria-hidden":"true"},{children:n(f,{width:14,height:14})})),y===o.key&&n("span",r({className:"hh-header-sort-icon"},{children:n("span",r({className:"hh-sort-arrow"},"asc"===w?{children:"â†‘"}:{children:"â†“"}))}))]})),n("span",r({className:"hh-header-action"},{children:"â‹®"}))]})),!1!==o.resizable&&n("div",{className:"hh-resize-handle",onMouseDown:function(e){return F(ue,e)},style:{cursor:"col-resize",position:"absolute",right:0,top:0,bottom:0,width:"4px",zIndex:10,userSelect:"none"}}),S===ue&&!R&&!1!==o.showCallout&&n(C,{anchorRef:x,onSortAsc:A,onSortDesc:O,onFilter:B,onClearFilter:_,onPinLeft:z,onPinRight:H,onUnpin:V,onToggleVisibility:W,onGroupBy:U,isGrouped:j,onColumnSettings:q?!!V||Y:void 0,onTotalsChange:J,totalsValue:Q,columnLabel:o.label,onDismiss:Z,onMouseEnter:E,onMouseLeave:P,sortable:!1!==o.sortable,filterable:!1!==o.filterable,hasFilter:b,pinned:a,visible:!0,enableColumnVisibility:Y,groupable:G,settingsable:q,totalsable:X})]}),ue)}function x(t){var o=t.columns,l=t.selectionMode,i=t.isAllSelected,a=t.isIndeterminate,c=t.onSelectAll,u=t.columnWidths,s=t.pinnedColumns,d=t.lastLeftPinnedColumnKey,h=t.firstRightPinnedColumnKey,f=t.stickyHeader,g=t.enableColumnReorder,p=t.dragOverColumn,m=t.sortKey,v=t.sortDir,y=t.filters,w=t.anchorRefs,C=t.calloutKey,x=t.resizingColumn,S=t.onRenderHeader,R=t.onColumnHeaderClick,I=t.onHeaderMouseEnter,M=t.onHeaderMouseLeave,D=t.onCalloutMouseEnter,N=t.onCalloutMouseLeave,E=t.onColumnDragStart,P=t.onColumnDragOver,L=t.onColumnDrop,K=t.onResizeStart,T=t.onSortAsc,F=t.onSortDesc,A=t.onFilter,O=t.onClearFilter,B=t.onPinLeft,_=t.onPinRight,z=t.onUnpin,H=t.onToggleVisibility,V=t.onGroupBy,W=t.currentGroupBy,U=t.enableColumnVisibility,j=t.onTotalsChange,Y=t.columnTotals,G=t.getLeftOffset,q=t.getRightOffset,X=t.dismissCallout,J=t.enableRowActions,Q=void 0!==J&&J,Z=t.enableCellSelection,$=void 0!==Z&&Z,ee=t.isRangeFromFirstRow,ne=void 0!==ee&&ee;t.isColumnInRange;var te=t.getColumnRangeInfo,oe=t.isCopied,re=void 0!==oe&&oe;return n("thead",{children:e("tr",{children:["none"!==l&&n(b,{selectionMode:l,checked:i,indeterminate:a,onChange:function(){},onSelectAll:c}),Q&&n("th",r({className:"hh-row-actions-column"},{children:n("div",r({className:"hh-header-cell"},{children:n("span",{className:"hh-header-label"})}))})),o.map(function(e,t){var o=String(e.key),r=u[o],l=s[o]||e.pinned||null,i="left"===l?G(e,t):0,a="right"===l?q(e,t):0,c=$&&ne&&te?te(o):{isInRange:!1,isLeftCol:!1,isRightCol:!1},b=$&&ne&&re&&c.isInRange,J={get current(){return w.current[o]||null},set current(e){}};return n(k,{column:e,columnIndex:t,resizedWidth:r,pinPosition:l,leftOffset:i,rightOffset:a,lastLeftPinnedColumnKey:null!=d?d:void 0,firstRightPinnedColumnKey:null!=h?h:void 0,stickyHeader:f,enableColumnReorder:g,isDragOver:p===e.key,sortKey:m,sortDir:v,hasFilter:!!(y[o]&&y[o].length>0),anchorRef:function(e){e&&(w.current[o]=e)},anchorRefForCallout:J,calloutKey:C===e.key?o:null,resizingColumn:x,onRenderHeader:S,onColumnHeaderClick:R,onHeaderMouseEnter:I,onHeaderMouseLeave:M,onCalloutMouseEnter:D,onCalloutMouseLeave:N,onColumnDragStart:E,onColumnDragOver:P,onColumnDrop:L,onResizeStart:K,enableCellSelection:$,isInRangeColumn:c.isInRange,isLeftColInRange:c.isLeftCol,isRightColInRange:c.isRightCol,isCopied:b,onSortAsc:function(){!1!==e.sortable&&(T(e),X())},onSortDesc:function(){!1!==e.sortable&&(F(e),X())},onFilter:function(){!1!==e.filterable&&A(e)},onClearFilter:function(){!1!==e.filterable&&(O(e),X())},onPinLeft:function(){B(e),X()},onPinRight:function(){_(e),X()},onUnpin:function(){z(e),X()},onToggleVisibility:function(){U&&(H(e),X())},onGroupBy:function(){!1!==e.groupable&&(V(e),X())},isGrouped:W===e.key,enableColumnVisibility:U,groupable:e.groupable,settingsable:e.settingsable,totalsable:e.totalsable,onTotalsChange:function(n){!1!==e.totalsable&&(j(e,n),X())},totalsValue:Y[o]||"none",onDismiss:X},o)})]})})}function S(t){var o=t.groupKey,l=t.groupLabel,i=t.rowCount,a=t.isExpanded,c=t.onToggle,u=t.colSpan;return n("tr",r({className:"hh-group-header"},{children:n("td",r({colSpan:u,className:"hh-group-header-cell"},{children:e("button",r({className:"hh-group-toggle",onClick:c,"aria-expanded":a},{children:[n(p,{width:16,height:16,className:a?"expanded":""}),e("span",r({className:"hh-group-label"},{children:[l,": ",o]})),e("span",r({className:"hh-group-count"},{children:["(",i,")"]}))]}))}))}))}var R=o.memo(function(e){var t=e.column,o=e.item,l=e.index,i=e.resizedWidth,a=e.pinPosition,c=e.leftOffset,u=e.rightOffset,s=e.lastLeftPinnedColumnKey,d=e.firstRightPinnedColumnKey,h=e.showTooltip,f=e.onDoubleClick,g=e.renderCell,p=e.getCellText,m=e.isSelected,v=void 0!==m&&m,y=e.isRangeStart,w=void 0!==y&&y,b=e.isRangeEnd,C=void 0!==b&&b,k=e.isInRange,x=void 0!==k&&k,S=e.isTopRow,R=void 0!==S&&S,I=e.isBottomRow,M=void 0!==I&&I,D=e.isLeftCol,N=void 0!==D&&D,E=e.isRightCol,P=void 0!==E&&E,L=e.isInRangeColumn,K=void 0!==L&&L,T=e.isLeftColInRange,F=void 0!==T&&T,A=e.isRightColInRange,O=void 0!==A&&A,B=e.isCopied,_=void 0!==B&&B,z=e.isFocused,H=void 0!==z&&z,V=e.rowIndex,W=e.colKey,U=e.onMouseDown,j=e.onMouseEnter,Y=e.onMouseUp,G=e.enableCellSelection,q=void 0!==G&&G,X=String(t.key),J=r(r(r(r({},t.cellStyle),{textAlign:t.align,width:i?"".concat(i,"px"):t.width,position:a?"sticky":"relative"}),"left"===a?{left:"".concat(c,"px"),zIndex:3}:{}),"right"===a?{right:"".concat(u,"px"),zIndex:3}:{}),Q=[t.cellClassName,t.editable?"hh-cell-editable":"",a?"hh-cell-pinned hh-pinned-".concat(a):"","left"===a&&t.key===s?"hh-pinned-last-left":"","right"===a&&t.key===d?"hh-pinned-first-right":"",q&&v?"hh-cell-selected":"",q&&H?"hh-cell-focused":"",q&&w?"hh-cell-range-start":"",q&&C?"hh-cell-range-end":"",q&&x?"hh-cell-in-range":"",q&&R?"hh-cell-range-top":"",q&&M?"hh-cell-range-bottom":"",q&&N?"hh-cell-range-left":"",q&&P?"hh-cell-range-right":"",q&&_?"hh-cell-copied":"",h?"hh-cell-with-tooltip":"hh-cell-no-tooltip"].filter(Boolean).join(" "),Z=h&&p?p(o,t):void 0;return n("td",r({style:J,className:Q,onDoubleClick:f,title:Z||void 0,onMouseDown:q?U:void 0,onMouseEnter:q?j:void 0,onMouseUp:q?Y:void 0,"data-in-range-column":q&&K?"true":void 0,"data-left-col-in-range":q&&F?"true":void 0,"data-right-col-in-range":q&&O?"true":void 0,"data-row-index":q&&void 0!==V?V:void 0,"data-col-key":q&&W?W:void 0},{children:g(o,t,l)}),X)},function(e,n){return e.item===n.item&&e.index===n.index&&e.column.key===n.column.key&&e.resizedWidth===n.resizedWidth&&e.pinPosition===n.pinPosition&&e.leftOffset===n.leftOffset&&e.rightOffset===n.rightOffset&&e.showTooltip===n.showTooltip&&e.isSelected===n.isSelected&&e.isFocused===n.isFocused&&e.isRangeStart===n.isRangeStart&&e.isRangeEnd===n.isRangeEnd&&e.isInRange===n.isInRange&&e.isTopRow===n.isTopRow&&e.isBottomRow===n.isBottomRow&&e.isLeftCol===n.isLeftCol&&e.isRightCol===n.isRightCol&&e.isInRangeColumn===n.isInRangeColumn&&e.isLeftColInRange===n.isLeftColInRange&&e.isRightColInRange===n.isRightColInRange&&e.isCopied===n.isCopied&&e.enableCellSelection===n.enableCellSelection&&e.renderCell===n.renderCell});function I(e){var t=e.item,o=e.index,l=e.actions,i=e.onMenuToggle,a=e.isMenuOpen,c=e.buttonRef;return l&&0!==l.length?n("td",r({className:"hh-row-actions-column"},{children:n("button",r({ref:c,type:"button",className:"hh-row-actions-button ".concat(a?"hh-row-actions-button-active":""),onClick:function(e){e.preventDefault(),e.stopPropagation(),i(t,o)},onContextMenu:function(e){e.preventDefault(),e.stopPropagation()},"aria-label":"Row actions","aria-haspopup":"true","aria-expanded":a},{children:n(g,{width:16,height:16,style:{display:"block"}})}))})):n("td",{className:"hh-row-actions-column"})}function M(t){var i=t.anchorRef,a=t.actions,c=t.item,u=t.index,s=t.onDismiss,d=t.onMouseEnter,h=t.onMouseLeave,f=o.useRef(null),g=l(o.useState(0),2),p=g[0],m=g[1];if(o.useEffect(function(){var e=function(e){f.current&&!f.current.contains(e.target)&&i.current&&!i.current.contains(e.target)&&s()},n=function(e){"Escape"===e.key&&s()};return document.addEventListener("mousedown",e),document.addEventListener("keydown",n),function(){document.removeEventListener("mousedown",e),document.removeEventListener("keydown",n)}},[s,i]),o.useEffect(function(){if(i.current&&f.current){var e=i.current.getBoundingClientRect(),n=f.current.offsetHeight||32*a.length+8,t=window.innerHeight-e.bottom,o=e.top;m(t<n&&o>t?e.top-n-4:e.bottom+4)}},[a.length,i]),!i.current||0===a.length)return null;var v=i.current.getBoundingClientRect();return n("div",r({ref:f,className:"hh-row-actions-menu",style:{position:"fixed",top:"".concat(p,"px"),left:"".concat(v.left,"px"),zIndex:1e3},onMouseEnter:d,onMouseLeave:h},{children:a.map(function(t){return e("button",r({className:"hh-row-actions-menu-item ".concat(t.disabled?"hh-row-actions-menu-item-disabled":""),onClick:function(){return function(e){e.disabled||(e.onClick(c,u),s())}(t)},disabled:t.disabled},{children:[t.icon&&n("span",r({className:"hh-row-actions-menu-icon"},{children:t.icon})),n("span",r({className:"hh-row-actions-menu-text"},{children:t.label}))]}),t.key)})}))}function D(l){var i=l.item,a=l.index,c=l.itemKey,u=l.columns,s=l.selectionMode,d=l.isSelected,h=l.isActive,f=l.isFocused,g=void 0!==f&&f,p=l.isDragging,m=void 0!==p&&p,v=l.isDragOver,y=void 0!==v&&v,w=l.canDrag,C=l.columnWidths,k=l.pinnedColumns,x=l.lastLeftPinnedColumnKey,S=l.firstRightPinnedColumnKey,D=l.showTooltip,N=l.onItemClick,E=l.onItemContextMenu,P=l.onCheckboxChange,L=l.onCellEditStart,K=l.onDragStart,T=l.onDragOver,F=l.onDragLeave,A=l.onDrop,O=l.onDragEnd,B=l.dragIndex,_=l.renderCell,z=l.getCellText,H=l.getLeftOffset,V=l.getRightOffset,W=l.isDraggingState,U=l.rowActions,j=l.openMenuKey,Y=l.onMenuToggle,G=l.onMenuDismiss,q=l.enableCellSelection,X=void 0!==q&&q,J=l.cellSelectionIndex,Q=l.isCellSelected,Z=l.getCellRangeInfo,$=l.isRowAboveRange,ee=void 0!==$&&$;l.isColumnInRange;var ne=l.getColumnRangeInfo,te=l.onCellMouseDown,oe=l.onCellMouseEnter,re=l.onCellMouseUp,le=o.useMemo(function(){return[d?"hh-row-selected":"",!X&&h?"hh-row-active":"",!X&&g?"hh-row-focused":"",w?"hh-row-draggable":"",m?"hh-row-dragging":"",y?"hh-row-drag-over":"",X&&ee?"hh-row-above-range":""].filter(Boolean).join(" ")},[d,X,h,g,w,m,y,ee]),ie=U?U(i,a):[],ae=j===o.useMemo(function(){return"".concat(String(c),"-").concat(a)},[c,a]),ce=o.useRef(null);return e(t,{children:[e("tr",r({className:le,draggable:w,onDragStart:function(e){return K(e,void 0!==B?B:a)},onDragOver:function(e){return T(e,void 0!==B?B:a)},onDragLeave:F,onDrop:function(e){return A(e,void 0!==B?B:a)},onDragEnd:O,onClick:function(e){W||X||N(i,a,e)},onContextMenu:function(e){return null==E?void 0:E(i,a,e)}},{children:["none"!==s&&n(b,{selectionMode:s,checked:d,onChange:function(e){return P(i,a,e)}}),ie.length>0&&n(I,{item:i,index:a,actions:ie,onMenuToggle:Y,isMenuOpen:ae,buttonRef:ce}),u.map(function(e,t){var o=String(e.key),r=C[o],l=k[o]||e.pinned||null,c=u.findIndex(function(e){return String(e.key)===o}),s="left"===l?H(e,c):0,d="right"===l?V(e,c):0,h=void 0!==J?J:a,f=!(!X||!Q)&&Q(h,o),g=X&&Z?Z(h,o):{isStart:!1,isEnd:!1,isInRange:!1,isTopRow:!1,isBottomRow:!1,isLeftCol:!1,isRightCol:!1,isCopied:!1,isFocused:!1},p=null!=g.isCopied&&g.isCopied,m=null!=g.isFocused&&g.isFocused,v=X&&ee&&ne?ne(o):{isInRange:!1,isLeftCol:!1,isRightCol:!1},y=v.isInRange;return n(R,{column:e,item:i,index:a,resizedWidth:r,pinPosition:l,leftOffset:s,rightOffset:d,lastLeftPinnedColumnKey:x,firstRightPinnedColumnKey:S,showTooltip:D,onDoubleClick:function(){return L(i,e,a)},renderCell:_,getCellText:z,enableCellSelection:X,isSelected:f,isFocused:m,isRangeStart:g.isStart,isRangeEnd:g.isEnd,isInRange:g.isInRange,isTopRow:g.isTopRow,isBottomRow:g.isBottomRow,isLeftCol:g.isLeftCol,isRightCol:g.isRightCol,isInRangeColumn:y,isLeftColInRange:v.isLeftCol,isRightColInRange:v.isRightCol,isCopied:p,rowIndex:h,colKey:o,onMouseDown:X&&te?function(e){return te(h,o,e)}:void 0,onMouseEnter:X&&oe?function(e){return oe(h,o,e)}:void 0,onMouseUp:X&&re?function(e){return re(h,o,e)}:void 0},o)})]}),c),ae&&ie.length>0&&n(M,{anchorRef:ce,actions:ie,item:i,index:a,onDismiss:G})]})}function N(t){var r=t.data,i=t.columns,a=t.paginatedGroups,c=t.currentGroupBy,u=t.expandedGroups,s=t.selectionMode,d=t.selectedItems,h=t.activeItemIndex,f=t.focusedRowIndex,g=t.enableRowReorder,p=t.draggedRowIndex,m=t.dragOverRowIndex,v=t.isDragging,y=t.columnWidths,w=t.pinnedColumns,b=t.lastLeftPinnedColumnKey,C=t.firstRightPinnedColumnKey,k=t.showTooltip,x=t.onRenderRow,R=t.getItemKey,I=t.onItemClick,M=t.onItemContextMenu,N=t.onCheckboxChange,E=t.onCellEditStart,P=t.onRowDragStart,L=t.onRowDragOver,K=t.onRowDragLeave,T=t.onRowDrop,F=t.onRowDragEnd,A=t.renderCell,O=t.getCellText,B=t.getLeftOffset,_=t.getRightOffset,z=t.toggleGroup,H=t.filteredData,V=t.pagedData,W=t.rowActions,U=t.openMenuKey,j=t.onMenuToggle,Y=t.onMenuDismiss,G=t.enableCellSelection,q=void 0!==G&&G,X=t.isCellSelected,J=t.getCellRangeInfo,Q=t.isRowAboveRange,Z=t.isColumnInRange,$=t.getColumnRangeInfo,ee=t.onCellMouseDown,ne=t.onCellMouseEnter,te=t.onCellMouseUp,oe=c?i.find(function(e){return e.key===c}):null,re=(null==oe?void 0:oe.label)||(c?String(c):"");return n("tbody",{children:c&&a?a.map(function(t){var a=l(t,2),f=a[0],G=a[1],oe=u.has(f);return e(o.Fragment,{children:[n(S,{groupKey:f,groupLabel:re,rowCount:G.length,isExpanded:oe,onToggle:function(){return z(f)},colSpan:i.length+("none"!==s?1:0)+(W?1:0)}),oe&&G.map(function(e,t){var l=r.findIndex(function(n){return n===e}),a=l>=0?l:H.findIndex(function(n){return n===e}),u=l>=0?l:a>=0?a:t,f=V.findIndex(function(n){return n===e}),S=f>=0?f:t,z=R(e,u),G=d.has(z),oe=l>=0&&h===l,re=H.findIndex(function(n){return n===e}),le=re>=0?re:u,ie=g&&!c;return x?n(o.Fragment,{children:x(e,u,i)},z):n(D,{item:e,index:u,itemKey:z,columns:i,selectionMode:s,isSelected:G,isActive:oe,isFocused:!1,isDragging:p===le,isDragOver:m===le,canDrag:ie,columnWidths:y,pinnedColumns:w,lastLeftPinnedColumnKey:b,firstRightPinnedColumnKey:C,showTooltip:k,onItemClick:I,onItemContextMenu:M,onCheckboxChange:N,onCellEditStart:E,onDragStart:P,onDragOver:L,onDragLeave:K,onDrop:T,onDragEnd:F,dragIndex:le,renderCell:A,getCellText:O,getLeftOffset:B,getRightOffset:_,isDraggingState:v,rowActions:W,openMenuKey:U,onMenuToggle:j,onMenuDismiss:Y,enableCellSelection:q,cellSelectionIndex:S,isCellSelected:X,getCellRangeInfo:J,isRowAboveRange:!!Q&&Q(S),isColumnInRange:Z,getColumnRangeInfo:$,onCellMouseDown:ee,onCellMouseEnter:ne,onCellMouseUp:te},z)})]},f)}):V.map(function(e,t){var r=R(e,t),l=d.has(r),a=h===t,u=e===H[t]?t:H.findIndex(function(n){return n===e}),S=u>=0?u:t,z=g&&!c;return x?n(o.Fragment,{children:x(e,t,i)},r):n(D,{item:e,index:t,itemKey:r,columns:i,selectionMode:s,isSelected:l,isActive:a,isFocused:f===t,isDragging:p===S,isDragOver:m===S,canDrag:z,columnWidths:y,pinnedColumns:w,lastLeftPinnedColumnKey:b,firstRightPinnedColumnKey:C,showTooltip:k,onItemClick:I,onItemContextMenu:M,onCheckboxChange:N,onCellEditStart:E,onDragStart:P,onDragOver:L,onDragLeave:K,onDrop:T,onDragEnd:F,dragIndex:S,renderCell:A,getCellText:O,getLeftOffset:B,getRightOffset:_,isDraggingState:v,rowActions:W,openMenuKey:U,onMenuToggle:j,onMenuDismiss:Y,enableCellSelection:q,cellSelectionIndex:t,isCellSelected:X,getCellRangeInfo:J,isRowAboveRange:!!Q&&Q(t),isColumnInRange:Z,getColumnRangeInfo:$,onCellMouseDown:ee,onCellMouseEnter:ne,onCellMouseUp:te},r)})})}function E(t){var o=t.columns,l=t.selectionMode,i=t.columnTotals,a=t.pinnedColumns,c=t.columnWidths,u=t.lastLeftPinnedColumnKey,s=t.firstRightPinnedColumnKey,d=t.totalCount,h=t.getLeftOffset,f=t.getRightOffset;return Object.values(i).some(function(e){return"count"===e})?n("tfoot",r({className:"hh-totals-sticky"},{children:e("tr",r({className:"hh-totals-row"},{children:["none"!==l&&n("td",{className:"hh-selection-column"}),o.map(function(e){var t=String(e.key),l=i[t]||"none",g=a[t]||e.pinned||null,p=o.findIndex(function(e){return String(e.key)===t}),m="left"===g?h(e,p):0,v="right"===g?f(e,p):0,y=c[t],w=r(r({textAlign:e.align,width:y?"".concat(y,"px"):e.width,position:g?"sticky":"relative"},"left"===g?{left:"".concat(m,"px"),zIndex:11}:{}),"right"===g?{right:"".concat(v,"px"),zIndex:11}:{}),b=[g?"hh-cell-pinned hh-pinned-".concat(g):"","left"===g&&e.key===u?"hh-pinned-last-left":"","right"===g&&e.key===s?"hh-pinned-first-right":""].filter(Boolean).join(" "),C="";return"count"===l&&(C="Count: ".concat(d.toLocaleString())),n("td",r({style:w,className:b},{children:C}),t)})]}))})):null}function P(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function L(e,n,t,o){void 0===o&&(o="export"),"csv"===e?function(e,n,t){void 0===t&&(t="export");var o=i([n.map(function(e){return e.label}).join(",")],l(e.map(function(e){return n.map(function(n){var t=e[n.key];if(null==t)return"";var o=String(t);return o.includes(",")||o.includes('"')||o.includes("\n")?'"'.concat(o.replace(/"/g,'""'),'"'):o}).join(",")})),!1).join("\n"),r=new Blob(["\ufeff"+o],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),c=URL.createObjectURL(r);a.setAttribute("href",c),a.setAttribute("download","".concat(t,".csv")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(c)}(n,t,o):function(e,n,t){void 0===t&&(t="export");var o=n.map(function(e){return e.label}),r=e.map(function(e){return n.map(function(n){var t=e[n.key];return null==t?"":t})}),l='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n';l+="<head>\n",l+='<meta charset="utf-8">\n',l+="\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Sheet1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e\n",l+="</head>\n",l+="<body>\n",l+="<table>\n",l+="<tr>\n",o.forEach(function(e){l+="<th>".concat(P(String(e)),"</th>\n")}),l+="</tr>\n",r.forEach(function(e){l+="<tr>\n",e.forEach(function(e){var n=null==e?"":String(e);l+="number"==typeof e?'<td style="mso-number-format:General">'.concat(n,"</td>\n"):"<td>".concat(P(n),"</td>\n")}),l+="</tr>\n"}),l+="</table>\n",l+="</body>\n",l+="</html>";var i=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=document.createElement("a"),c=URL.createObjectURL(i);a.setAttribute("href",c),a.setAttribute("download","".concat(t,".xlsx")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(c)}(n,t,o)}function K(t){var i=t.data,a=t.columns,c=t.format,u=t.filename,s=t.onBeforeExport,d=t.onAfterExport,h=l(o.useState(!1),2),f=h[0],g=h[1],p=o.useCallback(function(e){g(!0);try{var n=a.filter(function(e){return e.key&&e.label}).map(function(e){return{key:e.key,label:e.label}}),t=i;if(s){var o=s(i,a);o?L(e,t=o.data,o.columns.filter(function(e){return e.key&&e.label}).map(function(e){return{key:e.key,label:e.label}}),u):L(e,t,n,u)}else L(e,t,n,u);null==d||d(e,u)}catch(e){console.error("Export failed:",e)}finally{g(!1)}},[i,a,u,s,d]);return"both"===c?e("div",r({className:"hh-export-buttons"},{children:[e("button",r({className:"hh-export-button",onClick:function(){return p("csv")},disabled:f,title:"Export to CSV"},{children:[n(m,{width:16,height:16}),n("span",{children:"CSV"})]})),e("button",r({className:"hh-export-button",onClick:function(){return p("excel")},disabled:f,title:"Export to Excel"},{children:[n(m,{width:16,height:16}),n("span",{children:"Excel"})]}))]})):e("button",r({className:"hh-export-button",onClick:function(){return p(c)},disabled:f,title:"Export to ".concat("csv"===c?"CSV":"Excel")},{children:[n(m,{width:16,height:16}),n("span",{children:"csv"===c?"CSV":"Excel"})]}))}var T={mode:"light",colors:{background:"#ffffff",surface:"#ffffff",headerBackground:"#faf9f8",rowBackground:"#ffffff",rowBackgroundAlternate:"#f9f9f9",selectedRowBackground:"#edebe9",hoverRowBackground:"#f3f2f1",groupHeaderBackground:"#f3f2f1",text:"#323130",textSecondary:"#605e5c",headerText:"#323130",rowText:"#323130",selectedRowText:"#323130",border:"#edebe9",borderLight:"#f1f1f1",rowBorder:"#f1f1f1",focus:"#107c10",focusBorder:"#107c10",hover:"#f3f2f1",active:"#edebe9",disabled:"#a19f9d",primary:"#107c10",success:"#107c10",warning:"#ffaa44",error:"#d13438"},spacing:{cellPadding:"10px 12px",headerPadding:"10px 12px",rowHeight:"auto",rowHeightCompact:"32px",rowHeightSpacious:"56px",gap:"8px"},typography:{fontFamily:'"Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif',fontSize:"14px",fontSizeSmall:"12px",fontSizeLarge:"16px",fontWeight:"400",fontWeightBold:"600",lineHeight:"20px"},borderRadius:{table:"8px",cell:"0",button:"2px"},shadows:{table:"0 2px 8px rgba(0,0,0,0.08)",header:"none",callout:"0 3.2px 7.2px rgba(0, 0, 0, 0.132), 0 0.6px 1.8px rgba(0, 0, 0, 0.108)",panel:"-2px 0 8px rgba(0, 0, 0, 0.15), -1px 0 2px rgba(0, 0, 0, 0.1)"},transitions:{duration:"0.1s",easing:"cubic-bezier(0.1, 0.9, 0.2, 1)"}},F={mode:"dark",colors:{background:"#1a1a1a",surface:"#252526",headerBackground:"#2d2d30",rowBackground:"#252526",rowBackgroundAlternate:"#2d2d30",selectedRowBackground:"#3e3e42",hoverRowBackground:"#2d2d30",groupHeaderBackground:"#2d2d30",text:"#cccccc",textSecondary:"#858585",headerText:"#cccccc",rowText:"#cccccc",selectedRowText:"#ffffff",border:"#3e3e42",borderLight:"#2d2d30",rowBorder:"#3e3e42",focus:"#4ec9b0",focusBorder:"#4ec9b0",hover:"#2d2d30",active:"#3e3e42",disabled:"#858585",primary:"#4ec9b0",success:"#4ec9b0",warning:"#dcdcaa",error:"#f48771"},spacing:{cellPadding:"10px 12px",headerPadding:"10px 12px",rowHeight:"auto",rowHeightCompact:"32px",rowHeightSpacious:"56px",gap:"8px"},typography:{fontFamily:'"Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif',fontSize:"14px",fontSizeSmall:"12px",fontSizeLarge:"16px",fontWeight:"400",fontWeightBold:"600",lineHeight:"20px"},borderRadius:{table:"8px",cell:"0",button:"2px"},shadows:{table:"0 2px 8px rgba(0,0,0,0.3)",header:"none",callout:"0 3.2px 7.2px rgba(0, 0, 0, 0.4), 0 0.6px 1.8px rgba(0, 0, 0, 0.3)",panel:"-2px 0 8px rgba(0, 0, 0, 0.4), -1px 0 2px rgba(0, 0, 0, 0.3)"},transitions:{duration:"0.1s",easing:"cubic-bezier(0.1, 0.9, 0.2, 1)"}};function A(e){if(!e)return T;if("string"==typeof e)return"dark"===e?F:T;var n="dark"===e.mode?F:T;return r(r(r({},n),e),{colors:r(r({},n.colors),e.colors),spacing:e.spacing?r(r({},n.spacing),e.spacing):n.spacing,typography:e.typography?r(r({},n.typography),e.typography):n.typography,borderRadius:e.borderRadius?r(r({},n.borderRadius),e.borderRadius):n.borderRadius,shadows:e.shadows?r(r({},n.shadows),e.shadows):n.shadows,transitions:e.transitions?r(r({},n.transitions),e.transitions):n.transitions})}function O(e){var n=e.colors,t=e.spacing,o=e.typography,r=e.borderRadius,l=e.shadows,i=e.transitions;return{"--hh-color-background":n.background,"--hh-color-surface":n.surface,"--hh-color-header-background":n.headerBackground,"--hh-color-row-background":n.rowBackground,"--hh-color-row-background-alternate":n.rowBackgroundAlternate,"--hh-color-selected-row-background":n.selectedRowBackground,"--hh-color-hover-row-background":n.hoverRowBackground,"--hh-color-group-header-background":n.groupHeaderBackground,"--hh-color-text":n.text,"--hh-color-text-secondary":n.textSecondary,"--hh-color-header-text":n.headerText,"--hh-color-row-text":n.rowText,"--hh-color-selected-row-text":n.selectedRowText,"--hh-color-border":n.border,"--hh-color-border-light":n.borderLight,"--hh-color-row-border":n.rowBorder,"--hh-color-focus":n.focus,"--hh-color-focus-border":n.focusBorder,"--hh-color-hover":n.hover,"--hh-color-active":n.active,"--hh-color-disabled":n.disabled,"--hh-color-primary":n.primary,"--hh-color-success":n.success,"--hh-color-warning":n.warning,"--hh-color-error":n.error,"--hh-spacing-cell-padding":null==t?void 0:t.cellPadding,"--hh-spacing-header-padding":null==t?void 0:t.headerPadding,"--hh-spacing-row-height":null==t?void 0:t.rowHeight,"--hh-spacing-row-height-compact":null==t?void 0:t.rowHeightCompact,"--hh-spacing-row-height-spacious":null==t?void 0:t.rowHeightSpacious,"--hh-spacing-gap":null==t?void 0:t.gap,"--hh-typography-font-family":null==o?void 0:o.fontFamily,"--hh-typography-font-size":null==o?void 0:o.fontSize,"--hh-typography-font-size-small":null==o?void 0:o.fontSizeSmall,"--hh-typography-font-size-large":null==o?void 0:o.fontSizeLarge,"--hh-typography-font-weight":null==o?void 0:o.fontWeight,"--hh-typography-font-weight-bold":null==o?void 0:o.fontWeightBold,"--hh-typography-line-height":null==o?void 0:o.lineHeight,"--hh-border-radius-table":null==r?void 0:r.table,"--hh-border-radius-cell":null==r?void 0:r.cell,"--hh-border-radius-button":null==r?void 0:r.button,"--hh-shadow-table":null==l?void 0:l.table,"--hh-shadow-header":null==l?void 0:l.header,"--hh-shadow-callout":null==l?void 0:l.callout,"--hh-shadow-panel":null==l?void 0:l.panel,"--hh-transition-duration":null==i?void 0:i.duration,"--hh-transition-easing":null==i?void 0:i.easing}}var B=function(t){var i=t.value,a=t.options,c=t.placeholder,u=void 0===c?"Select...":c,s=t.onChange;t.onBlur;var d=t.onKeyDown;t.onSave;var h=t.className,f=void 0===h?"":h,g=t.hasError,p=void 0!==g&&g,m=t.enableCellSelection,v=void 0!==m&&m,y=t.autoFocus,w=void 0!==y&&y,b=t.onDismissCallout,C=l(o.useState(!1),2),k=C[0],x=C[1],S=l(o.useState(-1),2),R=S[0],I=S[1],M=l(o.useState(null),2),D=M[0],N=M[1],E=l(o.useState(i||""),2),P=E[0],L=E[1],K=o.useRef(null),T=o.useRef(null),F=o.useRef(null),A=o.useRef(i||"");o.useEffect(function(){i!==A.current&&(A.current=i||"",L(i||""))},[i]);var O=o.useMemo(function(){return a.find(function(e){return e.key===P})},[a,P]),B=o.useRef(!1);o.useEffect(function(){if(w&&T.current&&!B.current){T.current.focus();var e=T.current.getBoundingClientRect();N({top:e.bottom+window.scrollY+2,left:e.left+window.scrollX,width:e.width}),x(!0),B.current=!0}},[w]),o.useEffect(function(){if(k&&T.current&&F.current){var e=function(){if(T.current&&F.current){var e=T.current.getBoundingClientRect(),n=F.current.offsetHeight||200,t=window.innerHeight-e.bottom,o=e.top;N(t<n&&o>t?{top:e.top+window.scrollY-n-2,left:e.left+window.scrollX,width:e.width}:{top:e.bottom+window.scrollY+2,left:e.left+window.scrollX,width:e.width})}};return window.addEventListener("scroll",e,!0),window.addEventListener("resize",e),setTimeout(e,0),function(){window.removeEventListener("scroll",e,!0),window.removeEventListener("resize",e)}}},[k]),o.useEffect(function(){var e=function(e){F.current&&!F.current.contains(e.target)&&K.current&&!K.current.contains(e.target)&&(x(!1),I(-1),N(null))};if(k)return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}},[k]);var _=v?"hh-fluent-dropdown-button hh-fluent-dropdown-button-excel ".concat(p?"hh-fluent-dropdown-error":""):"hh-fluent-dropdown-button ".concat(p?"hh-fluent-dropdown-error":"");return e("div",r({className:"hh-fluent-dropdown-container ".concat(f),ref:K},{children:[e("button",r({ref:T,type:"button",className:_,onClick:function(){if(!k&&T.current){var e=T.current.getBoundingClientRect();N({top:e.bottom+window.scrollY+2,left:e.left+window.scrollX,width:e.width});var n=a.filter(function(e){return!e.disabled}).findIndex(function(e){return e.key===P});I(n>=0?n:0)}x(!k)},onBlur:function(e){K.current&&K.current.contains(e.relatedTarget)||(x(!1),I(-1),N(null))},onKeyDown:function(e){if(d&&d(e),"Escape"===e.key)return x(!1),I(-1),N(null),void(T.current&&T.current.focus());if(k)if("ArrowDown"===e.key){e.preventDefault();var n=(r=a.filter(function(e){return!e.disabled})).findIndex(function(e){return e.key===i})+1;n>=r.length&&(n=0),I(n),F.current&&(t=F.current.children[n])&&t.scrollIntoView({block:"nearest"})}else if("ArrowUp"===e.key){e.preventDefault();var t,o=(r=a.filter(function(e){return!e.disabled})).findIndex(function(e){return e.key===i})-1;o<0&&(o=r.length-1),I(o),F.current&&(t=F.current.children[o])&&t.scrollIntoView({block:"nearest"})}else if("Enter"===e.key||" "===e.key){e.preventDefault();var r=a.filter(function(e){return!e.disabled});if(R>=0&&R<r.length){var l=r[R].key;L(l),s(l),x(!1),I(-1),N(null),T.current&&T.current.focus()}}else"Tab"===e.key&&(x(!1),I(-1),N(null));else"Enter"!==e.key&&" "!==e.key&&"ArrowDown"!==e.key&&"ArrowUp"!==e.key||(e.preventDefault(),x(!0),I(0))},"aria-expanded":k,"aria-haspopup":"listbox"},{children:[n("span",r({className:"hh-fluent-dropdown-text ".concat(O?"":"hh-fluent-dropdown-text-placeholder")},{children:O?O.text:u})),n("span",r({className:"hh-fluent-dropdown-chevron ".concat(k?"hh-fluent-dropdown-chevron-open":"")},{children:"â–¼"}))]})),k&&D&&n("div",r({className:"hh-fluent-dropdown-list",ref:F,role:"listbox",style:{top:"".concat(D.top,"px"),left:"".concat(D.left,"px"),width:"".concat(D.width,"px")}},{children:a.map(function(e,t){var o=a.filter(function(e){return!e.disabled}).findIndex(function(n){return n.key===e.key}),l=o===R&&!e.disabled,i=e.key===P;return n("div",r({className:"hh-fluent-dropdown-option ".concat(e.disabled?"hh-fluent-dropdown-option-disabled":""," ").concat(l?"hh-fluent-dropdown-option-focused":""," ").concat(i?"hh-fluent-dropdown-option-selected":""),onClick:function(n){var t;n.preventDefault(),n.stopPropagation(),e.disabled||(t=e.key,L(t),s(t),b&&b(),x(!1),I(-1),N(null),setTimeout(function(){T.current&&T.current.focus()},0))},onMouseDown:function(e){e.preventDefault()},onMouseEnter:function(){return!e.disabled&&I(o)},role:"option","aria-selected":i,"aria-disabled":e.disabled},{children:e.text}),e.key)})}))]}))},_=function(t){var i=t.value,a=t.placeholder,c=void 0===a?"Select date...":a,u=t.onChange,s=t.onBlur,d=t.onKeyDown;t.onSave;var h=t.className,f=void 0===h?"":h,g=t.hasError,p=void 0!==g&&g,m=t.enableCellSelection,v=void 0!==m&&m,y=t.autoFocus,w=void 0!==y&&y,b=t.onDismissCallout,C=l(o.useState(!1),2),k=C[0],x=C[1],S=l(o.useState(null),2),R=S[0],I=S[1],M=l(o.useState(function(){if(i){var e=new Date(i);return isNaN(e.getTime())?new Date:e}return new Date}),2),D=M[0],N=M[1],E=o.useRef(null),P=o.useRef(null),L=o.useRef(null),K=o.useRef(null),T=o.useMemo(function(){if(!i)return null;var e=new Date(i);return isNaN(e.getTime())?null:e},[i]);o.useMemo(function(){if(!T)return"";var e=T.getFullYear(),n=String(T.getMonth()+1).padStart(2,"0"),t=String(T.getDate()).padStart(2,"0");return"".concat(e,"-").concat(n,"-").concat(t)},[T]),o.useMemo(function(){if(!T)return"";var e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][T.getMonth()],n=T.getDate(),t=T.getFullYear();return"".concat(e," ").concat(n,", ").concat(t)},[T]);var F=function(e,n){return e.getFullYear()===n.getFullYear()&&e.getMonth()===n.getMonth()&&e.getDate()===n.getDate()},A=o.useMemo(function(){var e=[],n=function(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()}(D),t=function(e){return new Date(e.getFullYear(),e.getMonth(),1).getDay()}(D),o=new Date,r=0===t?0:t;if(r>0)for(var l=0===D.getMonth()?D.getFullYear()-1:D.getFullYear(),i=0===D.getMonth()?11:D.getMonth()-1,a=new Date(l,i+1,0).getDate(),c=a-r+1;c<=a;c++)(u=new Date(l,i,c)).getFullYear()===l&&u.getMonth()===i&&u.getDate()===c&&e.push({date:u,isCurrentMonth:!1,isSelected:null!=T&&F(u,T),isToday:F(u,o)});for(c=1;c<=n;c++){var u=new Date(D.getFullYear(),D.getMonth(),c);e.push({date:u,isCurrentMonth:!0,isSelected:null!=T&&F(u,T),isToday:F(u,o)})}var s=42-e.length;for(c=1;c<=s;c++)u=new Date(D.getFullYear(),D.getMonth()+1,c),e.push({date:u,isCurrentMonth:!1,isSelected:null!=T&&F(u,T),isToday:F(u,o)});return e},[D,T]),O=o.useRef(!1);o.useEffect(function(){if(w&&P.current&&!O.current){if(P.current.focus(),P.current.select(),P.current){var e=P.current.getBoundingClientRect();I({top:e.bottom+window.scrollY+2,left:e.left+window.scrollX,width:e.width}),x(!0)}O.current=!0}},[w]),o.useEffect(function(){if(k&&R){var e=function(){if(P.current&&K.current){var e=P.current.getBoundingClientRect(),n=K.current.offsetHeight||300,t=window.innerHeight-e.bottom,o=e.top;I(t<n&&o>t?{top:e.top+window.scrollY-n-2,left:e.left+window.scrollX,width:e.width}:{top:e.bottom+window.scrollY+2,left:e.left+window.scrollX,width:e.width})}};return window.addEventListener("scroll",e,!0),window.addEventListener("resize",e),setTimeout(e,0),function(){window.removeEventListener("scroll",e,!0),window.removeEventListener("resize",e)}}},[k,R]),o.useEffect(function(){if(k){var e=function(e){E.current&&!E.current.contains(e.target)&&K.current&&!K.current.contains(e.target)&&(x(!1),I(null))};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}},[k]);var B=function(e){N(function(n){var t=new Date(n);return"prev"===e?t.setMonth(n.getMonth()-1):t.setMonth(n.getMonth()+1),t})},_=o.useMemo(function(){if(!T)return"";var e=String(T.getDate()).padStart(2,"0"),n=String(T.getMonth()+1).padStart(2,"0"),t=T.getFullYear();return"".concat(e,"/").concat(n,"/").concat(t)},[T]),z=l(o.useState(_),2),H=z[0],V=z[1];o.useEffect(function(){V(_)},[_]);var W=function(e){var n=e.replace(/[^\d/]/g,"").split("/");if(3!==n.length)return null;var t=parseInt(n[0],10),o=parseInt(n[1],10)-1,r=parseInt(n[2],10);if(isNaN(t)||isNaN(o)||isNaN(r))return null;if(t<1||t>31)return null;if(o<0||o>11)return null;if(r<1900||r>2100)return null;var l=new Date(r,o,t);return l.getDate()!==t||l.getMonth()!==o||l.getFullYear()!==r?null:l},U=v?"hh-fluent-datepicker-input hh-fluent-datepicker-input-excel ".concat(p?"hh-fluent-datepicker-error":""):"hh-fluent-datepicker-input ".concat(p?"hh-fluent-datepicker-error":"");return e("div",r({className:"hh-fluent-datepicker-container ".concat(f),ref:E},{children:[e("div",r({className:"hh-fluent-datepicker-input-wrapper"},{children:[n("input",{ref:P,type:"text",className:U,value:H,onChange:function(e){var n=e.target.value;if(""!==n){var t=(n=n.replace(/[^\d/]/g,"")).split("/"),o=t[0]||"",r=t[1]||"",l=t[2]||"";if(2!==o.length||""!==r||n.includes("/"))if(2===o.length&&1===r.length&&""===l){var i=parseInt(r,10);i>=1&&i<=9&&(n=o+"/"+String(i).padStart(2,"0")+"/")}else 2===o.length&&2===r.length&&""===l&&2===n.split("/").length&&(n=o+"/"+r+"/");else n=o+"/";if(n.length>10&&(n=n.substring(0,10)),V(n),10===n.length){var a=W(n);if(a){var c=a.getFullYear(),s=String(a.getMonth()+1).padStart(2,"0"),d=String(a.getDate()).padStart(2,"0"),h="".concat(c,"-").concat(s,"-").concat(d);u(h)}}}else V("")},onBlur:function(e){var n=W(H);if(n){var t=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),r=String(n.getDate()).padStart(2,"0"),l="".concat(t,"-").concat(o,"-").concat(r);u(l)}else H&&H.length>0&&V(_);s&&s()},onKeyDown:function(e){var n,t;if(d&&d(e),"Enter"===e.key){e.preventDefault();var o=W(H);if(o){var r=o.getFullYear(),l=String(o.getMonth()+1).padStart(2,"0"),i=String(o.getDate()).padStart(2,"0"),a="".concat(r,"-").concat(l,"-").concat(i);u(a)}null===(n=P.current)||void 0===n||n.blur()}else"Escape"===e.key&&(x(!1),I(null),V(_),null===(t=P.current)||void 0===t||t.blur())},placeholder:c||"dd/mm/yyyy",onClick:function(e){e.stopPropagation()}}),n("button",r({ref:L,type:"button",className:"hh-fluent-datepicker-icon-button",onClick:function(){if(k)x(!1),I(null);else{if(P.current){var e=P.current.getBoundingClientRect();I({top:e.bottom+window.scrollY+2,left:e.left+window.scrollX,width:e.width})}x(!0)}},onBlur:function(e){E.current&&E.current.contains(e.relatedTarget)||K.current&&K.current.contains(e.relatedTarget)||(x(!1),I(null))},"aria-expanded":k,"aria-haspopup":"dialog",title:"Open calendar"},{children:n("span",r({className:"hh-fluent-datepicker-icon"},{children:n("svg",r({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",width:"16",height:"16"},{children:n("path",{d:"M768 768h128v128H768V768zm384 768h128v128h-128v-128zm384-768h128v128h-128V768zm-384 0h128v128h-128V768zm-384 256h128v128H768v-128zm-384 0h128v128H384v-128zm1152 0h128v128h-128v-128zm-384 0h128v128h-128v-128zm-384 256h128v128H768v-128zm-384 0h128v128H384v-128zm1152 0h128v128h-128v-128zm-384 0h128v128h-128v-128zm-384 256h128v128H768v-128zm-384 0h128v128H384v-128zM2048 128v1792H0V128h384V0h128v128h1024V0h128v128h384zM128 256v256h1792V256h-256v128h-128V256H512v128H384V256H128zm1792 1536V640H128v1152h1792z",fill:"currentColor"})}))}))}))]})),k&&R&&e("div",r({className:"hh-fluent-datepicker-calendar",ref:K,style:{top:"".concat(R.top,"px"),left:"".concat(R.left,"px"),width:"".concat(R.width,"px")}},{children:[e("div",r({className:"hh-fluent-datepicker-header"},{children:[n("button",r({type:"button",className:"hh-fluent-datepicker-nav-button",onClick:function(){return B("prev")},"aria-label":"Previous month"},{children:n("svg",r({width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:n("path",{d:"M7.5 9L4.5 6L7.5 3",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})}))})),e("span",r({className:"hh-fluent-datepicker-month-year"},{children:[["January","February","March","April","May","June","July","August","September","October","November","December"][D.getMonth()]," ",D.getFullYear()]})),n("button",r({type:"button",className:"hh-fluent-datepicker-nav-button",onClick:function(){return B("next")},"aria-label":"Next month"},{children:n("svg",r({width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:n("path",{d:"M4.5 3L7.5 6L4.5 9",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})}))}))]})),n("div",r({className:"hh-fluent-datepicker-today-container"},{children:n("button",r({type:"button",className:"hh-fluent-datepicker-today-button",onClick:function(){var e=new Date;N(e)}},{children:"Today"}))})),n("div",r({className:"hh-fluent-datepicker-days-header"},{children:["S","M","T","W","T","F","S"].map(function(e,t){return n("div",r({className:"hh-fluent-datepicker-day-header"},{children:e}),t)})})),n("div",r({className:"hh-fluent-datepicker-days-grid"},{children:A.map(function(e,t){var o=e.date,l=String(o.getDate()).padStart(2,"0"),i=String(o.getMonth()+1).padStart(2,"0"),a=o.getFullYear(),c="".concat(l,"/").concat(i,"/").concat(a);return n("button",r({type:"button",className:"hh-fluent-datepicker-day ".concat(e.isCurrentMonth?"":"hh-fluent-datepicker-day-other-month"," ").concat(e.isSelected?"hh-fluent-datepicker-day-selected":""," ").concat(e.isToday?"hh-fluent-datepicker-day-today":""),onClick:function(n){n.stopPropagation(),function(e){var n=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0"),r="".concat(n,"-").concat(t,"-").concat(o);u(r),b&&b(),x(!1),I(null),setTimeout(function(){L.current&&L.current.focus()},0)}(e.date)},onMouseEnter:function(e){e.stopPropagation()},onMouseOver:function(e){e.stopPropagation()},title:c,disabled:!e.isCurrentMonth},{children:e.date.getDate()}),"".concat(e.date.getTime(),"-").concat(t))})}))]}))]}))};function z(t){var d=t.columns,h=t.data,f=t.itemsPerPage,g=void 0===f?10:f,p=t.groupBy,m=t.onRenderCell,b=t.onRenderRow,C=t.onRenderHeader;t.onItemInvoked;var k=t.onColumnHeaderClick,S=t.getKey,R=t.onActiveItemChanged,I=t.onItemContextMenu,M=t.className,D=t.styles,P=t.selectionMode,L=void 0===P?"none":P,T=t.onSelectionChanged,F=t.showPagination,z=void 0===F||F,H=t.itemsPerPageOptions,V=t.onItemsPerPageChange,W=t.theme,U=t.maxHeight,j=t.onCellEdit,Y=t.pinnedColumns,G=t.onColumnPin,q=t.showTooltip,X=void 0===q||q,J=t.loading,Q=void 0!==J&&J,Z=t.onRenderLoading,$=t.emptyMessage,ee=t.onRenderEmpty,ne=t.stickyHeader,te=void 0!==ne&&ne,oe=t.enableColumnVisibility,re=t.onColumnVisibilityChange,le=t.enableColumnReorder,ie=t.onColumnReorder,ae=t.enableKeyboardNavigation,ce=void 0===ae||ae,ue=t.enableRowReorder,se=void 0!==ue&&ue,de=t.onRowReorder,he=t.enableExport,fe=void 0!==he&&he,ge=t.exportFormat,pe=void 0===ge?"both":ge,me=t.exportFileName,ve=void 0===me?"export":me,ye=t.onBeforeExport,we=t.onAfterExport,be=t.rowActions,Ce=t.enableCellSelection,ke=void 0!==Ce&&Ce;!function(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(t[o[r]]=e[o[r]])}}(t,["columns","data","itemsPerPage","groupBy","onRenderCell","onRenderRow","onRenderHeader","onItemInvoked","onColumnHeaderClick","getKey","onActiveItemChanged","onItemContextMenu","className","styles","selectionMode","onSelectionChanged","showPagination","itemsPerPageOptions","onItemsPerPageChange","theme","maxHeight","onCellEdit","pinnedColumns","onColumnPin","showTooltip","loading","onRenderLoading","emptyMessage","onRenderEmpty","stickyHeader","enableColumnVisibility","onColumnVisibilityChange","enableColumnReorder","onColumnReorder","enableKeyboardNavigation","enableRowReorder","onRowReorder","enableExport","exportFormat","exportFileName","onBeforeExport","onAfterExport","rowActions","enableCellSelection"]);var xe=l(o.useState(g),2),Se=xe[0],Re=xe[1],Ie=l(o.useState(h),2),Me=Ie[0],De=Ie[1];o.useEffect(function(){De(h)},[h]),o.useEffect(function(){Re(g)},[g]);var Ne=z?H||[10,25,50,100]:H,Ee=o.useCallback(function(e){Re(e),V&&V(e)},[V]),Pe=z?Se:Number.MAX_SAFE_INTEGER,Le=Me,Ke=a(Le,Pe),Te=o.useRef({}),Fe=o.useRef(null),Ae=l(o.useState({}),2),Oe=Ae[0],Be=Ae[1],_e=l(o.useState(null),2),ze=_e[0],He=_e[1],Ve=l(o.useState(null),2),We=Ve[0],Ue=Ve[1],je=l(o.useState(p),2),Ye=je[0],Ge=je[1];o.useEffect(function(){void 0!==p&&Ge(p)},[p]);var qe=void 0!==p?p:Ye,Xe=l(o.useState(new Set),2),Je=Xe[0],Qe=Xe[1],Ze=o.useMemo(function(){return{key:"__rowNumber__",label:"STT",width:"80px",align:"center",sortable:!1,filterable:!1,resizable:!1,editable:!1,pinned:"left",showCallout:!1,onRenderCell:function(e,n,t){return(Ke.currentPage-1)*Ke.itemsPerPage+t+1}}},[Ke.currentPage,Ke.itemsPerPage]),$e=function(e,n,t,a,c,u,s){var d=l(o.useState(n||{}),2),h=d[0],f=d[1],g=l(o.useState(new Set(e.map(function(e){return e.key}))),2),p=g[0],m=g[1],v=l(o.useState(e.map(function(e){return e.key})),2),y=v[0],w=v[1],b=l(o.useState(null),2),C=b[0],k=b[1],x=l(o.useState(null),2),S=x[0],R=x[1];o.useEffect(function(){t&&a&&a(Array.from(p))},[p,t,a]),o.useEffect(function(){c&&u&&u(y)},[y,c,u]);var I=o.useCallback(function(e){m(function(n){var t=new Set(n);return t.has(e)?t.delete(e):t.add(e),t})},[]),M=o.useCallback(function(e,n){f(function(t){var o=r({},t);return null===n?delete o[String(e)]:o[String(e)]=n,o}),s&&s(e,n)},[s]),D=o.useCallback(function(e){c&&k(e)},[c]),N=o.useCallback(function(e,n){c&&C&&C!==n&&(e.preventDefault(),R(n))},[c,C]),E=o.useCallback(function(e){c&&C&&C!==e&&(w(function(n){var t=i([],l(n),!1),o=t.indexOf(C),r=t.indexOf(e);return t.splice(o,1),t.splice(r,0,C),t}),k(null),R(null))},[c,C]),P=o.useMemo(function(){return t?e.filter(function(e){return p.has(e.key)}):e},[e,p,t]),L=o.useMemo(function(){if(!c)return P;var e=new Map(y.map(function(e,n){return[e,n]}));return i([],l(P),!1).sort(function(n,t){var o,r;return(null!==(o=e.get(n.key))&&void 0!==o?o:1/0)-(null!==(r=e.get(t.key))&&void 0!==r?r:1/0)})},[P,y,c]),K=o.useMemo(function(){var e=[],n=[],t=[];return L.forEach(function(o){var r=h[String(o.key)]||o.pinned||null;"left"===r?e.push(o):"right"===r?t.push(o):n.push(o)}),i(i(i([],l(e),!1),l(n),!1),l(t),!1)},[L,h]);return{internalPinnedColumns:h,visibleColumns:p,columnOrder:y,draggedColumn:C,dragOverColumn:S,sortedColumns:K,handleToggleColumnVisibility:I,handleColumnPin:M,handleColumnDragStart:D,handleColumnDragOver:N,handleColumnDrop:E}}(o.useMemo(function(){return ke&&!d.some(function(e){return"__rowNumber__"===String(e.key)})?i([Ze],l(d),!1):d},[ke,d,Ze]),Y,oe,re,le,ie,G),en=$e.internalPinnedColumns,nn=$e.dragOverColumn,tn=$e.sortedColumns,on=$e.handleToggleColumnVisibility,rn=$e.handleColumnPin,ln=$e.handleColumnDragStart,an=$e.handleColumnDragOver,cn=$e.handleColumnDrop,un=function(e,n,t,r,a){var c=l(o.useState(new Set),2),u=c[0],s=c[1],d=l(o.useState(void 0),2),h=d[0],f=d[1],g=o.useCallback(function(e,n){return a?a(e,n):void 0!==e.id?e.id:n},[a]),p=o.useCallback(function(o,l,i){var a=g(o,l);s(function(o){var r=new Set(o);if("single"===n?(r.clear(),i&&r.add(a)):"multiple"===n&&(i?r.add(a):r.delete(a)),t){var l=e.filter(function(e,n){return r.has(g(e,n))});t(l)}return r}),f(l),r&&r(o,l)},[n,g,t,r,e]),m=o.useCallback(function(o,l,i){if(!i.target.closest(".hh-selection-checkbox")){if("none"!==n){var a=g(o,l);s(function(o){var r=new Set(o);if("single"===n?(r.clear(),r.add(a)):"multiple"===n&&(i.ctrlKey||i.metaKey?r.has(a)?r.delete(a):r.add(a):(r.clear(),r.add(a))),t){var l=e.filter(function(e,n){return r.has(g(e,n))});t(l)}return r})}f(l),r&&r(o,l)}},[n,g,t,r,e]),v=o.useCallback(function(o){"multiple"===n&&s(function(n){var r=o?new Set(e.map(function(e,n){return g(e,n)})):new Set;if(t){var a=o?i([],l(e),!1):[];t(a)}return r})},[n,e,g,t]),y=o.useMemo(function(){return"multiple"===n&&0!==e.length&&e.every(function(e,n){return u.has(g(e,n))})},[n,e,u,g]),w=o.useMemo(function(){if("multiple"!==n||0===e.length)return!1;var t=e.filter(function(e,n){return u.has(g(e,n))}).length;return t>0&&t<e.length},[n,e,u,g]),b=o.useCallback(function(e,n){return u.has(g(e,n))},[u,g]);return{selectedItems:u,activeItemIndex:h,isAllSelected:y,isIndeterminate:w,getItemKey:g,handleCheckboxChange:p,handleItemClick:m,handleSelectAll:v,isItemSelected:b,setSelectedItems:s}}(Le,L,T,R,S),sn=un.selectedItems,dn=un.activeItemIndex,hn=un.isAllSelected,fn=un.isIndeterminate,gn=un.getItemKey,pn=un.handleCheckboxChange,mn=un.handleItemClick,vn=un.handleSelectAll,yn=un.setSelectedItems,wn=o.useCallback(function(e,n){var t=gn(e,n),o="".concat(String(t),"-").concat(n);Ue(function(e){return e===o?null:o})},[gn]),bn=o.useCallback(function(){Ue(null)},[]),Cn=function(e){var n=l(o.useState({}),2),t=n[0],i=n[1],a=l(o.useState(null),2),c=a[0],u=a[1],s=l(o.useState(0),2);s[0];var d=s[1],h=l(o.useState(0),2);h[0];var f=h[1],g=o.useCallback(function(n,t){t.preventDefault(),t.stopPropagation();var o=String(n),l=e.current&&e.current[o],a=l&&l.parentElement;if(a){var c=a.offsetWidth,s=t.clientX;u(o),document.body.style.cursor="col-resize",document.body.style.userSelect="none",d(s),f(c);var h=function(e){var n=e.clientX-s,t=Math.max(50,c+n);i(function(e){var n;return r(r({},e),((n={})[o]=t,n))})},g=function(){document.body.style.cursor="",document.body.style.userSelect="",u(null),document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",g)};document.addEventListener("mousemove",h),document.addEventListener("mouseup",g)}},[e,void 0]);return{columnWidths:t,resizingColumn:c,handleResizeStart:g}}(Te),kn=Cn.columnWidths,xn=Cn.resizingColumn,Sn=Cn.handleResizeStart,Rn=function(e){var n=l(o.useState(null),2),t=n[0],r=n[1],i=o.useRef(null),a=o.useCallback(function(n){e||(i.current&&clearTimeout(i.current),i.current=setTimeout(function(){r(n)},150))},[e]),c=o.useCallback(function(){i.current&&clearTimeout(i.current),i.current=setTimeout(function(){r(null)},200)},[]),u=o.useCallback(function(){i.current&&clearTimeout(i.current)},[]),s=o.useCallback(function(){i.current&&clearTimeout(i.current),i.current=setTimeout(function(){r(null)},200)},[]),d=o.useCallback(function(){i.current&&clearTimeout(i.current),r(null)},[]);return o.useEffect(function(){return function(){i.current&&clearTimeout(i.current)}},[]),{calloutKey:t,setCalloutKey:r,handleHeaderMouseEnter:a,handleHeaderMouseLeave:c,handleCalloutMouseEnter:u,handleCalloutMouseLeave:s,dismissCallout:d}}(xn),In=o.useCallback(function(e,n,t){var o=d.find(function(e){return e.key===t});return o&&o.validate&&o.validate(e,n,t)||null},[d]),Mn=o.useCallback(function(e,n,t,o){var a=In(t,e,n);a?console.warn("Validation failed for column ".concat(String(n),": ").concat(a)):(De(function(a){var c,u=i([],l(a),!1),s=u.findIndex(function(n){return n===e}),d=s>=0?s:o;return d>=0&&d<u.length&&(u[d]=r(r({},u[d]),((c={})[n]=t,c))),u}),j&&j(e,n,t,o))},[Me,In,j]),Dn=function(e,n){var t=l(o.useState(null),2),r=t[0],i=t[1],a=l(o.useState(""),2),c=a[0],u=a[1],s=l(o.useState(""),2);s[0];var d=s[1],h=l(o.useState(null),2),f=h[0],g=h[1],p=l(o.useState(null),2),m=p[0],v=p[1],y=o.useRef(null),w=o.useCallback(function(e,n,t){if(!0===n.editable){var o=String(null!=e[n.key]?e[n.key]:"");i({rowIndex:t,columnKey:n.key}),u(o),d(o),v(e),g(null)}},[]),b=o.useCallback(function(t,o,r,l){var a=null==n?void 0:n.find(function(e){return e.key===o}),s=null!=l?String(l):c;if(a&&a.validate){var d=a.validate(s,t,o);if(d)return g(d),!1}return g(null),e&&e(t,o,s,r),i(null),u(""),v(null),!0},[e,c,n]),C=o.useCallback(function(){i(null),u(""),d(""),g(null),v(null)},[]);o.useEffect(function(){r&&y.current&&setTimeout(function(){if(y.current){y.current.focus();var e=y.current.value.length;y.current.setSelectionRange(e,e)}},0)},[r]);var k=o.useRef(null);return o.useEffect(function(){return r&&m&&(k.current&&clearTimeout(k.current),k.current=setTimeout(function(){var e=null==n?void 0:n.find(function(e){return e.key===r.columnKey});if(null==e?void 0:e.validate){var t=e.validate(c,m,r.columnKey);g(t||null)}else g(null)},150)),function(){k.current&&clearTimeout(k.current)}},[c,r,m,n]),{editingCell:r,editValue:c,editInputRef:y,setEditValue:u,validationError:f,handleCellEditStart:w,handleCellEditSave:b,handleCellEditCancel:C}}(Mn,d),Nn=Dn.editingCell,En=Dn.editValue,Pn=Dn.editInputRef,Ln=Dn.setEditValue,Kn=Dn.validationError,Tn=Dn.handleCellEditStart,Fn=Dn.handleCellEditSave,An=Dn.handleCellEditCancel,On=o.useCallback(function(e,n,t){"__rowNumber__"!==String(n.key)&&(Rn.dismissCallout(),Tn(e,n,t))},[Rn,Tn]),Bn=function(e,n,t,r,a){var c=l(o.useState(null),2),u=c[0],s=c[1],d=l(o.useState(null),2),h=d[0],f=d[1],g=l(o.useState(!1),2),p=g[0],m=g[1],v=l(o.useState(null),2),y=v[0],w=v[1],b=y||n;o.useEffect(function(){w(null)},[n]);var C=o.useCallback(function(n,t){e?(n.stopPropagation(),m(!0),s(t),n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text/plain",String(t)),n.currentTarget&&(n.currentTarget.style.opacity="0.5")):n.preventDefault()},[e]),k=o.useCallback(function(n,t){e&&null!==u&&(n.preventDefault(),n.dataTransfer.dropEffect="move",h!==t&&f(t))},[e,u,h]),x=o.useCallback(function(n){e&&(n.currentTarget===n.target||n.currentTarget.contains(n.relatedTarget)||f(null))},[e]),S=o.useCallback(function(n,o){if(!e||null===u||u===o)return s(null),void f(null);if(n.preventDefault(),n.stopPropagation(),r)return s(null),void f(null);var c=i([],l(b),!1),d=t[u],h=t[o],g=c.findIndex(function(e){return e===d}),p=c.findIndex(function(e){return e===h});if(-1===g||-1===p||g===p)return s(null),void f(null);var m=i([],l(c),!1),v=m[g];m.splice(g,1);var y=g<p?p-1:p;m.splice(y,0,v),w(m),a&&a(m,v,g,y),s(null),f(null)},[e,u,r,t,b,a]),R=o.useCallback(function(n){e&&(n.currentTarget&&(n.currentTarget.style.opacity="1"),m(!1),s(null),f(null),setTimeout(function(){m(!1)},100))},[e]);return{draggedRowIndex:u,dragOverRowIndex:h,isDragging:p,reorderedData:y,effectiveData:b,handleRowDragStart:C,handleRowDragOver:k,handleRowDragLeave:x,handleRowDrop:S,handleRowDragEnd:R}}(se,Le,Ke.filtered,qe,de),_n=Bn.draggedRowIndex,zn=Bn.dragOverRowIndex,Hn=Bn.isDragging,Vn=Bn.handleRowDragStart,Wn=Bn.handleRowDragOver,Un=Bn.handleRowDragLeave,jn=Bn.handleRowDrop,Yn=Bn.handleRowDragEnd,Gn=function(e,n,t){void 0===t&&(t=!0);var r=l(o.useState(new Set),2),i=r[0],a=r[1],c=l(o.useState(null),2),u=c[0],s=c[1],d=l(o.useState(!1),2),h=d[0],f=d[1],g=l(o.useState(null),2),p=g[0],m=g[1],v=l(o.useState(!1),2),y=v[0],w=v[1],b=l(o.useState(null),2),C=b[0],k=b[1],x=o.useCallback(function(e,n){return"".concat(e,"-").concat(n)},[]),S=o.useCallback(function(e,t){var o=Math.min(e.rowIndex,t.rowIndex),r=Math.max(e.rowIndex,t.rowIndex),l=n.findIndex(function(n){return String(n.key)===e.colKey}),i=n.findIndex(function(e){return String(e.key)===t.colKey}),a=l>=0?l:0,c=i>=0?i:n.length-1,u=Math.min(a,c),s=Math.max(a,c);return{start:{rowIndex:o,colKey:String(n[Math.max(0,u)]&&n[Math.max(0,u)].key||e.colKey)},end:{rowIndex:r,colKey:String(n[Math.min(n.length-1,s)]&&n[Math.min(n.length-1,s)].key||t.colKey)}}},[n]),R=o.useCallback(function(e){for(var t=[],o=Math.min(e.start.rowIndex,e.end.rowIndex),r=Math.max(e.start.rowIndex,e.end.rowIndex),l=n.findIndex(function(n){return String(n.key)===e.start.colKey}),i=n.findIndex(function(n){return String(n.key)===e.end.colKey}),a=l>=0?l:0,c=i>=0?i:n.length-1,u=Math.min(a,c),s=Math.max(a,c),d=o;d<=r;d++)for(var h=u;h<=s;h++)n[h]&&t.push({rowIndex:d,colKey:String(n[h].key)});return t},[n]),I=o.useCallback(function(e,n,o){if(t){var r={rowIndex:e,colKey:n};if(m(r),f(!0),o&&u){var l=S(u.start,r);s(l);var i=R(l);a(new Set(i.map(function(e){return x(e.rowIndex,e.colKey)})))}else s({start:r,end:r}),a(new Set([x(e,n)]))}},[t,u,S,R,x]),M=o.useCallback(function(e,n){if(t&&h&&p){var o=S(p,{rowIndex:e,colKey:n});s(o);var r=R(o);a(new Set(r.map(function(e){return x(e.rowIndex,e.colKey)})))}},[t,h,p,S,R,x]),D=o.useCallback(function(){f(!1),m(null)},[]),N=o.useCallback(function(){a(new Set),s(null),f(!1),m(null),w(!1)},[]),E=o.useCallback(function(){k(null)},[]),P=o.useCallback(function(e,n){t&&(k({rowIndex:e,colKey:n}),0===i.size&&I(e,n,!1))},[t,i.size,I]),L=o.useCallback(function(o,r){var l;if(void 0===r&&(r=!1),!t)return null;var i=C;if(!i&&u&&(i=u.end),!i){if(!(e.length>0&&n.length>0))return null;i={rowIndex:0,colKey:String(n[0].key)}}var c=i.rowIndex,d=n.findIndex(function(e){return String(e.key)===i.colKey});if(-1===d)return null;var h=c,f=d,g=e.length-1;switch(o){case"up":h=Math.max(0,c-1);break;case"down":h=Math.min(g,c+1);break;case"left":f=Math.max(0,d-1);break;case"right":f=Math.min(n.length-1,d+1)}var m=String(null===(l=n[f])||void 0===l?void 0:l.key);if(!m)return null;var v={rowIndex:h,colKey:m};if(k(v),r){var y=p||(null==u?void 0:u.start)||i,w=S(y,v);s(w);var b=R(w);a(new Set(b.map(function(e){return x(e.rowIndex,e.colKey)})))}else I(h,m,!1);return v},[t,C,u,p,e,n,S,R,x,I]),K=o.useCallback(function(e){w(e)},[]),T=o.useCallback(function(e,n){if(t){var o=S(e,n);s(o);var r=R(o);a(new Set(r.map(function(e){return x(e.rowIndex,e.colKey)}))),f(!1),m(null)}},[t,S,R,x]),F=o.useCallback(function(e,n){return i.has(x(e,n))},[i,x]),A=o.useCallback(function(){return u?R(u):Array.from(i).map(function(e){var n=l(e.split("-"),2),t=n[0],o=n[1];return{rowIndex:parseInt(t,10),colKey:o}})},[u,i,R]),O=o.useCallback(function(){return u},[u]);return{selectedCells:i,selectedRange:u,isSelecting:h,isCopied:y,focusedCell:C,startSelection:I,updateSelection:M,endSelection:D,clearSelection:N,clearFocus:E,setCopied:K,setFocusedCell:P,setSelectionRange:T,moveFocus:L,isCellSelected:F,getSelectedCells:A,getSelectedRange:O}}(Ke.paged,tn,ke),qn=o.useRef(Ke.currentPage);o.useEffect(function(){ke&&qn.current!==Ke.currentPage&&(Gn.clearSelection(),Gn.clearFocus(),qn.current=Ke.currentPage)},[Ke.currentPage,ke,Gn.clearSelection,Gn.clearFocus]);var Xn=function(){var e=this,n=l(o.useState(null),2),t=n[0],r=n[1],a=l(o.useState(!1),2),c=a[0],u=a[1],s=l(o.useState([]),2),d=s[0],h=s[1],f=o.useCallback(function(e,n,t){if(0!==e.length){var o=i([],l(e),!1).sort(function(e,n){return e.rowIndex!==n.rowIndex?e.rowIndex-n.rowIndex:t.findIndex(function(n){return String(n.key)===e.colKey})-t.findIndex(function(e){return String(e.key)===n.colKey})}),a=new Map;o.forEach(function(e){a.has(e.rowIndex)||a.set(e.rowIndex,[]),a.get(e.rowIndex).push(e)});var c=[];a.forEach(function(e,o){var r=[];e.sort(function(e,n){return t.findIndex(function(n){return String(n.key)===e.colKey})-t.findIndex(function(e){return String(e.key)===n.colKey})}),e.forEach(function(e){var t=n[o];if(t){var l=t[e.colKey];r.push(null!=l?String(l):"")}else r.push("")}),c.push(r)}),r(c),u(!1),h([]);var s=c.map(function(e){return e.join("\t")}).join("\n");navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(s).catch(function(){var e=document.createElement("textarea");e.value=s,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)})}},[]),g=o.useCallback(function(e,n,t){f(e,n,t),u(!0),h(e)},[f]),p=o.useCallback(function(e,n,o,r){if(t&&0!==t.length&&0!==e.length){if(1===t.length&&1===t[0].length){var l=t[0][0];e.forEach(function(e){var t=n[e.rowIndex];t&&r(t,e.colKey,l,e.rowIndex)})}else{var i=e[0];if(!i)return;var a=o.findIndex(function(e){return String(e.key)===i.colKey});if(-1===a)return;t.forEach(function(e,t){var l=i.rowIndex+t;if(!(l<0||l>=n.length)){var c=n[l];c&&e.forEach(function(e,n){var t=a+n;if(!(t<0||t>=o.length)){var i=o[t];if(i)try{r(c,i.key,e,l)}catch(e){}}})}})}c&&d.length>0&&(d.forEach(function(e){var t=n[e.rowIndex];t&&r(t,e.colKey,"",e.rowIndex)}),u(!1),h([]))}},[t,c,d]),m=o.useCallback(function(n,t,o,r){return l=e,i=void 0,c=function(){var e,l,i,a,c,u,s;return function(e,n){var t,o,r,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=a(0),i.throw=a(1),i.return=a(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(l=0)),l;)try{if(t=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,o=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!((r=(r=l.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){l=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){l.label=a[1];break}if(6===a[0]&&l.label<r[1]){l.label=r[1],r=a;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(a);break}r[2]&&l.ops.pop(),l.trys.pop();continue}a=n.call(e,l)}catch(e){a=[6,e],o=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,function(d){switch(d.label){case 0:if(0===n.length)return[2,!1];d.label=1;case 1:return d.trys.push([1,5,,6]),e="",navigator.clipboard&&navigator.clipboard.readText?[4,navigator.clipboard.readText()]:[3,3];case 2:return e=d.sent(),[3,4];case 3:return[2,!1];case 4:return e&&0!==e.trim().length?0===(l=e.split(/\r?\n/).filter(function(e){return e.trim().length>0})).length||0===(i=l.map(function(e){for(var n=[],t="",o=!1,r=0;r<e.length;r++){var l=e[r];'"'===l?o&&'"'===e[r+1]?(t+='"',r++):o=!o:"\t"!==l||o?t+=l:(n.push(t),t="")}return n.push(t),n})).length||0===i[0].length?[2,!1]:(n[0],1===i.length&&1===i[0].length?(a=i[0][0],n.forEach(function(e){var n=t[e.rowIndex];n&&r(n,e.colKey,a,e.rowIndex)}),[2,!0]):(c=!1,(u=n[0])?-1===(s=o.findIndex(function(e){return String(e.key)===u.colKey}))?[2,!1]:(i.forEach(function(e,n){var l=u.rowIndex+n;if(!(l<0||l>=t.length)){var i=t[l];i&&e.forEach(function(e,n){var t=s+n;if(!(t<0||t>=o.length)){var a=o[t];if(a)try{r(i,a.key,e,l),c=!0}catch(e){}}})}}),[2,c]):[2,!1])):[2,!1];case 5:return d.sent(),[2,!1];case 6:return[2]}})},new((a=void 0)||(a=Promise))(function(e,n){function t(e){try{r(c.next(e))}catch(e){n(e)}}function o(e){try{r(c.throw(e))}catch(e){n(e)}}function r(n){var r;n.done?e(n.value):(r=n.value,r instanceof a?r:new a(function(e){e(r)})).then(t,o)}r((c=c.apply(l,i||[])).next())});var l,i,a,c},[]),v=o.useCallback(function(){return null!==t&&t.length>0},[t]),y=o.useCallback(function(){return t},[t]),w=o.useCallback(function(){r(null),u(!1),h([])},[]);return{copyCells:f,cutCells:g,pasteCells:p,pasteFromSystemClipboard:m,canPaste:v,getClipboardData:y,clearClipboard:w}}(),Jn=o.useCallback(function(e,n,t){if(ke&&"__rowNumber__"!==n){t.stopPropagation();var o=t.shiftKey;Gn.startSelection(e,n,o),Gn.setFocusedCell(e,n),Gn.setCopied(!1)}},[ke,Gn]),Qn=o.useCallback(function(e,n,t){ke&&Gn.isSelecting&&"__rowNumber__"!==n&&Gn.updateSelection(e,n)},[ke,Gn]),Zn=o.useCallback(function(e,n,t){ke&&"__rowNumber__"!==n&&Gn.endSelection()},[ke,Gn]),$n=o.useCallback(function(e,n){if(!ke)return{isStart:!1,isEnd:!1,isInRange:!1,isTopRow:!1,isBottomRow:!1,isLeftCol:!1,isRightCol:!1,isCopied:!1,isFocused:!1};var t=Gn.focusedCell&&Gn.focusedCell.rowIndex===e&&Gn.focusedCell.colKey===n;if(!Gn.selectedRange)return{isStart:!1,isEnd:!1,isInRange:!1,isTopRow:!1,isBottomRow:!1,isLeftCol:!1,isRightCol:!1,isCopied:!1,isFocused:t};var o=Gn.selectedRange,r=Math.min(o.start.rowIndex,o.end.rowIndex),l=Math.max(o.start.rowIndex,o.end.rowIndex),i=tn.findIndex(function(e){return String(e.key)===o.start.colKey}),a=tn.findIndex(function(e){return String(e.key)===o.end.colKey}),c=Math.min(i>=0?i:0,a>=0?a:tn.length-1),u=Math.max(i>=0?i:0,a>=0?a:tn.length-1),s=tn.findIndex(function(e){return String(e.key)===n});return{isStart:o.start.rowIndex===e&&o.start.colKey===n,isEnd:o.end.rowIndex===e&&o.end.colKey===n,isInRange:Gn.isCellSelected(e,n),isTopRow:e===r,isBottomRow:e===l,isLeftCol:s===c,isRightCol:s===u,isCopied:Gn.isCopied,isFocused:t}},[ke,Gn,tn]),et=o.useCallback(function(e){if(!ke||!Gn.selectedRange)return!1;var n=Gn.selectedRange,t=Math.min(n.start.rowIndex,n.end.rowIndex);return t>0&&e===t-1},[ke,Gn]),nt=o.useCallback(function(){if(!ke||!Gn.selectedRange)return!1;var e=Gn.selectedRange;return 0===Math.min(e.start.rowIndex,e.end.rowIndex)},[ke,Gn]),tt=o.useCallback(function(e){if(!ke||!Gn.selectedRange)return!1;var n=Gn.selectedRange,t=tn.findIndex(function(e){return String(e.key)===n.start.colKey}),o=tn.findIndex(function(e){return String(e.key)===n.end.colKey}),r=Math.min(t>=0?t:0,o>=0?o:tn.length-1),l=Math.max(t>=0?t:0,o>=0?o:tn.length-1),i=tn.findIndex(function(n){return String(n.key)===e});return i>=r&&i<=l},[ke,Gn,tn]),ot=o.useCallback(function(e){if(!ke||!Gn.selectedRange)return{isInRange:!1,isLeftCol:!1,isRightCol:!1};var n=Gn.selectedRange,t=tn.findIndex(function(e){return String(e.key)===n.start.colKey}),o=tn.findIndex(function(e){return String(e.key)===n.end.colKey}),r=Math.min(t>=0?t:0,o>=0?o:tn.length-1),l=Math.max(t>=0?t:0,o>=0?o:tn.length-1),i=tn.findIndex(function(n){return String(n.key)===e});return{isInRange:i>=r&&i<=l,isLeftCol:i===r,isRightCol:i===l}},[ke,Gn,tn]);o.useEffect(function(){if(ke){var e=function(e){if(Fe.current){var n=e.target;n&&!Fe.current.contains(n)&&(Gn.clearSelection(),Gn.clearFocus())}};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}},[ke,Gn]),o.useEffect(function(){if(ke&&Fe.current){var e=function(e){if(Fe.current){var n=e.relatedTarget;n&&!Fe.current.contains(n)&&(Gn.clearSelection(),Gn.clearFocus())}},n=Fe.current;return n.addEventListener("focusout",e),function(){n.removeEventListener("focusout",e)}}},[ke,Gn]),o.useEffect(function(){if(ke){var e=function(e){var n,t=document.activeElement;if(Fe.current&&t&&Fe.current.contains(t))if("INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&"true"!==t.getAttribute("contenteditable"))if((e.ctrlKey||e.metaKey)&&"c"===e.key){if((S=(d=Gn.getSelectedCells()).filter(function(e){return"__rowNumber__"!==e.colKey})).length>0){e.preventDefault();var o=qe?Ke.filtered:Ke.sorted,r=(Ke.currentPage-1)*Ke.itemsPerPage,l=S.map(function(e){var n=r+e.rowIndex,t=Ke.paged[e.rowIndex];if(t){var l=o.findIndex(function(e){return e===t||gn(e,-1)===gn(t,-1)});if(l>=0)return{rowIndex:l,colKey:e.colKey}}return{rowIndex:n,colKey:e.colKey}}),i=tn.filter(function(e){return"__rowNumber__"!==String(e.key)}).map(function(e){return{key:e.key,label:e.label}});Xn.copyCells(l,o,i),Gn.setCopied(!0)}}else if((e.ctrlKey||e.metaKey)&&"x"===e.key){if((S=(d=Gn.getSelectedCells()).filter(function(e){return"__rowNumber__"!==e.colKey})).length>0){e.preventDefault();var a=qe?Ke.filtered:Ke.sorted,c=(Ke.currentPage-1)*Ke.itemsPerPage;l=S.map(function(e){var n=c+e.rowIndex,t=Ke.paged[e.rowIndex];if(t){var o=a.findIndex(function(e){return e===t||gn(e,-1)===gn(t,-1)});if(o>=0)return{rowIndex:o,colKey:e.colKey}}return{rowIndex:n,colKey:e.colKey}}),i=tn.filter(function(e){return"__rowNumber__"!==String(e.key)}).map(function(e){return{key:e.key,label:e.label}}),Xn.cutCells(l,a,i)}}else if((e.ctrlKey||e.metaKey)&&"v"===e.key){var u=Gn.focusedCell,s=Gn.selectedRange,d=Gn.getSelectedCells(),f=null;if(u?f={rowIndex:u.rowIndex,colKey:u.colKey}:s?f={rowIndex:s.start.rowIndex,colKey:s.start.colKey}:d.length>0&&(f=d[0]),f){e.preventDefault();var g=qe?Ke.filtered:Ke.sorted,p=Ke.paged[f.rowIndex],m=f.rowIndex;if(p){var v=g.findIndex(function(e){return e===p||gn(e,-1)===gn(p,-1)});if(v>=0)m=v;else{var y=(Ke.currentPage-1)*Ke.itemsPerPage;(m=y+f.rowIndex)>=g.length&&(m=g.length-1)}}else y=(Ke.currentPage-1)*Ke.itemsPerPage,(m=y+f.rowIndex)>=g.length&&(m=g.length-1);var w=function(e,n,t,o){var r=Le.find(function(n){return n===e||gn(n,-1)===gn(e,-1)});if(r){var l=Le.findIndex(function(e){return e===r});Mn(r,n,t,l>=0?l:o)}else Mn(e,n,t,o)},b=[{rowIndex:m,colKey:f.colKey}],C=f.colKey,k=function(e,n){var t=m,o=Math.min(m+e-1,g.length-1),r=tn.findIndex(function(e){return String(e.key)===C}),l=Math.min(r+n-1,tn.length-1);if(r>=0&&l>=0&&t>=0&&o>=0){var i=String(tn[r].key),a=String(tn[l].key),c=(Ke.currentPage-1)*Ke.itemsPerPage,u=t-c,s=o-c;u>=0&&s>=0&&u<Ke.paged.length&&s<Ke.paged.length&&requestAnimationFrame(function(){requestAnimationFrame(function(){Gn.setCopied(!1),Gn.setSelectionRange({rowIndex:u,colKey:i},{rowIndex:s,colKey:a}),Gn.setFocusedCell(u,i)})})}},x=tn.filter(function(e){return"__rowNumber__"!==String(e.key)}).map(function(e){return{key:e.key,label:e.label}});Xn.pasteFromSystemClipboard(b,g,x,w).then(function(e){if(e){var n=(o=Xn.getClipboardData())&&o.length||1,t=o&&o[0]&&o[0].length||1;requestAnimationFrame(function(){requestAnimationFrame(function(){k(n,t)})})}else if(Xn.canPaste()){var o,r=(o=Xn.getClipboardData())&&o.length||1,l=o&&o[0]&&o[0].length||1;Xn.pasteCells(b,g,x,w),requestAnimationFrame(function(){requestAnimationFrame(function(){k(r,l)})})}}).catch(function(){if(Xn.canPaste()){var e=Xn.getClipboardData(),n=e&&e.length||1,t=e&&e[0]&&e[0].length||1;Xn.pasteCells(b,g,x,w),requestAnimationFrame(function(){requestAnimationFrame(function(){k(n,t)})})}})}}else if("Delete"===e.key||"Backspace"===e.key){var S;if((S=(d=Gn.getSelectedCells()).filter(function(e){return"__rowNumber__"!==e.colKey})).length>0){e.preventDefault();var R=qe?Ke.filtered:Le;S.forEach(function(e){var n=R[e.rowIndex];if(n){var t=Le.findIndex(function(e){return e===n});Mn(n,e.colKey,"",t>=0?t:e.rowIndex)}})}}else if("Escape"===e.key)Gn.clearSelection(),Gn.setCopied(!1);else if("ArrowUp"===e.key||"ArrowDown"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key){if(!Nn){e.preventDefault();var I="ArrowUp"===e.key?"up":"ArrowDown"===e.key?"down":"ArrowLeft"===e.key?"left":"right",M=e.shiftKey;(T=Gn.moveFocus(I,M))&&Fe.current&&(F=Fe.current.querySelector('[data-row-index="'.concat(T.rowIndex,'"][data-col-key="').concat(T.colKey,'"]')))&&F.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}}else if("Tab"!==e.key||Nn)if("Enter"!==e.key||Nn)if("Home"!==e.key&&"End"!==e.key||Nn){if((e.ctrlKey||e.metaKey)&&("ArrowUp"===e.key||"ArrowDown"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key)&&!Nn){e.preventDefault();var D=Gn.focusedCell||Gn.selectedRange&&Gn.selectedRange.end;if(D){var N=qe?Ke.filtered:h,E=D.rowIndex;K=tn.findIndex(function(e){return String(e.key)===D.colKey}),"ArrowUp"===e.key?E=0:"ArrowDown"===e.key?E=N.length-1:"ArrowLeft"===e.key?K=0:"ArrowRight"===e.key&&(K=tn.length-1),(L=String(null===(n=tn[K])||void 0===n?void 0:n.key))&&(Gn.setFocusedCell(E,L),Gn.startSelection(E,L,e.shiftKey),Fe.current&&(F=Fe.current.querySelector('[data-row-index="'.concat(E,'"][data-col-key="').concat(L,'"]')))&&F.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}))}}}else{e.preventDefault();var P=Gn.focusedCell||Gn.selectedRange&&Gn.selectedRange.end;if(P&&tn.findIndex(function(e){return String(e.key)===P.colKey})>=0){var L,K="Home"===e.key?0:tn.length-1;(L=String(tn[K]&&tn[K].key||""))&&(Gn.setFocusedCell(P.rowIndex,L),Gn.startSelection(P.rowIndex,L,e.shiftKey))}}else e.preventDefault(),I=e.shiftKey?"up":"down",(T=Gn.moveFocus(I,!1))&&Fe.current&&(F=Fe.current.querySelector('[data-row-index="'.concat(T.rowIndex,'"][data-col-key="').concat(T.colKey,'"]')))&&F.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"});else{e.preventDefault();var T,F;I=e.shiftKey?"left":"right";(T=Gn.moveFocus(I,!1))&&Fe.current&&(F=Fe.current.querySelector('[data-row-index="'.concat(T.rowIndex,'"][data-col-key="').concat(T.colKey,'"]')))&&F.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}else(e.ctrlKey||e.metaKey)&&("c"===e.key||"x"===e.key||e.key)};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}},[ke,Gn,Xn,Ke.paged,tn,j,qe,h,Nn,Ke.filtered]);var rt=o.useMemo(function(){return ze?Array.from(new Set(h.map(function(e){return String(e[ze])}))):[]},[ze,h]);o.useEffect(function(){qe&&Ke.setCurrentPage(1)},[qe]);var lt=o.useMemo(function(){if(!qe)return null;var e={};return(Ke.sortKey?i([],l(Ke.filtered),!1).sort(function(e,n){var t=e[Ke.sortKey],o=n[Ke.sortKey];if(null==t)return 1;if(null==o)return-1;if(t===o)return 0;var r=String(t).localeCompare(String(o),void 0,{numeric:!0,sensitivity:"base"});return"asc"===Ke.sortDir?r:-r}):Ke.filtered).forEach(function(n){var t=String(n[qe]);e[t]||(e[t]=[]),e[t].push(n)}),e},[Ke.filtered,Ke.sortKey,Ke.sortDir,qe]);o.useEffect(function(){if(qe&&lt){var e=Object.keys(lt).length,n=Math.ceil(e/Ke.itemsPerPage);Ke.currentPage>n&&n>0&&Ke.setCurrentPage(1)}},[lt,qe,Ke.itemsPerPage,Ke.currentPage,Ke.setCurrentPage]);var it=o.useMemo(function(){if(!qe||!lt)return null;var e=Object.entries(lt);e.sort(function(e,n){var t=l(e,1)[0],o=l(n,1)[0];return t.localeCompare(o)});var n=(Ke.currentPage-1)*Ke.itemsPerPage,t=n+Ke.itemsPerPage;return e.slice(n,t)},[lt,Ke.currentPage,Ke.itemsPerPage,qe]);o.useEffect(function(){qe&&lt?Qe(new Set(Object.keys(lt))):qe||Qe(new Set)},[qe,lt]);var at=o.useCallback(function(e,n){if(n.onRenderCell){var t=n.onRenderCell(e,n.key,0);return String("string"==typeof t||"number"==typeof t?t:null!=e[n.key]?e[n.key]:"")}return m?(t=m(e,n.key,0),String("string"==typeof t||"number"==typeof t?t:null!=e[n.key]?e[n.key]:"")):String(null!=e[n.key]?e[n.key]:"")},[m]),ct=o.useCallback(function(t,o,l){var i=Nn&&Nn.rowIndex===l&&Nn.columnKey===o.key,a=i&&null!==Kn;if(i&&o.editable){var c=function(e){Ln(String(null!=e?e:""))},d=function(){},h=function(e){if("Enter"===e.key){if(e.preventDefault(),!1===Fn(t,o.key,l)){var n=e.target;setTimeout(function(){n&&n.focus()},0)}}else"Escape"===e.key&&(e.preventDefault(),An());"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Tab"!==e.key&&"Home"!==e.key&&"End"!==e.key||e.stopPropagation()},f=function(e){return Fn(t,o.key,l,e)},g=function(){An()};if(o.onRenderEditCell&&"function"==typeof o.onRenderEditCell){var p=o.onRenderEditCell(t,o.key,En,c,d,h,f,g,a||!1,Kn,ke);return e("div",r({className:"hh-cell-edit-container"},{children:[p,e("div",r({className:"hh-cell-edit-buttons"},{children:[n("button",r({type:"button",className:"hh-cell-edit-button hh-cell-edit-save",onClick:function(e){if(e.stopPropagation(),e.preventDefault(),!1===f()){var n=e.currentTarget.closest(".hh-cell-edit-container");if(n){var t=n.querySelector('input, select, textarea, button, [tabindex]:not([tabindex="-1"])');t&&t.focus()}}},onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},title:"Save"},{children:n(u,{width:12,height:12})})),n("button",r({type:"button",className:"hh-cell-edit-button hh-cell-edit-cancel",onClick:function(e){e.stopPropagation(),e.preventDefault(),g()},onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},title:"Cancel"},{children:n(s,{width:12,height:12})}))]})),a&&n("div",r({className:"hh-cell-edit-error-message"},{children:Kn}))]}))}if("select"===o.editor&&o.options&&o.options.length>0){var v=n(B,{value:En||"",options:o.options,placeholder:"Select...",onChange:c,onBlur:d,onKeyDown:h,onSave:f,hasError:a||!1,enableCellSelection:ke,autoFocus:!0,onDismissCallout:Rn.dismissCallout},"dropdown-".concat(String(o.key)));return e("div",r({className:"hh-cell-edit-container"},{children:[v,e("div",r({className:"hh-cell-edit-buttons"},{children:[n("button",r({type:"button",className:"hh-cell-edit-button hh-cell-edit-save",onClick:function(e){if(e.stopPropagation(),e.preventDefault(),!1===f()){var n=e.currentTarget.closest(".hh-cell-edit-container");if(n){var t=n.querySelector('input, select, textarea, button, [tabindex]:not([tabindex="-1"])');t&&t.focus()}}},onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},title:"Save"},{children:n(u,{width:12,height:12})})),n("button",r({type:"button",className:"hh-cell-edit-button hh-cell-edit-cancel",onClick:function(e){e.stopPropagation(),e.preventDefault(),g()},onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},title:"Cancel"},{children:n(s,{width:12,height:12})}))]})),a&&n("div",r({className:"hh-cell-edit-error-message"},{children:Kn}))]}))}if("date"===o.editor){var y=n(_,{value:En||"",placeholder:"Select date...",onChange:c,onBlur:d,onKeyDown:h,onSave:f,hasError:a||!1,enableCellSelection:ke,autoFocus:!0,onDismissCallout:Rn.dismissCallout},"datepicker-".concat(String(o.key)));return e("div",r({className:"hh-cell-edit-container"},{children:[y,e("div",r({className:"hh-cell-edit-buttons"},{children:[n("button",r({type:"button",className:"hh-cell-edit-button hh-cell-edit-save",onClick:function(e){if(e.stopPropagation(),e.preventDefault(),!1===f()){var n=e.currentTarget.closest(".hh-cell-edit-container");if(n){var t=n.querySelector('input, select, textarea, button, [tabindex]:not([tabindex="-1"])');t&&t.focus()}}},onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},title:"Save"},{children:n(u,{width:12,height:12})})),n("button",r({type:"button",className:"hh-cell-edit-button hh-cell-edit-cancel",onClick:function(e){e.stopPropagation(),e.preventDefault(),g()},onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},title:"Cancel"},{children:n(s,{width:12,height:12})}))]})),a&&n("div",r({className:"hh-cell-edit-error-message"},{children:Kn}))]}))}return e("div",ke?r({className:"hh-cell-edit-wrapper"},{children:[n("input",{ref:Pn,type:"text",className:"hh-cell-edit-input hh-cell-edit-input-excel ".concat(a?"hh-cell-edit-input-error":""),value:En,onChange:function(e){return Ln(e.target.value)},onBlur:function(){!1===Fn(t,o.key,l)&&Pn.current&&setTimeout(function(){Pn.current&&Pn.current.focus()},0)},onKeyDown:function(e){"Enter"===e.key?(e.preventDefault(),!1===Fn(t,o.key,l)&&Pn.current&&Pn.current.focus()):"Escape"===e.key&&(e.preventDefault(),An()),"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Tab"!==e.key&&"Home"!==e.key&&"End"!==e.key||e.stopPropagation()},onClick:function(e){e.stopPropagation()},onFocus:function(e){var n=e.target;n&&setTimeout(function(){var e=n.value.length;n.setSelectionRange(e,e)},0)},onMouseDown:function(e){e.stopPropagation()}}),a&&n("div",r({className:"hh-cell-edit-error-message"},{children:Kn}))]}):r({className:"hh-cell-edit-container"},{children:[n("input",{ref:Pn,type:"text",className:"hh-cell-edit-input ".concat(a?"hh-cell-edit-input-error":""),value:En,onChange:function(e){return Ln(e.target.value)},onKeyDown:function(e){"Enter"===e.key?(e.preventDefault(),!1===Fn(t,o.key,l)&&Pn.current&&Pn.current.focus()):"Escape"===e.key&&(e.preventDefault(),An()),"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"Tab"!==e.key&&"Home"!==e.key&&"End"!==e.key||e.stopPropagation()},onClick:function(e){e.stopPropagation()},onFocus:function(e){var n=e.target;n&&setTimeout(function(){var e=n.value.length;n.setSelectionRange(e,e)},0)},onMouseDown:function(e){e.stopPropagation()}}),e("div",r({className:"hh-cell-edit-buttons"},{children:[n("button",r({type:"button",className:"hh-cell-edit-button hh-cell-edit-save",onClick:function(e){e.stopPropagation(),e.preventDefault(),!1===Fn(t,o.key,l)&&Pn.current&&Pn.current.focus()},onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},title:"Save"},{children:n(u,{width:12,height:12})})),n("button",r({type:"button",className:"hh-cell-edit-button hh-cell-edit-cancel",onClick:function(e){e.stopPropagation(),e.preventDefault(),An()},onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},title:"Cancel"},{children:n(s,{width:12,height:12})}))]})),a&&n("div",r({className:"hh-cell-edit-error-message"},{children:Kn}))]}))}return o.onRenderCell?o.onRenderCell(t,o.key,l):m?m(t,o.key,l):String(null!=t[o.key]?t[o.key]:"")},[m,Nn,En,Kn,Fn,An,d,ke,Ln]),ut=o.useMemo(function(){return A(W)},[W]),st=o.useMemo(function(){return O(ut)},[ut]),dt=o.useMemo(function(){return qe&&it?it.flatMap(function(e){var n=l(e,2);return n[0],n[1]}):Ke.paged},[qe,it,Ke.paged]),ht=function(e,n,t,r,i,a,c){var u=l(o.useState(null),2),s=u[0],d=u[1];return o.useEffect(function(){if(n&&e.current&&!t){var o=function(e){if(!t&&0!==r.length){var n=document.activeElement;if(!n||"INPUT"!==n.tagName&&"TEXTAREA"!==n.tagName&&"true"!==n.getAttribute("contenteditable")){var o=null!=s?s:0;switch(e.key){case"ArrowDown":e.preventDefault(),o=Math.min(o+1,r.length-1),d(o);break;case"ArrowUp":e.preventDefault(),o=Math.max(o-1,0),d(o);break;case"Enter":case" ":if(e.preventDefault(),null!==s&&"none"!==i){var l=r[s],u=a(l,s);c&&c(new Set([u]))}break;case"Escape":e.preventDefault(),d(null),c&&c(new Set)}}}};return e.current.addEventListener("keydown",o),function(){e.current&&e.current.removeEventListener("keydown",o)}}},[n,t,s,i,r,a,c,e]),{focusedRowIndex:s,setFocusedRowIndex:d}}(Fe,ce,Q,dt,L,gn,function(e){return yn(e)}),ft=ht.focusedRowIndex,gt=Le.length>0,pt=!Q&&!gt,mt=!Q&&gt,vt=o.useCallback(function(e,n){var t=String(e.key);if("left"!==(en[t]||e.pinned||null))return 0;var o=0;"none"!==L&&(o+=48);for(var r=0;r<n;r++){var l=tn[r];"left"===(en[String(l.key)]||l.pinned||null)&&(o+=kn[String(l.key)]||("number"==typeof l.width?l.width:parseFloat(l.width||"0"))||("string"==typeof l.width&&l.width.includes("px")?parseFloat(l.width):100))}return o},[tn,en,kn,L]),yt=o.useCallback(function(e,n){var t=String(e.key);if("right"!==(en[t]||e.pinned||null))return 0;for(var o=0,r=n+1;r<tn.length;r++){var l=tn[r];"right"===(en[String(l.key)]||l.pinned||null)&&(o+=kn[String(l.key)]||("number"==typeof l.width?l.width:parseFloat(l.width||"0"))||("string"==typeof l.width&&l.width.includes("px")?parseFloat(l.width):100))}return o},[tn,en,kn]),wt=o.useMemo(function(){for(var e=null,n=0;n<tn.length;n++){var t=tn[n];if("left"===(en[String(t.key)]||t.pinned||null))e=t.key;else if(null!==e)break}return e},[tn,en]),bt=o.useMemo(function(){for(var e=0;e<tn.length;e++){var n=tn[e];if("right"===(en[String(n.key)]||n.pinned||null))return n.key}return null},[tn,en]);return e("div",r({ref:Fe,className:"hh-table ".concat(M||""," hh-theme-").concat(ut.mode||"light"," ").concat(xn?"resizing":""," ").concat(te?"hh-sticky-header":""," ").concat(ke?"enable-cell-selection":""),style:r(r(r(r({},st),D),U?{maxHeight:"number"==typeof U?"".concat(U,"px"):U,overflow:"auto"}:{}),xn?{cursor:"col-resize"}:{}),onScroll:o.useCallback(function(e){requestAnimationFrame(function(){})},[]),tabIndex:ke||ce?0:void 0},{children:[fe&&n("div",r({className:"hh-export-toolbar"},{children:n(K,{data:Ke.filtered,columns:tn,format:pe,filename:ve,onBeforeExport:ye,onAfterExport:we})})),Q&&n(y,{columns:tn,itemsPerPage:g,selectionMode:L,onRenderLoading:Z}),pt&&n(w,{emptyMessage:$,onRenderEmpty:ee}),mt&&n("div",r({style:r({overflowX:"auto",overflowY:te&&!U?"auto":"visible",width:"100%"},te&&!U?{maxHeight:"calc(100vh - 200px)"}:{})},{children:e("table",{children:[n(x,{columns:tn,selectionMode:L,isAllSelected:hn,isIndeterminate:fn,onSelectAll:vn,columnWidths:kn,pinnedColumns:en,lastLeftPinnedColumnKey:wt,firstRightPinnedColumnKey:bt,stickyHeader:te,enableColumnReorder:le||!1,dragOverColumn:nn,sortKey:Ke.sortKey,sortDir:Ke.sortDir,filters:Ke.filters,anchorRefs:Te,calloutKey:Rn.calloutKey,resizingColumn:xn,onRenderHeader:C,onColumnHeaderClick:k,onHeaderMouseEnter:function(e){if("__rowNumber__"!==e){var n=tn.find(function(n){return String(n.key)===e});n&&!1===n.showCallout||Rn.handleHeaderMouseEnter(e)}},onHeaderMouseLeave:Rn.handleHeaderMouseLeave,onCalloutMouseEnter:Rn.handleCalloutMouseEnter,onCalloutMouseLeave:Rn.handleCalloutMouseLeave,onColumnDragStart:ln,onColumnDragOver:an,onColumnDrop:cn,onResizeStart:Sn,onSortAsc:function(e){"__rowNumber__"!==String(e.key)&&!1!==e.sortable&&Ke.handleSort(e.key,"asc")},onSortDesc:function(e){"__rowNumber__"!==String(e.key)&&!1!==e.sortable&&Ke.handleSort(e.key,"desc")},onFilter:function(e){var n;"__rowNumber__"!==String(e.key)&&!1!==e.filterable&&(n=e.key,He(String(n)),Rn.dismissCallout())},onClearFilter:function(e){"__rowNumber__"!==String(e.key)&&!1!==e.filterable&&Ke.setFilter(String(e.key),[])},onPinLeft:function(e){"__rowNumber__"!==String(e.key)&&rn(e.key,"left")},onPinRight:function(e){"__rowNumber__"!==String(e.key)&&rn(e.key,"right")},onUnpin:function(e){"__rowNumber__"!==String(e.key)&&rn(e.key,null)},onToggleVisibility:function(e){"__rowNumber__"!==String(e.key)&&oe&&on(e.key)},onGroupBy:function(e){"__rowNumber__"!==String(e.key)&&(qe===e.key?Ge(void 0):Ge(e.key))},currentGroupBy:qe,enableColumnVisibility:oe||!1,onTotalsChange:function(e,n){Be(function(t){var o;return r(r({},t),((o={})[String(e.key)]=n,o))})},columnTotals:Oe,getLeftOffset:vt,getRightOffset:yt,dismissCallout:Rn.dismissCallout,enableRowActions:!!be,enableCellSelection:ke,isRangeFromFirstRow:nt(),isColumnInRange:tt,getColumnRangeInfo:ot,isCopied:Gn.isCopied}),n(N,{data:Le,columns:tn,paginatedGroups:it||void 0,currentGroupBy:qe,expandedGroups:Je,selectionMode:L,selectedItems:sn,activeItemIndex:dn,focusedRowIndex:null!=ft?ft:void 0,enableRowReorder:se,draggedRowIndex:_n,dragOverRowIndex:zn,isDragging:Hn,columnWidths:kn,pinnedColumns:en,lastLeftPinnedColumnKey:wt||void 0,firstRightPinnedColumnKey:bt||void 0,showTooltip:X,onRenderRow:b,getItemKey:gn,onItemClick:mn,onItemContextMenu:I,onCheckboxChange:pn,onCellEditStart:On,onRowDragStart:Vn,onRowDragOver:Wn,onRowDragLeave:Un,onRowDrop:jn,onRowDragEnd:Yn,renderCell:ct,getCellText:at,getLeftOffset:vt,getRightOffset:yt,toggleGroup:function(e){Qe(function(n){var t=new Set(n);return t.has(e)?t.delete(e):t.add(e),t})},filteredData:Ke.filtered,pagedData:Ke.paged,rowActions:be,openMenuKey:We,onMenuToggle:wn,onMenuDismiss:bn,enableCellSelection:ke,isCellSelected:Gn.isCellSelected,getCellRangeInfo:$n,isRowAboveRange:et,isColumnInRange:tt,getColumnRangeInfo:ot,onCellMouseDown:Jn,onCellMouseEnter:Qn,onCellMouseUp:Zn}),n(E,{columns:tn,selectionMode:L,columnTotals:Oe,pinnedColumns:en,columnWidths:kn,lastLeftPinnedColumnKey:wt||void 0,firstRightPinnedColumnKey:bt||void 0,totalCount:Ke.filtered.length,getLeftOffset:vt,getRightOffset:yt})]})})),mt&&z&&n(c,{totalItems:qe&&lt?Object.keys(lt).length:Ke.filtered.length,itemsPerPage:Ke.itemsPerPage,currentPage:Ke.currentPage,onPageChange:Ke.setCurrentPage,itemsPerPageOptions:Ne,onItemsPerPageChange:function(e){Ee(e),Ke.setCurrentPage(1)}}),ze&&n(v,{field:ze,values:rt,selected:Ke.filters[ze]||[],onApply:function(e){Ke.setFilter(ze,e),He(null)},onDismiss:function(){return He(null)}})]}))}export{z as ReactTabletify,O as applyTheme,F as defaultDarkTheme,T as defaultLightTheme,A as getTheme,a as useTable};
