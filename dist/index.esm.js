import{jsxs as e,jsx as t,Fragment as n}from"react/jsx-runtime";import*as r from"react";var i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i.apply(this,arguments)};function c(e,t,n){if(n||2===arguments.length)for(var r,i=0,c=t.length;i<c;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function o(e,t){void 0===t&&(t=10);var n=r.useState(""),o=n[0],l=n[1],a=r.useState(null),u=a[0],s=a[1],h=r.useState("asc"),d=h[0],f=h[1],m=r.useState(1),p=m[0],g=m[1],v=r.useState({}),k=v[0],C=v[1],y=r.useMemo(function(){var t=e;if(Object.entries(k).forEach(function(e){var n=e[0],r=e[1];r.length>0&&(t=t.filter(function(e){return r.includes(String(e[n]))}))}),o.trim()){var n=o.toLowerCase();t=t.filter(function(e){return Object.values(e).some(function(e){return String(e).toLowerCase().includes(n)})})}return t},[e,o,k]),b=r.useMemo(function(){return u?c([],y,!0).sort(function(e,t){var n=e[u],r=t[u];if(null==n)return 1;if(null==r)return-1;if(n===r)return 0;var i=String(n).localeCompare(String(r),void 0,{numeric:!0,sensitivity:"base"});return"asc"===d?i:-i}):y},[y,u,d]),N=Math.ceil(b.length/t),S=r.useMemo(function(){var e=(p-1)*t;return b.slice(e,e+t)},[b,p,t]);return r.useEffect(function(){g(1)},[o,u,d,k]),{filtered:y,paged:S,currentPage:p,setCurrentPage:g,totalPages:N,itemsPerPage:t,search:o,setSearch:l,sortKey:u,sortDir:d,handleSort:function(e,t){t?(s(e),f(t)):u===e?f(function(e){return"asc"===e?"desc":"asc"}):(s(e),f("asc"))},filters:k,setFilter:function(e,t){C(function(n){var r=i({},n);return 0===t.length?delete r[e]:r[e]=t,r})}}}"function"==typeof SuppressedError&&SuppressedError;var l=function(r){var c=r.totalItems,o=r.itemsPerPage,l=r.currentPage,u=r.onPageChange,s=r.maxVisible,h=void 0===s?5:s,d=Math.ceil(c/o);if(d<=1)return null;var f=Math.floor(h/2),m=Math.max(1,l-f),p=Math.min(d,m+h-1);p-m<h-1&&(m=Math.max(1,p-h+1));var g=Array.from({length:p-m+1},function(e,t){return m+t}),v=function(e){e<1||e>d||e===l||u(e)};return e("div",i({style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",marginTop:"1rem",flexWrap:"wrap"}},{children:[t("button",i({onClick:function(){return v(l-1)},disabled:1===l,style:a},{children:"Prev"})),m>1&&e(n,{children:[t("button",i({style:a,onClick:function(){return v(1)}},{children:"1"})),m>2&&t("span",i({style:{color:"#999"}},{children:"..."}))]}),g.map(function(e){return t("button",i({onClick:function(){return v(e)},style:i(i({},a),e===l?{background:"#6ABE28",color:"#fff",fontWeight:600,borderColor:"#6ABE28"}:{})},{children:e}),e)}),p<d&&e(n,{children:[p<d-1&&t("span",i({style:{color:"#999"}},{children:"..."})),t("button",i({style:a,onClick:function(){return v(d)}},{children:d}))]}),t("button",i({onClick:function(){return v(l+1)},disabled:l===d,style:a},{children:"Next"}))]}))},a={border:"1px solid #ccc",borderRadius:4,padding:"4px 10px",cursor:"pointer",background:"#fff",transition:"0.2s",fontSize:14};function u(n){var c=n.anchorRef,o=n.onSortAsc,l=n.onSortDesc,a=n.onFilter;n.onDismiss;var u=n.onMouseEnter,s=n.onMouseLeave,h=r.useRef(null);if(!c.current)return null;var d=c.current.getBoundingClientRect();return e("div",i({ref:h,className:"th-callout",style:{top:d.bottom+6,left:d.left,position:"fixed"},onMouseEnter:u,onMouseLeave:s},{children:[e("button",i({onClick:o,className:"th-callout-item"},{children:[t("span",i({className:"th-callout-icon"},{children:"↑"})),t("span",i({className:"th-callout-text"},{children:"A to Z"}))]})),e("button",i({onClick:l,className:"th-callout-item"},{children:[t("span",i({className:"th-callout-icon"},{children:"↓"})),t("span",i({className:"th-callout-text"},{children:"Z to A"}))]})),t("hr",{className:"th-callout-divider"}),t("button",i({onClick:a,className:"th-callout-item"},{children:t("span",i({className:"th-callout-text"},{children:"Filter by"}))}))]}))}function s(n){var o=n.field,l=n.values,a=n.selected,u=n.onApply,s=n.onDismiss,h=r.useState(a),d=h[0],f=h[1],m=r.useState(""),p=m[0],g=m[1];r.useEffect(function(){f(a),g("")},[o]);var v=r.useMemo(function(){if(!p.trim())return l;var e=p.toLowerCase();return l.filter(function(t){return t.toLowerCase().includes(e)})},[l,p]);return e("div",i({className:"th-filter-panel open"},{children:[e("div",i({className:"th-filter-header"},{children:[e("strong",{children:["Filter by '",o,"'"]}),t("button",i({className:"th-filter-close",onClick:s,"aria-label":"Close"},{children:t("svg",i({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:t("path",{d:"M12.8536 3.85355C13.0488 3.65829 13.0488 3.34171 12.8536 3.14645C12.6583 2.95118 12.3417 2.95118 12.1464 3.14645L8 7.29289L3.85355 3.14645C3.65829 2.95118 3.34171 2.95118 3.14645 3.14645C2.95118 3.34171 2.95118 3.65829 3.14645 3.85355L7.29289 8L3.14645 12.1464C2.95118 12.3417 2.95118 12.6583 3.14645 12.8536C3.34171 13.0488 3.65829 13.0488 3.85355 12.8536L8 8.70711L12.1464 12.8536C12.3417 13.0488 12.6583 13.0488 12.8536 12.8536C13.0488 12.6583 13.0488 12.3417 12.8536 12.1464L8.70711 8L12.8536 3.85355Z",fill:"currentColor"})}))}))]})),e("div",i({className:"th-filter-content"},{children:[t("div",i({className:"th-filter-search"},{children:t("input",{type:"text",className:"th-filter-search-input",placeholder:"Select ".concat(o," to display..."),value:p,onChange:function(e){return g(e.target.value)}})})),t("div",i({className:"th-filter-options-list"},{children:v.length>0?v.map(function(n){return e("div",i({className:"th-filter-option"},{children:[t("input",{type:"checkbox",id:"filter-".concat(o,"-").concat(n),checked:d.includes(n),onChange:function(){return function(e){f(function(t){return t.includes(e)?t.filter(function(t){return t!==e}):c(c([],t,!0),[e],!1)})}(n)}}),t("label",i({htmlFor:"filter-".concat(o,"-").concat(n)},{children:n}))]}),n)}):t("div",i({className:"th-filter-no-results"},{children:"No results found"}))}))]})),e("div",i({className:"th-filter-footer"},{children:[t("button",i({className:"th-btn",onClick:function(){f([])}},{children:"Clear all"})),t("button",i({className:"th-btn primary",onClick:function(){return u(d)}},{children:"Apply"}))]}))]}))}function h(n){var a=n.columns,h=n.data,d=n.itemsPerPage,f=void 0===d?10:d,m=n.groupBy,p=n.onRenderCell,g=n.onRenderRow,v=n.onRenderHeader,k=n.onItemInvoked,C=n.onColumnHeaderClick,y=n.getKey,b=n.onActiveItemChanged,N=n.onItemContextMenu,S=n.className,w=n.styles,x=n.selectionMode,P=void 0===x?"none":x,M=n.onSelectionChanged,L=n.showPagination,E=void 0===L||L,A=o(h,f),R=r.useState(null),j=R[0],F=R[1],D=r.useState(null),K=D[0],O=D[1],I=r.useState(new Set),B=I[0],T=I[1],W=r.useState(new Set),Z=W[0],H=W[1],z=r.useState(void 0),V=z[0],q=z[1],G=r.useRef({}),J=r.useRef(null),Q=r.useCallback(function(e,t){return y?y(e,t):void 0!==e.id?e.id:t},[y]),U=r.useCallback(function(e,t,n){var r=Q(e,t);H(function(e){var t=new Set(e);if("single"===P?(t.clear(),n&&t.add(r)):"multiple"===P&&(n?t.add(r):t.delete(r)),M){var i=h.filter(function(e,n){return t.has(Q(e,n))});M(i)}return t}),q(t),b&&b(e,t)},[P,Q,M,b,h]),X=r.useCallback(function(e){if("multiple"===P){var t=A.paged;H(function(n){var r=new Set(n);if(e?t.forEach(function(e,t){r.add(Q(e,t))}):t.forEach(function(e,t){r.delete(Q(e,t))}),M){var i=h.filter(function(e,t){return r.has(Q(e,t))});M(i)}return r})}},[P,A.paged,Q,M,h]),Y=r.useCallback(function(e,t,n){if(!n.target.closest(".th-selection-checkbox")){if(k&&k(e,t),"none"!==P){var r=Q(e,t);H(function(e){var t=new Set(e);if("single"===P?(t.clear(),t.add(r)):"multiple"===P&&(n.ctrlKey||n.metaKey?t.has(r)?t.delete(r):t.add(r):(t.clear(),t.add(r))),M){var i=h.filter(function(e,n){return t.has(Q(e,n))});M(i)}return t})}q(t),b&&b(e,t)}},[k,P,Q,M,b,h]),$=r.useMemo(function(){if("multiple"!==P)return!1;var e=A.paged;return 0!==e.length&&e.every(function(e,t){return Z.has(Q(e,t))})},[P,A.paged,Z,Q]),_=r.useMemo(function(){if("multiple"!==P)return!1;var e=A.paged;if(0===e.length)return!1;var t=e.filter(function(e,t){return Z.has(Q(e,t))}).length;return t>0&&t<e.length},[P,A.paged,Z,Q]),ee=r.useMemo(function(){return K?Array.from(new Set(h.map(function(e){return String(e[K])}))):[]},[K,h]),te=function(){J.current&&clearTimeout(J.current),J.current=setTimeout(function(){F(null)},200)};r.useEffect(function(){return function(){J.current&&clearTimeout(J.current)}},[]),r.useEffect(function(){m&&A.setCurrentPage(1)},[m]);var ne=r.useMemo(function(){if(!m)return null;var e={};return(A.sortKey?c([],A.filtered,!0).sort(function(e,t){var n=e[A.sortKey],r=t[A.sortKey];if(null==n)return 1;if(null==r)return-1;if(n===r)return 0;var i=String(n).localeCompare(String(r),void 0,{numeric:!0,sensitivity:"base"});return"asc"===A.sortDir?i:-i}):A.filtered).forEach(function(t){var n=String(t[m]);e[n]||(e[n]=[]),e[n].push(t)}),e},[A.filtered,A.sortKey,A.sortDir,m]);r.useEffect(function(){if(m&&ne){var e=Object.keys(ne).length,t=Math.ceil(e/A.itemsPerPage);A.currentPage>t&&t>0&&A.setCurrentPage(1)}},[ne,m,A.itemsPerPage,A.currentPage,A.setCurrentPage]);var re=r.useMemo(function(){if(!m||!ne)return null;var e=Object.entries(ne);e.sort(function(e,t){var n=e[0],r=t[0];return n.localeCompare(r)});var t=(A.currentPage-1)*A.itemsPerPage,n=t+A.itemsPerPage;return e.slice(t,n)},[ne,A.currentPage,A.itemsPerPage,m]),ie=r.useCallback(function(e,t,n){var r;return t.onRenderCell?t.onRenderCell(e,t.key,n):p?p(e,t.key,n):String(null!==(r=e[t.key])&&void 0!==r?r:"")},[p]);return e("div",i({className:"th-table ".concat(S||""),style:w},{children:[e("table",{children:[t("thead",{children:e("tr",{children:["none"!==P&&t("th",i({className:"th-selection-column"},{children:t("div","multiple"===P?i({className:"th-selection-checkbox-wrapper"},{children:t("input",{type:"checkbox",className:"th-selection-checkbox",checked:$,ref:function(e){e&&(e.indeterminate=_)},onChange:function(e){return X(e.target.checked)},onClick:function(e){return e.stopPropagation()}})}):{className:"th-selection-checkbox-wrapper"})})),a.map(function(n,r){return e("th",{children:[v?v(n,r):e("div",i({className:"th-header-cell",ref:function(e){e&&(G.current[String(n.key)]=e)},onMouseEnter:function(){return e=n.key,J.current&&clearTimeout(J.current),void(J.current=setTimeout(function(){F(e)},150));var e},onMouseLeave:te,onClick:function(e){return null==C?void 0:C(n,e)}},{children:[t("span",i({className:"th-header-label"},{children:n.label})),e("div",i({className:"th-header-icons"},{children:[A.filters[String(n.key)]&&A.filters[String(n.key)].length>0&&t("span",i({className:"th-header-filter-icon",title:"Filtered"},{children:e("svg",i({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"},{children:[t("path",{d:"M3 5h18M6 12h12M10 19h4"}),t("circle",{cx:"18",cy:"18",r:"3.5",fill:"currentColor"}),t("path",{d:"M16.5 18l1 1 2-2.2",stroke:"#fff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]}))})),A.sortKey===n.key&&t("span",i({className:"th-header-sort-icon"},{children:"asc"===A.sortDir?t("span",i({className:"th-sort-arrow"},{children:"↑"})):t("span",i({className:"th-sort-arrow"},{children:"↓"}))}))]})),t("span",i({className:"th-header-action"},{children:"⋮"}))]})),j===n.key&&t(u,{anchorRef:{current:G.current[String(n.key)]},onSortAsc:function(){A.handleSort(n.key,"asc"),F(null)},onSortDesc:function(){A.handleSort(n.key,"desc"),F(null)},onFilter:function(){return e=n.key,O(String(e)),void F(null);var e},onDismiss:function(){return F(null)},onMouseEnter:function(){J.current&&clearTimeout(J.current)},onMouseLeave:te})]},String(n.key))})]})}),t("tbody",{children:m&&re?re.map(function(n){var c=n[0],o=n[1],l=B.has(c);return e(r.Fragment,{children:[t("tr",i({className:"th-group-header"},{children:t("td",i({colSpan:a.length,className:"th-group-header-cell"},{children:e("button",i({className:"th-group-toggle",onClick:function(){return function(e){T(function(t){var n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})}(c)},"aria-expanded":l},{children:[t("svg",i({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:l?"expanded":""},{children:t("path",{d:"M6 4L10 8L6 12",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})),e("span",i({className:"th-group-label"},{children:[String(m),": ",c]})),e("span",i({className:"th-group-count"},{children:["(",o.length,")"]}))]}))}))})),l&&o.map(function(n,c){var o=A.filtered.findIndex(function(e){return Q(e,A.filtered.indexOf(e))===Q(n,c)||e===n}),l=o>=0?o:c,u=Q(n,l),s=Z.has(u),h=V===l;return g?t(r.Fragment,{children:g(n,l,a)},u):e("tr",i({className:"th-group-row ".concat(s?"th-row-selected":""," ").concat(h?"th-row-active":""),onClick:function(e){return Y(n,l,e)},onContextMenu:function(e){return null==N?void 0:N(n,l,e)}},{children:["none"!==P&&t("td",i({className:"th-selection-column"},{children:t("div",i({className:"th-selection-checkbox-wrapper"},{children:t("input",{type:"single"===P?"radio":"checkbox",className:"th-selection-checkbox",checked:s,onChange:function(e){return U(n,l,e.target.checked)},onClick:function(e){return e.stopPropagation()}})}))})),a.map(function(e){return t("td",{children:ie(n,e,l)},String(e.key))})]}),u)})]},c)}):A.paged.map(function(n,c){var o=Q(n,c),l=Z.has(o),u=V===c;return g?t(r.Fragment,{children:g(n,c,a)},o):e("tr",i({className:"".concat(l?"th-row-selected":""," ").concat(u?"th-row-active":""),onClick:function(e){return Y(n,c,e)},onContextMenu:function(e){return null==N?void 0:N(n,c,e)}},{children:["none"!==P&&t("td",i({className:"th-selection-column"},{children:t("div",i({className:"th-selection-checkbox-wrapper"},{children:t("input",{type:"single"===P?"radio":"checkbox",className:"th-selection-checkbox",checked:l,onChange:function(e){return U(n,c,e.target.checked)},onClick:function(e){return e.stopPropagation()}})}))})),a.map(function(e){return t("td",{children:ie(n,e,c)},String(e.key))})]}),o)})})]}),E&&t(l,{totalItems:m&&ne?Object.keys(ne).length:A.filtered.length,itemsPerPage:A.itemsPerPage,currentPage:A.currentPage,onPageChange:A.setCurrentPage}),K&&t(s,{field:K,values:ee,selected:A.filters[K]||[],onApply:function(e){A.setFilter(K,e),O(null)},onDismiss:function(){return O(null)}})]}))}export{h as ReactTabletify,o as useTable};
//# sourceMappingURL=index.esm.js.map
